(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{1503:function(e,t,n){"use strict";function r(e){for(var t=0;e.offsetParent;)t+=e.offsetTop,e=e.offsetParent;return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getOffsetTop=r,t.scrollRelatedToTopMenu=function(e,t){if(!e)return;var n=document.getElementById(e);if(!n)return;var a=r(n)-60-(t||0);setTimeout(function(){return window.scrollTo(0,a)})}},1554:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=y(n(0)),u=n(2),d=y(u),f=n(78),p=y(n(262)),m=y(n(8)),E=n(265),h=n(1572);function y(e){return e&&e.__esModule?e:{default:e}}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function C(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=(a=r=function(e){function t(){return T(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return C(t,u.Component),c(t,[{key:"render",value:function(){var e=this.props,t=e.owner,n=e.selectedItem,r=e.avatarSize,a=n?n.media:t.avatar;return d.default.createElement("div",{className:h.avatarTrigger},d.default.createElement(p.default,{src:a,size:r}))}}]),t}(),r.propTypes={selectedItem:s.default.object,avatarSize:s.default.string,owner:s.default.object},r.defaultProps={avatarSize:"tiny",owner:{}},a),b=(0,f.hocDropdown)(v,f.MediaDropdown.MenuItem),R=(i=o=function(e){function t(){return T(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return C(t,u.Component),c(t,[{key:"render",value:function(){return d.default.createElement(b,l({},this.props,{className:(0,m.default)(h.avatarDropdown,this.props.className),searchable:!0,searchPlaceholder:"\u7b5b\u9009\u6210\u5458",onSearch:E.onPinyinSearch}))}}]),t}(),o.propTypes={className:s.default.string},i);t.default=R},1572:function(e,t,n){e.exports={"avatar-dropdown":"avatar-dropdown-2vG",avatarDropdown:"avatar-dropdown-2vG","avatar-trigger":"avatar-trigger-108",avatarTrigger:"avatar-trigger-108","menu-item":"menu-item-Hdq",menuItem:"menu-item-Hdq",avatar:"avatar-2js","check-icon":"check-icon-1o4",checkIcon:"check-icon-1o4",checked:"checked-Hpf",text:"text-1_8"}},1645:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ACTION={UPDATE_TASK_COUNT:"REFERENCE.SELECTOR.UPDATE.TASK.COUNT",UPDATE_FILE_COUNT:"REFERENCE.SELECTOR.UPDATE.FILE.COUNT",UPDATE_MR_COUNT:"REFERENCE.SELECTOR.UPDATE.MR.COUNT",UPDATE_WIKI_COUNT:"REFERENCE.SELECTOR.UPDATE.WIKI.COUNT",UPDATE_RELEASE_COUNT:"REFERENCE.SELECTOR.UPDATE.RELEASE.COUNT",UPDATE_SEARCH_TYPE:"REFERENCE.SELECTOR.UPDATE.SEARCH.TYPE",UPDATE_REFERENCES:"REFERENCE.SELECTOR.UPDATE.REFERENCES",UPDATE_KEYWORD:"REFERENCE.SELECTOR.UPDATE.KEYWORD",SELECT_REFERENCE:"REFERENCE.SELECTOR.SELECT.REFERENCE",UNSELECT_REFERENCE:"REFERENCE.SELECTOR.UNSELECT.REFERENCE",UPDATE_INITIAL_SELECTEDS:"REFERENCE.SELECTOR.UPDATE.INITIAL.SELECTEDS",GOTO_PAGE:"REFERENCE.SELECTOR.GOTO.PAGE",RESET_PROJECT_DATA:"REFERENCE.SELECTOR.RESET_PROJECT_DATA"},t.SEARCH_TYPE={NONE:"",TASK:"Task",FILE:"ProjectFile",MR:"MergeRequestBean",WIKI:"Wiki",RELEASE:"Release",MILESTONE:"Milestone",EXTERNAL_LINK:"ExternalLink",TESTING_PLAN_CASE_RESULT:"TestingPlanCaseResult"},t.TAB_TYPE={INNER_PROJECT:"inner_project",OUTER_PROJECT:"outer_project",OUTER_WEBSIDE:"outer_webside"},t.INPUT_TYPE={TITLE:"outerResourceTitle",LINK:"outerResourceLink"}},1802:function(e,t){e.exports={"zh-CN":{"ref.count":"\u5173\u8054\u8d44\u6e90 (${count})","create.task":"\u521b\u5efa\u4efb\u52a1","add.resource":"\u6dfb\u52a0\u8d44\u6e90",activity:"\u52a8\u6001","comment.only":"\u53ea\u770b\u8bc4\u8bba","created.task":"\u521b\u5efa\u4e86\u4efb\u52a1","close.comment":"\u6536\u8d77\u8bc4\u8bba","open.comment":"\u6253\u5f00\u8bc4\u8bba (${count})",placeholder:"\u8bc4\u8bba\u8be5\u56de\u7b54","reference.id":"\u5f15\u7528 ID","belong.to.project":"\u6240\u5c5e\u9879\u76ee","delete.task":"\u5220\u9664\u4efb\u52a1","add.reference.tip":"\u70b9\u51fb\u53f3\u4e0a\u89d2\u201c+\u201d\u5173\u8054\u9879\u76ee\u8d44\u6e90\uff08\u91cc\u7a0b\u7891\u3001\u4efb\u52a1\u3001\u5408\u5e76\u8bf7\u6c42\u7b49\uff09","add.reference.tip_enterprise":"\u70b9\u51fb\u53f3\u4e0a\u89d2\u201c+\u201d\u5173\u8054\u9879\u76ee\u8d44\u6e90\uff08\u91cc\u7a0b\u7891\u3001\u4efb\u52a1\u3001\u5408\u5e76\u8bf7\u6c42\u7b49\uff09\u53ca\u6dfb\u52a0\u5916\u90e8\u94fe\u63a5","add.reference.task":"\u6dfb\u52a0\u4e00\u4e2a\u5173\u8054\u4efb\u52a1\uff08\u56de\u8f66\u5b8c\u6210\u6dfb\u52a0\uff09","more.resource":"\u66f4\u591a\u8d44\u6e90","no.search.result":"\u65e0\u641c\u7d22\u7ed3\u679c","add.label":"\u6dfb\u52a0\u4e86\u6807\u7b7e - ${label}","remove.label":"\u79fb\u9664\u4e86\u6807\u7b7e - ${label}","history.label":"\u5386\u53f2\u6807\u7b7e - ${label}","update.label":"\u66f4\u65b0\u4e86\u6807\u7b7e\u4e3a - ${label}","remove.all.label":"\u79fb\u9664\u4e86\u6240\u6709\u6807\u7b7e","update.description":"\u66f4\u65b0\u4e86\u4efb\u52a1\u63cf\u8ff0","finish.task":"\u5b8c\u6210\u4e86\u4efb\u52a1","restore.task":"\u91cd\u65b0\u5f00\u542f\u4e86\u4efb\u52a1","reassign.task":"\u91cd\u65b0\u6307\u6d3e\u4e86\u4efb\u52a1\u7ed9","update.priority":"\u66f4\u65b0\u4e86\u4efb\u52a1\u4f18\u5148\u7ea7\u4e3a","priority.3":"\u5341\u4e07\u706b\u6025","priority.2":"\u4f18\u5148\u5904\u7406","priority.1":"\u6b63\u5e38\u5904\u7406","priority.0":"\u6709\u7a7a\u5728\u770b","delete.deadline":"\u79fb\u9664\u4e86\u4efb\u52a1\u7684\u622a\u6b62\u65e5\u671f","delete.start_date":"\u79fb\u9664\u4e86\u4efb\u52a1\u7684\u5f00\u59cb\u65e5\u671f","delete.end_date":"\u79fb\u9664\u4e86\u4efb\u52a1\u7684\u5b8c\u6210\u65e5\u671f","update.deadline":"\u66f4\u65b0\u4e86\u4efb\u52a1\u7684\u622a\u6b62\u65e5\u671f\u4e3a","update.start_date":"\u66f4\u65b0\u4e86\u4efb\u52a1\u7684\u5f00\u59cb\u65e5\u671f\u4e3a","update.end_date":"\u66f4\u65b0\u4e86\u4efb\u52a1\u7684\u5b8c\u6210\u65e5\u671f\u4e3a","update.complete_percent":"\u66f4\u65b0\u4e86\u4efb\u52a1\u7684\u5b8c\u6210\u767e\u5206\u6bd4\u4e3a","add.watcher":"\u6dfb\u52a0\u4e86\u5173\u6ce8\u8005","remove.watcher":"\u79fb\u9664\u4e86\u5173\u6ce8\u8005","update.task":"\u66f4\u65b0\u4e86\u4efb\u52a1",publish:"\u53d1\u8868","publish.comment":"\u53d1\u8868\u8bc4\u8bba","publish.comment.and.close":"\u8bc4\u8bba\u540c\u65f6\u5173\u95ed\u4efb\u52a1","publish.description":"\u66f4\u65b0\u63cf\u8ff0",cancel:"\u53d6\u6d88","confirm.to.delete":"\u786e\u5b9a\u5220\u9664\u4efb\u52a1\uff1f","no.description.tip":"\u6ca1\u6709\u4efb\u52a1\u63cf\u8ff0\uff0c\u70b9\u51fb\u6dfb\u52a0",delete:"\u5220\u9664",reply:"\u56de\u590d","confirm.to.delete.comment":"\u786e\u5b9a\u5220\u9664\u8bc4\u8bba\uff1f","confirm.to.delete.reference":"\u786e\u5b9a\u5220\u9664\u5173\u8054\uff1f","view.version":"\u67e5\u770b\u8be5\u7248\u672c","history.tip":"\u672c\u7248\u672c\u7531 ${user} \u7f16\u8f91\u4e8e ${time}","restore.history.success":"\u6062\u590d\u5386\u53f2\u7248\u672c\u6210\u529f","create.mr":"\u521b\u5efa\u4e86\u5408\u5e76\u8bf7\u6c42","merge.mr":"\u5408\u5e76\u4e86\u5408\u5e76\u8bf7\u6c42","refuse.mr":"\u5173\u95ed\u4e86\u5408\u5e76\u8bf7\u6c42","in.branch":"\u5728\u5206\u652f","commit.refer.task":"\u4e2d\u63d0\u4ea4\u7684\u4ee3\u7801\u63d0\u5230\u4e86\u4efb\u52a1","confirm.to.leave.without.saving":"\u6700\u65b0\u63cf\u8ff0\u8fd8\u672a\u4fdd\u5b58\uff0c\u786e\u8ba4\u79bb\u5f00\uff1f","comment.not.empty":"\u4efb\u52a1\u8bc4\u8bba\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a","add.milestone":"\u6dfb\u52a0\u4e86\u91cc\u7a0b\u7891","remove.milestone":"\u5220\u9664\u4e86\u91cc\u7a0b\u7891","add.reference.to":"\u5173\u8054\u4e86${type}","add.reference":"\u5173\u8054\u4e86","add.reference.of":"\u7684${type}","remove.reference.to":"\u53d6\u6d88\u5173\u8054\u7684${type}","remove.reference":"\u53d6\u6d88\u5173\u8054","remove.reference.of":"\u7684${type}",milestone:"\u91cc\u7a0b\u7891",task:"\u4efb\u52a1",file:"\u6587\u4ef6",wiki:" Wiki",release:"\u7248\u672c\u53d1\u5e03",mr:"\u5408\u5e76\u8bf7\u6c42","external.link":"\u5916\u90e8\u94fe\u63a5","testing.plan.case.result":"\u6d4b\u8bd5\u7ed3\u679c"},"en-US":{"ref.count":"Referenced Resources (${count})","create.task":"Create Task","add.resource":"Add Resource",activity:"Activity","comment.only":"Comment Only","created.task":"created task","close.comment":"Close Comment","open.comment":"Open Comment (${count})",placeholder:"Comment on this answer","reference.id":"Reference ID","belong.to.project":"Belong To Project","delete.task":"Delete Task","add.reference.tip":'Click "+" on the right top side to reference related Task, File, Topic or Merge Request',"add.reference.task":"Add a referenced task (press enter to create)","more.resource":"More Resource","no.search.result":"No Search Result","add.label":"added label - ${label}","remove.label":"removed label - ${label}","history.label":"history label - ${label}","update.label":"updated label to - ${label}","remove.all.label":"removed all labels","update.description":"updated description","finish.task":"finished task","restore.task":"restored task","reassign.task":"reassigned task to","update.priority":"updated task priority to","priority.3":"Urgent","priority.2":"Primary","priority.1":"Normal","priority.0":"Later","delete.deadline":"deleted task deadline","delete.start_date":"deleted task start date","delete.end_date":"deleted task end date","update.deadline":"updated task deadline to","update.start_date":"updated task start date to","update.end_date":"updated task end date to","update.complete_percent":"updated task completed percentage to","add.watcher":"added watcher","remove.watcher":"removed watcher","update.task":"updated task","publish.comment":"Publish Comment","publish.comment.and.close":"Publish And Close","publish.description":"Update Description",cancel:"Cancel","confirm.to.delete":"Confirm to delete task?","no.description.tip":"Click to add description",delete:"Delete",reply:"Reply","confirm.to.delete.comment":"Confirm to delete task comment?","confirm.to.delete.reference":"Confirm to delete reference?","view.version":"View this version","history.tip":"This version is published by ${user} at ${time}","restore.history.success":"Restore description from history version success","create.mr":"created merge request","merge.mr":"merged merge request","refuse.mr":"closed merge request","in.branch":"referenced this task in branch","commit.refer.task":" ","confirm.to.leave.without.saving":"Confirm to leave without saving?","comment.not.empty":"Task comment can't be empty","add.milestone":"added milestone","remove.milestone":"removed milestone","add.reference.to":"associated ${type}","add.reference":"associated ","add.reference.of":"'s ${type}","remove.reference.to":"removed associated ${type}","remove.reference":"removed associated","remove.reference.of":"'s ${type}",milestone:"milestone",task:"task",file:"file",wiki:"Wiki",release:"release",mr:"merge request","external.link":"external link","testing.plan.case.result":"Test Result"}}},1803:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=h(n(0)),l=n(2),c=h(l),s=h(n(169)),u=h(n(560)),d=h(n(699)),f=n(78),p=n(51),m=n(266),E=h(n(2259));function h(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function T(e){var t=e.item,n=e.generateIconByType;if(t.loading)return c.default.createElement("div",{className:E.default.dropdownItem},c.default.createElement(d.default,null)," ",c.default.createElement("span",null,"\u8d44\u6e90\u52a0\u8f7d\u4e2d..."));if(t.empty)return c.default.createElement("div",{className:E.default.dropdownItem,onClick:function(e){return e.stopPropagation()}},c.default.createElement(p.I18n,{region:"TASK_DETAIL",i18n:"no.search.result",className:E.default.noSearchResult}));if(t.more)return c.default.createElement("div",{className:E.default.dropdownItem},c.default.createElement(p.I18n,{region:"TASK_DETAIL",i18n:"more.resource",className:E.default.more}));var r="Release"===t.target_type&&t.link.split("/").pop();return c.default.createElement("div",{className:E.default.dropdownItem},n(t.target_type),c.default.createElement("span",null,"#",t.code," ",t.title||r))}T.propTypes={item:i.default.object,generateIconByType:i.default.func};var g=(0,m.withAsyncMarkEditor)()((0,f.hocDropdown)(function(){return c.default.createElement("span",{className:E.default.headerButton},c.default.createElement(u.default,null),c.default.createElement(p.I18n,{region:"TASK_DETAIL",i18n:"add.resource"}))},T)),C=(a=r=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.state={items:[]},r.onSelect=function(e){e.empty||(e.more?r.props.onShowSelector():r.props.onSelect(e))},y(r,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"componentWillReceiveProps",value:function(e){e.loading?this.setState({items:[{loading:!0},{more:!0}]}):(e.items===this.props.items&&e.references===this.props.references||this.setState({items:this.generateDropdownItems(e)}),(0,s.default)(e.detail,this.props.detail)||this.setState({items:[{more:!0}]}))}},{key:"generateDropdownItems",value:function(e){if(e.loading)return[{loading:!0},{more:!0}];var t=e.items.filter(function(t){var n=t.code;return n!==e.detail.number&&!e.references.find(function(e){return e.code===n})});return 0===t.length&&(t=[{empty:!0}]),t.push({more:!0}),t}},{key:"render",value:function(){return c.default.createElement(g,{items:this.state.items,className:E.default.dropdown,searchable:!0,searchPlaceholder:"\u7b5b\u9009\u8d44\u6e90",onSearch:this.props.onSearch,onSelect:this.onSelect,onToggle:this.props.onToggle})}}]),t}(),r.propTypes={detail:i.default.object,references:i.default.array,items:i.default.array,loading:i.default.bool,onSearch:i.default.func.isRequired,onSelect:i.default.func,onToggle:i.default.func,onShowSelector:i.default.func},r.defaultProps={onToggle:function(e){e||(void 0).props.onSearch("")}},a);t.default=C},1804:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=m(n(0)),c=n(2),s=m(c),u=n(113),d=n(114),f=m(n(3640)),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(3643));function m(e){return e&&e.__esModule?e:{default:e}}var E=(a=r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.Component),i(t,[{key:"componentWillReceiveProps",value:function(e){e.show&&e.show!==this.props.show&&(this.getCounts(e),this.props.updateInitialSelecteds(this.props.initialSelecteds))}},{key:"getCounts",value:function(e){var t=e.currentProject.id;e.getTaskCount(t),e.getFileCount(t),e.getMRCount(),e.getWikiCount(),e.getReleaseCount()}},{key:"render",value:function(){return s.default.createElement(f.default,this.props)}}]),t}(),r.propTypes=o({},f.default.propTypes,{initialSelecteds:l.default.array}),a);t.default=(0,u.connect)(function(e){return o({},e.REFERENCE_SELECTOR,{currentProject:e.APP.currentProject})},function(e){return o({},(0,d.bindActionCreators)(p,e))})(E)},2257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=p(n(0)),l=n(2),c=p(l),s=p(n(8)),u=n(51),d=p(n(1547)),f=p(n(3635));function p(e){return e&&e.__esModule?e:{default:e}}var m=(a=r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,u.injectAsyncI18n)("COLLAPSE_WINDOW",n(3637)),r.state={collapse:!0,currentHeight:0},r.onOpen=r.onOpen.bind(r),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"componentDidMount",value:function(){this.updateCurrentHeight()}},{key:"componentWillReceiveProps",value:function(){this.state.collapse&&this.updateCurrentHeight()}},{key:"updateCurrentHeight",value:function(){var e=this;this.selfRef&&(this.setState({currentHeight:this.selfRef.offsetHeight}),(0,d.default)(this.selfRef.getElementsByTagName("img"),function(t){t.complete||(t.onload=t.onerror=function(){e.selfRef&&e.setState({currentHeight:e.selfRef.offsetHeight})})}))}},{key:"onOpen",value:function(){this.setState({collapse:!1})}},{key:"renderMash",value:function(){return c.default.createElement("div",{className:f.default.overlay,onClick:this.onOpen},c.default.createElement("div",{className:f.default.mask}),c.default.createElement("div",{className:f.default.monkey}),c.default.createElement(u.I18n,{region:"COLLAPSE_WINDOW",i18n:"more.content",className:f.default.button}))}},{key:"render",value:function(){var e=this,t=this.state.collapse&&this.state.currentHeight>=this.props.maxHeight;return c.default.createElement("div",{className:(0,s.default)(f.default.container,this.props.className,{"collapse-content-has-mask":t}),style:{maxHeight:this.state.collapse?this.props.maxHeight:"none"},ref:function(t){return e.selfRef=t}},c.default.createElement("div",{className:f.default.content},t&&this.renderMash(),this.props.children))}}]),t}(),r.propTypes={className:i.default.string,children:i.default.any,maxHeight:i.default.number},r.defaultProps={maxHeight:500},a);t.default=m},2258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReferenceArray=function(e){if((0,o.default)(e))return[];return[].concat(i(e.Task||[]),i(e.MergeRequestBean||[]),i(e.ProjectFile||[]),i(e.Wiki||[]),i(e.Release||[]),i(e.Milestone||[]),i(e.ExternalLink||[]))};var r,a=n(76),o=(r=a)&&r.__esModule?r:{default:r};function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}},2259:function(e,t,n){e.exports={container:"container-HLK",header:"header-3UC","cuk-list":"cuk-list-1Bq",cukList:"cuk-list-1Bq","header-button":"header-button-2le",headerButton:"header-button-2le",list:"list-2lv","list-item":"list-item-3yp",listItem:"list-item-3yp",close:"close-GzE","item-icon":"item-icon-1UR",itemIcon:"item-icon-1UR",link:"link-2mn",dropdown:"dropdown-5aM","dropdown-item":"dropdown-item-FQy",dropdownItem:"dropdown-item-FQy","no-search-result":"no-search-result-2b3",noSearchResult:"no-search-result-2b3",more:"more-20C",avatar:"avatar-2s0",input:"input-ixI","link-container":"link-container-2na",linkContainer:"link-container-2na","empty-item":"empty-item-6xI",emptyItem:"empty-item-6xI"}},3635:function(e,t,n){e.exports={container:"container-gqa",content:"content-l4R",mask:"mask-2jV",button:"button-3G2",overlay:"overlay-2kU",monkey:"monkey-3mK"}},3637:function(e,t){e.exports={"zh-CN":{"more.content":"\u70b9\u51fb\u67e5\u770b\u5b8c\u6574\u5185\u5bb9"},"en-US":{"more.content":"Click to view full content"}}},3640:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=I(n(0)),c=n(2),s=I(c),u=n(51),d=I(n(549)),f=I(n(261)),p=I(n(1474)),m=I(n(1453)),E=I(n(544)),h=I(n(711)),y=I(n(1976)),T=I(n(723)),g=I(n(720)),C=I(n(1549)),v=I(n(729)),b=I(n(550)),R=I(n(552)),_=I(n(1455)),k=I(n(8)),S=I(n(554)),P=n(266),O=n(1645),N=n(3641);function I(e){return e&&e.__esModule?e:{default:e}}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=m.default.Item,L=(0,P.withAsyncMarkEditor)()((o=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onUpdateSearchType=n.onUpdateSearchType.bind(n),n.onKeywordChange=n.onKeywordChange.bind(n),n.gotoPage=n.gotoPage.bind(n),n.onSearch=(0,S.default)(n.onSearch.bind(n),200),n.renderListItem=n.renderListItem.bind(n),n.renderLabel=n.renderLabel.bind(n),n.onConfirm=n.onConfirm.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.Component),i(t,[{key:"onUpdateSearchType",value:function(e){var t=void 0;t=e===this.props.searchType?O.SEARCH_TYPE.NONE:e,this.props.onUpdateSearchType(t),this.onSearch(t,this.props.keyword,1)}},{key:"onKeywordChange",value:function(e,t){this.props.onKeywordChange(t),this.onSearch(this.props.searchType,t,1)}},{key:"gotoPage",value:function(e){this.props.gotoPage(e),this.onSearch(this.props.searchType,this.props.keyword,e)}},{key:"onConfirm",value:function(){var e=this;this.props.onConfirm(this.props.selecteds).then(function(){e.props.onHide()})}},{key:"onSearch",value:function(e,t,n){this.props.onSearch(e,t,n)}},{key:"renderListItem",value:function(e,t){var n,r=this,a="Release"===e.target_type&&e.link.split("/").pop();return s.default.createElement(A,{key:t,className:(0,k.default)(N.listItem,(n={},w(n,N.listItemActive,this.props.selecteds.find(function(t){return t.code===e.code})),w(n,N.listItemDisabled,this.props.excludeds.find(function(t){return t.code===e.code})),n)),onClick:function(){return r.props.onSelectReference(e)}},s.default.createElement(b.default,{className:N.check}),this.props.generateIconByType(e.target_type),s.default.createElement("span",{className:N.itemTitle},e.title||a))}},{key:"renderLabel",value:function(e,t){var n=this;return s.default.createElement(R.default,{key:t,onDismiss:function(){return n.props.onUnselectReference(e)},bgColor:"#76808E",className:N.label},"#",e.code)}},{key:"render",value:function(){var e=this,t=this.props.searchType;return s.default.createElement(d.default,{className:N.modal,show:this.props.show,onHide:this.props.onHide},s.default.createElement(u.I18n,{region:"REFERENCE_SELECTOR",i18n:"related.resource",className:N.header}),s.default.createElement("div",{className:N.content},s.default.createElement("div",{className:N.left},s.default.createElement(f.default,{block:!0,placeholder:u.I18n.get("REFERENCE_SELECTOR","search"),icon:s.default.createElement(p.default,null),value:this.props.keyword,onChange:this.onKeywordChange}),s.default.createElement(m.default,{type:"block",hover:!0,empty:s.default.createElement("div",null),className:N.menuList},s.default.createElement(A,{className:(0,k.default)(N.menuItem,w({},N.activeItem,t===O.SEARCH_TYPE.MILESTONE)),onClick:function(){return e.onUpdateSearchType(O.SEARCH_TYPE.MILESTONE)}},s.default.createElement(y.default,{className:N.menuIcon}),s.default.createElement(u.I18n,{region:"REFERENCE_SELECTOR",i18n:"milestone",className:N.menuTitle})),s.default.createElement(A,{className:(0,k.default)(N.menuItem,w({},N.activeItem,t===O.SEARCH_TYPE.TASK)),onClick:function(){return e.onUpdateSearchType(O.SEARCH_TYPE.TASK)}},s.default.createElement(h.default,{className:N.menuIcon}),s.default.createElement(u.I18n,{region:"REFERENCE_SELECTOR",i18n:"task",className:N.menuTitle})),s.default.createElement(A,{className:(0,k.default)(N.menuItem,w({},N.activeItem,t===O.SEARCH_TYPE.FILE)),onClick:function(){return e.onUpdateSearchType(O.SEARCH_TYPE.FILE)}},s.default.createElement(T.default,{className:N.menuIcon}),s.default.createElement(u.I18n,{region:"REFERENCE_SELECTOR",i18n:"file",className:N.menuTitle})),s.default.createElement(A,{className:(0,k.default)(N.menuItem,w({},N.activeItem,t===O.SEARCH_TYPE.MR)),onClick:function(){return e.onUpdateSearchType(O.SEARCH_TYPE.MR)}},s.default.createElement(g.default,{className:N.menuIcon}),s.default.createElement(u.I18n,{region:"REFERENCE_SELECTOR",i18n:"mr",className:N.menuTitle})),s.default.createElement(A,{className:(0,k.default)(N.menuItem,w({},N.activeItem,t===O.SEARCH_TYPE.RELEASE)),onClick:function(){return e.onUpdateSearchType(O.SEARCH_TYPE.RELEASE)}},s.default.createElement(C.default,{className:N.menuIcon}),s.default.createElement(u.I18n,{region:"REFERENCE_SELECTOR",i18n:"release",className:N.menuTitle})),s.default.createElement(A,{className:(0,k.default)(N.menuItem,w({},N.activeItem,t===O.SEARCH_TYPE.WIKI)),onClick:function(){return e.onUpdateSearchType(O.SEARCH_TYPE.WIKI)}},s.default.createElement(v.default,{className:N.menuIcon}),s.default.createElement(u.I18n,{region:"REFERENCE_SELECTOR",i18n:"wiki",className:N.menuTitle})))),s.default.createElement("div",{className:N.right},s.default.createElement(m.default,{className:N.list,type:"block",hover:!0,empty:s.default.createElement("div",null),bordered:!0},this.props.list.map(this.renderListItem)),s.default.createElement(_.default,{className:N.pagination,pager:{page:this.props.page,totalPage:this.props.totalPage},onChange:this.gotoPage}))),s.default.createElement("div",{className:N.labels},s.default.createElement(u.I18n,{region:"REFERENCE_SELECTOR",i18n:"added.resource",className:"mr-5",params:{count:this.props.selecteds.length}}),this.props.selecteds.map(this.renderLabel)),s.default.createElement(E.default,{className:N.confirm,onClick:this.onConfirm},s.default.createElement(u.I18n,{region:"REFERENCE_SELECTOR",i18n:"confirm"})),s.default.createElement(E.default,{empty:!0,onClick:this.props.onHide},s.default.createElement(u.I18n,{region:"REFERENCE_SELECTOR",i18n:"cancel"})))}}]),t}(),a.propTypes={show:l.default.bool,onHide:l.default.func,taskCount:l.default.number,fileCount:l.default.number,mrCount:l.default.number,wikiCount:l.default.number,releaseCount:l.default.number,searchType:l.default.string,list:l.default.array,selecteds:l.default.array,excludeds:l.default.array,keyword:l.default.string,onKeywordChange:l.default.func,onSearch:l.default.func,onUpdateSearchType:l.default.func,onSelectReference:l.default.func,onUnselectReference:l.default.func,page:l.default.number,totalPage:l.default.number,gotoPage:l.default.func,onConfirm:l.default.func,generateIconByType:l.default.func},r=o))||r;t.default=L},3641:function(e,t,n){e.exports={modal:"modal-2oB",header:"header-zKe",content:"content-1i_",contentEnterprise:"contentEnterprise-1vf",left:"left-1oU",right:"right-2rP",list:"list-j-V","list-item":"list-item-3P_",listItem:"list-item-3P_",check:"check-2hm","list-item-active":"list-item-active-2mf",listItemActive:"list-item-active-2mf","list-item-disabled":"list-item-disabled-yQG",listItemDisabled:"list-item-disabled-yQG","item-title":"item-title-351",itemTitle:"item-title-351",pagination:"pagination-1Lg",labels:"labels-1J1",label:"label-nPX","label-enterprise":"label-enterprise-3hS",labelEnterprise:"label-enterprise-3hS",confirm:"confirm-3Fp","menu-list":"menu-list-1ip",menuList:"menu-list-1ip","menu-item":"menu-item-2PY",menuItem:"menu-item-2PY","active-item":"active-item-2bz",activeItem:"active-item-2bz","menu-icon":"menu-icon-2bu",menuIcon:"menu-icon-2bu","menu-title":"menu-title-JBX",menuTitle:"menu-title-JBX","menu-item-count":"menu-item-count-1a_",menuItemCount:"menu-item-count-1a_",operation:"operation-36n","project-ref":"project-ref-2Ik",projectRef:"project-ref-2Ik","form-container":"form-container-ErM",formContainer:"form-container-ErM","form-row":"form-row-3_J",formRow:"form-row-3_J","loading-cls":"loading-cls-3ej",loadingCls:"loading-cls-3ej","no-task-container":"no-task-container-3T7",noTaskContainer:"no-task-container-3T7","no-task-text":"no-task-text-2zF",noTaskText:"no-task-text-2zF","no-task-icon":"no-task-icon-1g4",noTaskIcon:"no-task-icon-1g4","right-container":"right-container-3Vd",rightContainer:"right-container-3Vd","testing-exp-content":"testing-exp-content-2-w",testingExpContent:"testing-exp-content-2-w"}},3643:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTaskCount=function(){return(0,o.dispatchWithProjectAPIPrefix)(function(e,t){var n=(0,r.get)(e+"/resource/search?q=&pageSize=1&type=Task");return n.then(function(e){t({type:a.ACTION.UPDATE_TASK_COUNT,payload:e.data.totalRow})}),n})},t.getFileCount=function(){return(0,o.dispatchWithProjectAPIPrefix)(function(e,t){var n=(0,r.get)(e+"/resource/search?q=&pageSize=1&type=ProjectFile");return n.then(function(e){t({type:a.ACTION.UPDATE_FILE_COUNT,payload:e.data.totalRow})}),n})},t.getMRCount=function(){return(0,o.dispatchWithProjectAPIPrefix)(function(e,t){var n=(0,r.get)(e+"/resource/search?q=&pageSize=1&type=MergeRequestBean");return n.then(function(e){t({type:a.ACTION.UPDATE_MR_COUNT,payload:e.data.totalRow})}),n})},t.getWikiCount=function(){return(0,o.dispatchWithProjectAPIPrefix)(function(e,t){var n=(0,r.get)(e+"/resource/search?q=&pageSize=1&type=Wiki");return n.then(function(e){t({type:a.ACTION.UPDATE_WIKI_COUNT,payload:e.data.totalRow})}),n})},t.getReleaseCount=function(){return(0,o.dispatchWithProjectAPIPrefix)(function(e,t){var n=(0,r.get)(e+"/resource/search?q=&pageSize=1&type=Release");return n.then(function(e){t({type:a.ACTION.UPDATE_RELEASE_COUNT,payload:e.data.totalRow})}),n})},t.onUpdateSearchType=function(e){return{type:a.ACTION.UPDATE_SEARCH_TYPE,searchType:e}},t.onSearch=function(e,t,n,i){var l=void 0;l=t?"#"===t.charAt(0)?encodeURIComponent(t.slice(1)):encodeURIComponent(t):"";return(0,o.dispatchWithProjectAPIPrefix)(function(t,o){var c=t;if(i){var s="string"===typeof t?t.split("/"):[];s.pop(),s.push(i),c=s.join("/")}var u=(0,r.get)(c+"/resource/search?q="+l+"&type="+e+"&page="+n+"&pageSize=10");return u.then(function(e){e.data.list=e.data.list.map(function(e){return e.project_name=i,e}),o({type:a.ACTION.UPDATE_REFERENCES,payload:e.data})}),u})},t.onKeywordChange=function(e){return{type:a.ACTION.UPDATE_KEYWORD,keyword:e}},t.updateInitialSelecteds=function(e){return{type:a.ACTION.UPDATE_INITIAL_SELECTEDS,selecteds:e}},t.onSelectReference=function(e){return{type:a.ACTION.SELECT_REFERENCE,reference:e}},t.onUnselectReference=function(e){return{type:a.ACTION.UNSELECT_REFERENCE,reference:e}},t.gotoPage=function(e){return{type:a.ACTION.GOTO_PAGE,page:e}},t.resetProjectData=function(){return{type:a.ACTION.RESET_PROJECT_DATA}};var r=n(84),a=n(1645),o=n(548)}}]);
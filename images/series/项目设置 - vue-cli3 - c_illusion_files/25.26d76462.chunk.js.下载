(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{1459:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subFolderPropTypes=t.normalizedHistoriesPropTypes=t.historyPropTypes=t.promisePropTypes=t.previewPropTypes=t.folderPathPropTypes=t.sortPropTypes=t.normalizedFilesTypes=t.sharePropTypes=t.filePropTypes=t.userPropTypes=t.types=void 0;var a,r=n(0),o=(a=r)&&a.__esModule?a:{default:a},i=n(1541),l=n(1479);var u=new i.schema.Entity("users"),s=new i.schema.Entity("shares",{},{idAttribute:"resourceId",defaults:{hash:""}}),c=new i.schema.Entity("files",{share:s,owner:u}),f=new i.schema.Array(c),d=new i.schema.Entity("histories",{owner:u},{idAttribute:"historyId"}),p=new i.schema.Array(d),m=(t.types={user:u,files:f,histories:p},t.userPropTypes=o.default.shape({name:o.default.string})),h=t.filePropTypes=o.default.shape({id:o.default.oneOfType([o.default.number,o.default.string]),name:o.default.string,number:o.default.number,size:o.default.number,sizeText:o.default.string,updatedAtText:o.default.string,createdAtText:o.default.string,preview:o.default.string,owner:o.default.number,share:o.default.number,select:o.default.bool,progress:o.default.number}),y=t.sharePropTypes=o.default.shape({hash:o.default.string}),v=(t.normalizedFilesTypes=o.default.shape({result:o.default.arrayOf(o.default.oneOfType([o.default.number,o.default.string])),entities:o.default.shape({files:o.default.objectOf(h),users:o.default.objectOf(m),share:o.default.objectOf(y)})}),t.sortPropTypes=o.default.shape({field:o.default.string,sort:o.default.oneOf(Object.values(l.SORT))}),t.folderPathPropTypes=o.default.shape({name:o.default.string,fileId:o.default.number,parentId:o.default.number}),o.default.shape({content:o.default.string})),E=(t.previewPropTypes=o.default.shape({current:h,previous:h,next:h,editing:o.default.bool.isRequired,renaming:o.default.bool.isRequired,viewFile:v}),t.promisePropTypes=o.default.shape({then:o.default.func.isRequired,catch:o.default.func.isRequired,finally:o.default.func.isRequired}),t.historyPropTypes=o.default.shape({name:o.default.string,version:o.default.number,ownerId:o.default.number,createdAtText:o.default.string}));t.normalizedHistoriesPropTypes=o.default.shape({result:o.default.arrayOf(o.default.number),entities:o.default.shape({histories:o.default.objectOf(E),users:o.default.objectOf(m)})}),t.subFolderPropTypes=o.default.shape({name:o.default.string,fileId:o.default.number,updatedAt:o.default.number})},1462:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.getProjectFiles=s,t.sortFiles=function(e){var t=e.field,n=e.sort;return{type:l.ACTION.SORT_PROJECT_FILES,sort:{field:t,sort:n}}},t.deleteFile=c,t.deleteFolder=function(e,t){return function(n){return n(c(e,[t]))}},t.batchDeleteFiles=function(e){return function(t,n){var a=n().PROJECT.file,r=a.originalFiles,o=a.isFiltering,i=r.filter(function(e){var t=e.select,n=e.type,a=e.size;return t&&l.TYPE.FOLDER!==n||t&&l.TYPE.FOLDER===n&&0===a});o&&(i=i.filter(function(e){return e.filtered}));var u=i.map(function(e){return e.id});return t(c(e,u,!0))}},t.toggleSelectFile=function(e){return{type:l.ACTION.TOGGLE_SELECT_PROJECT_FILE,fileId:e}},t.toggleSelectAll=function(){return{type:l.ACTION.TOGGLE_SELECT_ALL_PROJECT_FILE}},t.asyncDownloadFolder=function(e,t){var n=e+"/folder/"+t+"/download/async";return function(e){return(0,o.autoDispatch)((0,r.get)(n),e,l.ACTION.ASYNC_DOWNLOAD_FOLDER)}},t.asyncDownloadFilesAndFolders=function(e,t){var n=e+"/files/mixed/download/async";return function(e){return(0,o.autoDispatch)((0,r.post)(n,{fileIds:t}),e,l.ACTION.ASYNC_DOWNLOAD_FILES_AND_FOLDER)}},t.filterFiles=function(e){return{type:l.ACTION.FILTER_FILES,key:e||""}},t.toggleNewFolder=function(){return{type:l.ACTION.NEW_FOLDER}},t.mkdir=function(e){return(0,o.dispatchWithProjectAPIPrefix)(function(t,n,a){var i=a().PROJECT.file.currentFolderId;return(0,o.autoDispatch)((0,r.post)(t+"/folder",{name:e,parentId:i}),n,l.ACTION.MKDIR,function(e){var t=e.data;return(0,r.toCamelCase)(t)})})},t.uploadFiles=function(e){return(0,o.dispatchWithProjectAPIPrefix)(function(t,n,a){return Promise.all((e||[]).map(function(e,i){var s=e.name,c=e.size,f=e.preview,d=e.type,p=a(),m=p.PROJECT.file.currentFolderId,h=p.APP.user,y={file:e,"x:dir":m,"x:projectId":p.APP.currentProject.id},v={name:s,parentId:m,owner:h,size:c,preview:f,type:d,progress:0,fileId:-(100-i)};return(0,o.autoDispatch)((0,r.uploadFile)(t+"/files/upload",y,{dir:m},function(e,t){var a=t.loaded,r=t.total,o=parseFloat(100*a/r).toFixed(2);n({type:l.ACTION.UPLOAD_FILES_PROGRESS,name:s,progress:o===1/0?100:+o})}),n,l.ACTION.UPLOAD_FILES,function(e){var t=e.data;return{file:(0,r.toCamelCase)(t)}},void 0,function(){return{uploadingFile:v}}).catch(function(t){return n({type:l.ACTION.UPLOAD_FILES,status:u.STATUS.FAIL,data:{file:e}}),Promise.reject(t)})})).then(function(){n({type:l.ACTION.UPLOAD_FILES_DONE})})})},t.getFolderPaths=function(e){return(0,o.dispatchWithProjectAPIPrefix)(function(t,n){return(0,o.autoDispatch)((0,r.get)(t+"/folder/"+e+"/fullpath"),n,l.ACTION.FOLDER_PATHS,function(e){var t=e.data;return(0,r.toCamelCase)(t)})})},t.updatePreviewFile=function(e){return{type:l.ACTION.UPDATE_PREVIEW_FILE,fileId:e}},t.previewFile=function(e){return{type:l.ACTION.PREVIEW_FILE,fileId:e}},t.quitFilePreview=function(){return{type:l.ACTION.PREVIEW_FILE,fileId:null}},t.renamePreviewFile=function(e){return{type:l.ACTION.RENAME_PREVIEW_FILE,renaming:e}},t.editPreviewFile=function(e){return{type:l.ACTION.EDIT_PREVIEW_FILE,editing:e}},t.viewFile=f,t.getDownloadUrl=function(e){return(0,o.dispatchWithProjectAPIPrefix)(function(t,n){return(0,o.autoDispatch)((0,r.get)(t+"/files/"+e+"/download/url"),n,l.ACTION.DOWNLOAD_URL,function(e){var t=e.data;return(0,r.toCamelCase)(t)})})},t.getMarkdownPreview=function(e){return(0,o.dispatchWithProjectAPIPrefix)(function(t,n){return(0,o.autoDispatch)((0,r.get)(t+"/files/"+e+"/markdown-preview"),n,l.ACTION.MARKDOWN_PREVIEW)})},t.getFileContent=d,t.getMarkdownPreviewByVersion=function(e,t){return function(n){return n(d(e,t)).then(function(e){return(0,i.createPreviewPromise)({content:e.content})})}},t.getFileActivity=p,t.getFileHistory=m,t.deleteFileHistory=function(e,t){return(0,o.dispatchWithProjectAPIPrefix)(function(n,a){return(0,o.autoDispatch)((0,r.del)(n+"/files/histories/"+e),a,l.ACTION.DELETE_HISTORY).then(function(){a(m(t))})})},t.renameFile=function(e,t){return(0,o.dispatchWithProjectAPIPrefix)(function(n,i){return(0,o.autoDispatch)((0,r.put)(n+"/files/"+t+"/rename",{name:e}),i,l.ACTION.RENAME_PROJECT_FILE,function(n){return a({},(0,r.toCamelCase)(n.data),{fileId:t,name:e})}).then(function(){i(m(t))})})},t.renameFolder=function(e,t){return(0,o.dispatchWithProjectAPIPrefix)(function(n,i){return(0,o.autoDispatch)((0,r.put)(n+"/folder/"+t,{name:e}),i,l.ACTION.RENAME_PROJECT_FILE,function(n){return a({},(0,r.toCamelCase)(n.data),{fileId:t,name:e})}).then(function(){i(m(t))})})},t.createFile=function(e,t,n){return(0,o.dispatchWithProjectAPIPrefix)(function(a,i){return(0,o.autoDispatch)((0,r.post)(a+"/files/"+e+"/files",{name:t,content:n}),i,l.ACTION.CREATE_FILE)})},t.updatePreviewTab=h,t.editFile=function(e,t,n){return(0,o.dispatchWithProjectAPIPrefix)(function(a,i,u){return(0,o.autoDispatch)((0,r.post)(a+"/files/"+e+"/edit",{name:t,content:n}).then(function(){return i(f(e))}),i,l.ACTION.EDIT_FILE,function(e){var t=e.file;return{file:t}}).then(function(){var t=u().PROJECT.file.preview.activeTabKey;i(h(t,e))})})},t.changePreviewActivityTabKey=function(e){return{type:l.ACTION.SET_PREVIEW_ACTIVITY_TAB_KEY,activeTabKey:e}},t.getSubFolders=function(e){return(0,o.dispatchWithProjectAPIPrefix)(function(t,n){return(0,o.autoDispatch)((0,r.get)(t+"/folder/"+e+"/sub-folders"),n,l.ACTION.GET_SUB_FOLDERS,function(t){var n=t.data;return{children:(0,r.toCamelCase)(n),folderId:e}})})},t.setFileMoving=y,t.moveFiles=function(e,t){return(0,o.dispatchWithProjectAPIPrefix)(function(n,a,i){var u=i().PROJECT.file,c=u.originalFiles,f=u.currentFolderId,d=c.filter(function(e){return e.select}).map(function(e){return e.fileId});return 0===d.length?Promise.reject():(0,o.autoDispatch)((0,r.post)(n+"/folder/"+e+"/move-files",{fileId:d}),a,l.ACTION.MOVE_FILES).then(function(){return a(y(!1)),t||a(s(f)),d.length})})},t.setShareModal=function(e,t){return{type:l.ACTION.SHOW_SHARE_MODAL,show:e,file:t}},t.shareFile=function(e,t){return function(n){var a=(0,r.post)("/api/share/create",{projectId:e,resourceId:t,resourceType:u.RESOURCE_TYPE.FILE,accessType:u.ACCESS_TYPE.PUBLIC});return a.then(function(e){n({type:l.ACTION.SHARE_FILE,payload:(0,r.toCamelCase)(e.data),fileId:t})}),a}},t.stopShareFile=function(e,t){return function(n){var a=(0,r.del)("/api/share/"+e);return a.then(function(){n({type:l.ACTION.STOP_SHARE_FILE,fileId:t})}),a}};var r=n(84),o=n(548),i=n(755),l=n(1479),u=n(106);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.FILE_PAGE_SIZE,u=(0,r.buildParams)({page:n,pageSize:i});return(0,o.dispatchWithProjectAPIPrefix)(function(n,i){return(0,o.autoDispatch)(t?(0,r.get)(n+"/folder/shared_files?height=90&width=90&"+u):(0,r.get)(n+"/folder/"+e+"/all?height=90&width=90&"+u),i,l.ACTION.LOAD_PROJECT_FILES,function(t){var n=t.data;return a({},(0,r.toCamelCase)(n),{folderId:e})})})}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===t.length)return null;var a=(0,r.buildParams)({fileIds:t});return function(i){return(0,o.autoDispatch)((0,r.del)("/api/project/"+e+"/file/delete?"+a),i,l.ACTION.DELETE_PROJECT_FILES,function(e){var a=e.data;return{fileIds:t,unSelectAll:n,deleteCount:a}})}}function f(e){return(0,o.dispatchWithProjectAPIPrefix)(function(t,n){return(0,o.autoDispatch)((0,r.get)(t+"/files/"+e+"/view"),n,l.ACTION.VIEW_FILE,function(e){var t=e.data;return(0,r.toCamelCase)(t)})})}function d(e,t){return function(n,a){var i=a().APP.currentProject,u=i.name,s=i.owner_user_name;return(0,o.autoDispatch)((0,r.get)("/api/user/"+s+"/project/"+u+"/file/"+e+"/history/"+t+"/view"),n,l.ACTION.PREVIEW_VERSION_FILE,function(e){var t=e.data;return(0,r.toCamelCase)(t)})}}function p(e){return(0,o.dispatchWithProjectAPIPrefix)(function(t,n){return(0,o.autoDispatch)((0,r.get)(t+"/file/"+e+"/activities?last_id="+l.MAYBE_LARGEST_ID),n,l.ACTION.FILE_ACTIVITY,function(e){var t=e.data;return(0,r.toCamelCase)(t)})})}function m(e){return(0,o.dispatchWithProjectAPIPrefix)(function(t,n){return(0,o.autoDispatch)((0,r.get)(t+"/files/"+e+"/histories"),n,l.ACTION.FILE_HISTORY,function(e){var t=e.data;return(0,r.toCamelCase)(t)})})}function h(e,t){switch(e){case"activity":return p(t);case"history":return m(t);default:return{type:"Sync unknown preview tab content"}}}function y(e){return{type:l.ACTION.SET_FILE_MOVING,moving:e}}},1479:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FILE_TYPE_TO_EXT_NAME=t.AVAILABLE_FILE_TYPES_TO_EDIT=t.AVAILABLE_FILE_TYPES_TO_CREATE=t.MAYBE_LARGEST_ID=t.MIN_DOWNLOAD_FILES_SIZE=t.TOOLBAR_ACTIONS=t.EDITABLE_FILE_REG=t.TYPE=t.SORT=t.FILE_PAGE_SIZE=t.STATUS=t.ACTION=void 0;var a=n(106);Object.defineProperty(t,"STATUS",{enumerable:!0,get:function(){return a.STATUS}});t.ACTION={LOAD_PROJECT_FILES:"FILE_LOAD_PROJECT_FILES",SORT_PROJECT_FILES:"FILE_SORT_PROJECT_FILES",DELETE_PROJECT_FILES:"FILE_DELETE_PROJECT_FILE",DELETE_PROJECT_FILES_AND_EMPTY_FOLDERS:"FILE_DELETE_PROJECT_FILES_AND_EMPTY_FOLDERS",RENAME_PROJECT_FILE:"FILE_RENAME_PROJECT_FILE",TOGGLE_SELECT_PROJECT_FILE:"FILE_TOGGLE_SELECT_PROJECT_FILE",TOGGLE_SELECT_ALL_PROJECT_FILE:"FILE_TOGGLE_SELECT_ALL_PROJECT_FILE",DELETE_PROJECT_FOLDER:"FILE_DELETE_PROJECT_FOLDER",ASYNC_DOWNLOAD_FOLDER:"FILE_ASYNC_DOWNLOAD_FOLDER",ASYNC_DOWNLOAD_FILES_AND_FOLDER:"FILE_ASYNC_DOWNLOAD_FILES_AND_FOLDER",FILTER_FILES:"FILE_FILTER_FILES",MKDIR:"FILE_MKDIR",NEW_FOLDER:"FILE_NEW_FOLDER",UPLOAD_FILES:"FILE_UPLOAD_FILES",UPLOAD_FILES_PROGRESS:"FILE_UPLOAD_FILES_PROGRESS",UPLOAD_FILES_DONE:"FILE_UPLOAD_FILES_DONE",FOLDER_PATHS:"FILE_FOLDER_PATHS",PREVIEW_FILE:"FILE_PREVIEW_FILE",UPDATE_PREVIEW_FILE:"FILE_UPDATE_PREVIEW_FILE",VIEW_FILE:"FILE_VIEW_FILE",EDIT_FILE:"FILE_EDIT_FILE",DOWNLOAD_URL:"FILE_DOWNLOAD_URL",MARKDOWN_PREVIEW:"FILE_MARKDOWN_PREVIEW",RENAME_PREVIEW_FILE:"FILE_RENAME_PREVIEW_FILE",EDIT_PREVIEW_FILE:"FILE_EDIT_PREVIEW_FILE",FILE_ACTIVITY:"FILE_FILE_ACTIVITY",FILE_HISTORY:"FILE_FILE_HISTORY",DELETE_HISTORY:"FILE_DELETE_HISTORY",CREATE_FILE:"FILE_CREATE_FILE",SET_PREVIEW_ACTIVITY_TAB_KEY:"SET_PREVIEW_ACTIVITY_TAB_KEY",GET_SUB_FOLDERS:"FILE_GET_SUB_FOLDERS",MOVE_FILES:"FILE_MOVE_FILES",SET_FILE_MOVING:"FILE_SET_FILE_MOVING",SHOW_SHARE_MODAL:"FILE_SHOW_SHARE_MODAL",SHARE_FILE:"FILE_SHARE_FILE",STOP_SHARE_FILE:"FILE_STOP_SHARE_FILE",PREVIEW_VERSION_FILE:"PREVIEW_VERSION_FILE"},t.FILE_PAGE_SIZE=500,t.SORT={ASC:"asc",DESC:"desc",NONE:null},t.TYPE=a.FILE_TYPE,t.EDITABLE_FILE_REG=/\.(txt|md)$/,t.TOOLBAR_ACTIONS={DOWNLOAD:"download",SHARE:"share",MOVE:"move",RENAME:"rename",DELETE:"delete",EDIT:"edit"},t.MIN_DOWNLOAD_FILES_SIZE=52428800,t.MAYBE_LARGEST_ID=999999999,t.AVAILABLE_FILE_TYPES_TO_CREATE={txt:"TXT",markdown:"Markdown"},t.AVAILABLE_FILE_TYPES_TO_EDIT=["txt","md"],t.FILE_TYPE_TO_EXT_NAME={txt:"txt",markdown:"md"}},1542:function(e,t,n){e.exports={toolbar:"toolbar-3Ds",item:"item-2ZI",rest:"rest-ykK","rest-item":"rest-item-bRw",restItem:"rest-item-bRw",tooltip:"tooltip-3Z_","file-breadcrumb":"file-breadcrumb-3BR",fileBreadcrumb:"file-breadcrumb-3BR","file-suffix-name":"file-suffix-name-3Rb",fileSuffixName:"file-suffix-name-3Rb","file-viewer":"file-viewer-lIo",fileViewer:"file-viewer-lIo","viewer-body":"viewer-body-2qn",viewerBody:"viewer-body-2qn","viewer-file-name":"viewer-file-name-Bos",viewerFileName:"viewer-file-name-Bos","viewer-file-name-input":"viewer-file-name-input-DcM",viewerFileNameInput:"viewer-file-name-input-DcM","viewer-file-content":"viewer-file-content-IRA",viewerFileContent:"viewer-file-content-IRA","viewer-editor":"viewer-editor-33Q",viewerEditor:"viewer-editor-33Q","viewer-editor-wrapper":"viewer-editor-wrapper-_Y_",viewerEditorWrapper:"viewer-editor-wrapper-_Y_","editor-header":"editor-header-3J_",editorHeader:"editor-header-3J_","name-input":"name-input-2Ov",nameInput:"name-input-2Ov",buttons:"buttons-1fu","viewer-menu":"viewer-menu-2Oh",viewerMenu:"viewer-menu-2Oh","viewer-toolbar":"viewer-toolbar-2YZ",viewerToolbar:"viewer-toolbar-2YZ","toolbar-item":"toolbar-item-k0e",toolbarItem:"toolbar-item-k0e","preview-file-name":"preview-file-name-1R_",previewFileName:"preview-file-name-1R_","preview-close":"preview-close-3hf",previewClose:"preview-close-3hf","viewer-tabs":"viewer-tabs-vB2",viewerTabs:"viewer-tabs-vB2","tab-content":"tab-content-3X0",tabContent:"tab-content-3X0","viewer-tabs-comment":"viewer-tabs-comment-2qA",viewerTabsComment:"viewer-tabs-comment-2qA","invisible-file":"invisible-file-3oo",invisibleFile:"invisible-file-3oo","fetch-loading":"fetch-loading-2Jd",fetchLoading:"fetch-loading-2Jd","fetch-error":"fetch-error-17m",fetchError:"fetch-error-17m","file-loading":"file-loading-1GQ",fileLoading:"file-loading-1GQ","file-error":"file-error-2hN",fileError:"file-error-2hN",top:"top-19S","file-success":"file-success-1lW",fileSuccess:"file-success-1lW"}},1543:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MARK_ICON=t.PHASE_ENUM=t.FEATURE_FILTER_LIST=t.TYPE_ENUM=t.STATUS_ENUM=t.PHASE_STATUS=t.ACTION=t.FLOW_TYPES=void 0;var a=s(n(2)),r=s(n(2237)),o=s(n(2238)),i=s(n(1740)),l=s(n(3422)),u=s(n(2095));function s(e){return e&&e.__esModule?e:{default:e}}t.FLOW_TYPES=[{title:"\u5feb\u901f\u8fed\u4ee3\u578b",member:"1-3 \u4f4d\u5f00\u53d1\u8005",short:"\u529f\u80fd\u6a21\u5757\u5c11",description:"\u5feb\u901f\u8fed\u4ee3\u578b\u6d41\u6c34\u7ebf\u9002\u5408 1-3 \u4eba\u7684\u5c0f\u578b\u56e2\u961f\uff0c\u5927\u5bb6\u540c\u65f6\u5728 master \u5206\u652f\u4e0a\u8fdb\u884c\u8282\u70b9\uff0c\u7b80\u5355\u5feb\u901f\u3002",type:1,status:"open",image:a.default.createElement("img",{src:n(3423),alt:"fast"})},{title:"\u5e76\u884c\u5f00\u53d1\u578b",member:"4-10 \u4f4d\u5f00\u53d1\u8005",short:"\u591a\u4e2a\u529f\u80fd\u6a21\u5757",description:"\u5e76\u884c\u5f00\u53d1\u578b\u6d41\u6c34\u7ebf\u9002\u5408 4-10 \u4eba\u7684\u5c0f\u578b\u56e2\u961f\uff0c\u5f00\u53d1\u65b0\u529f\u80fd\u9700\u8981\u521b\u5efa\u65b0\u5206\u652f\uff0c\u7136\u540e\u5408\u5e76\u5230 master \u5206\u652f\u5b8c\u6210\u53d1\u5e03\u3002",type:2,status:"open",image:a.default.createElement("img",{src:n(3424),alt:"concurrent"})}],t.ACTION={FETCH_FLOW_COMMITS:"FLOW.FETCH_FLOW_COMMITS",PUB_RELEASE:"FLOW.PUB_RELEASE",PHASE_CHANGE_STATUS:"FLOW.PHASE_CHANGE_STATUS",PHASE_ADD_MARK:"FLOW.PHASE_ADD_MARK",PHASE_AUTO_SKIP:"FLOW.PHASE_AUTO_SKIP",PHASE_AUTO_SKIP_CANCEL:"FLOW.PHASE_AUTO_SKIP_CANCEL",FETCH_FLOW_FLOWS:"FLOW.FETCH_FLOW_FLOWS",ADD_FLOW:"FLOW.ADD_FLOW",ADD_FEATURE_FLOW:"FLOW.ADD_FEATURE_FLOW",LIST_FEATURE_FLOW:"FLOW.LIST_FEATURE_FLOW",FETCH_FLOW_DETAIL:"FLOW.FETCH_FLOW_DETAIL",FETCH_FEATURE_FLOW_DETAIL:"FLOW.FETCH_FEATURE_FLOW_DETAIL",FEATURE_FLOW_APPLY_REVIEW:"FLOW.FEATURE_FLOW_APPLY_REVIEW"},t.PHASE_STATUS={SUCCESS:50,FAILED:60,SKIPPED:70},t.STATUS_ENUM={success:"success",pending:"pending",failed:"failed"},t.TYPE_ENUM={build:"build",test:"test",deploy:"deploy"},t.FEATURE_FILTER_LIST=[{type:"unfinished",text:"\u672a\u5b8c\u6210"},{type:"finished",text:"\u5df2\u5b8c\u6210"},{type:"all",text:"\u5168\u90e8"}],t.PHASE_ENUM=["\u6784\u5efa","\u6d4b\u8bd5","\u90e8\u7f72"].map(function(e,t){return{name:e,index:t}}),t.MARK_ICON=[{name:"circle-o",icon:a.default.createElement(r.default,null)},{name:"check-circle-o",icon:a.default.createElement(o.default,null)},{name:"dot-circle-o",icon:a.default.createElement(i.default,null)},{name:"exclamation-circle",icon:a.default.createElement(l.default,null)},{name:"download",icon:a.default.createElement(u.default,null)}]},1555:function(e,t,n){e.exports={"file-header":"file-header-2Gd",fileHeader:"file-header-2Gd",expanded:"expanded-2px",collapsed:"collapsed-1BD","file-list":"file-list-2wi",fileList:"file-list-2wi","file-item":"file-item-2ji",fileItem:"file-item-2ji","list-header":"list-header-1VA",listHeader:"list-header-1VA",sortable:"sortable-17v","file-item-regions":"file-item-regions-2uQ",fileItemRegions:"file-item-regions-2uQ","batch-toolbar":"batch-toolbar-122",batchToolbar:"batch-toolbar-122","file-name":"file-name-2f7",fileName:"file-name-2f7","folder-link":"folder-link-1zt",folderLink:"folder-link-1zt","file-name-header":"file-name-header-3kB",fileNameHeader:"file-name-header-3kB","file-name-toolbar":"file-name-toolbar-7Rh",fileNameToolbar:"file-name-toolbar-7Rh",gray:"gray-18e","share-icon":"share-icon-1sK",shareIcon:"share-icon-1sK","file-name-renaming":"file-name-renaming-1cn",fileNameRenaming:"file-name-renaming-1cn","file-rename":"file-rename-3F2",fileRename:"file-rename-3F2","file-rename-block":"file-rename-block-ZJI",fileRenameBlock:"file-rename-block-ZJI","file-stats":"file-stats-TCz",fileStats:"file-stats-TCz","file-top-menu":"file-top-menu-3Yr",fileTopMenu:"file-top-menu-3Yr","create-file-dropdown":"create-file-dropdown-220",createFileDropdown:"create-file-dropdown-220","file-list-container":"file-list-container-2gO",fileListContainer:"file-list-container-2gO","file-dropzone":"file-dropzone-6bs",fileDropzone:"file-dropzone-6bs","file-sticky":"file-sticky-3ua",fileSticky:"file-sticky-3ua","dropzone-tips":"dropzone-tips-RO4",dropzoneTips:"dropzone-tips-RO4","file-dropzone-active":"file-dropzone-active-1FP",fileDropzoneActive:"file-dropzone-active-1FP","center-region":"center-region-2by",centerRegion:"center-region-2by",menu:"menu-2-F","menu-item":"menu-item-1Ag",menuItem:"menu-item-1Ag"}},1573:function(e,t,n){e.exports={"file-preview-wrapper":"file-preview-wrapper-2WH",filePreviewWrapper:"file-preview-wrapper-2WH","previous-button":"previous-button-1FI",previousButton:"previous-button-1FI","next-button":"next-button-3tI",nextButton:"next-button-3tI","invisible-file":"invisible-file-1Ka",invisibleFile:"invisible-file-1Ka","fetch-loading":"fetch-loading-s-n",fetchLoading:"fetch-loading-s-n","fetch-error":"fetch-error-1F0",fetchError:"fetch-error-1F0","file-loading":"file-loading-3-0",fileLoading:"file-loading-3-0","file-error":"file-error-sOb",fileError:"file-error-sOb","file-success":"file-success-1Du",fileSuccess:"file-success-1Du","file-preview":"file-preview-1bc",filePreview:"file-preview-1bc","preview-download":"preview-download-1dd",previewDownload:"preview-download-1dd","file-preview-office":"file-preview-office-26j",filePreviewOffice:"file-preview-office-26j","file-preview-image":"file-preview-image-1mf",filePreviewImage:"file-preview-image-1mf","image-not-found":"image-not-found-2fW",imageNotFound:"image-not-found-2fW","image-loading":"image-loading-2YE",imageLoading:"image-loading-2YE","image-error":"image-error-1dp",imageError:"image-error-1dp","loading-icon":"loading-icon-3hz",loadingIcon:"loading-icon-3hz","file-preview-pdf":"file-preview-pdf-R-C",filePreviewPdf:"file-preview-pdf-R-C","file-preview-markdown":"file-preview-markdown-2lL",filePreviewMarkdown:"file-preview-markdown-2lL","file-preview-text":"file-preview-text-1BL",filePreviewText:"file-preview-text-1BL","file-preview-fetch":"file-preview-fetch-2wm",filePreviewFetch:"file-preview-fetch-2wm","file-inner-navigator":"file-inner-navigator-2C0",fileInnerNavigator:"file-inner-navigator-2C0"}},1574:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=h(n(0)),u=n(2),s=h(u),c=h(n(8)),f=h(n(699)),d=h(n(547)),p=n(1542),m=h(p);function h(e){return e&&e.__esModule?e:{default:e}}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=(r=a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state=o({},t.initial),a.handleRefreshImage=a.handleRefreshImage.bind(a),a.handleLoadingDone=a.handleLoadingDone.bind(a),a.handleError=a.handleError.bind(a),a.handleSuccess=a.handleSuccess.bind(a),a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Component),i(t,[{key:"startFetch",value:function(){var e;this.state=o({},t.initial),(e=this.props).fetchPromise.apply(e,arguments).catch(this.handleError).then(this.handleSuccess).finally(this.handleLoadingDone)}},{key:"handleLoadingDone",value:function(){this.setState({loading:!1})}},{key:"handleSuccess",value:function(){this.setState({success:!0})}},{key:"handleError",value:function(){this.setState({error:!0})}},{key:"handleRefreshImage",value:function(){var e=this;this.setState({error:!1,loading:!0,success:!1},function(){var t=e.props.fileId,n=(new Date).getTime();e.startFetch(t,n)})}},{key:"componentDidMount",value:function(){var e=this.props.fileId;this.startFetch(e)}},{key:"componentWillReceiveProps",value:function(e){var t=e.fileId,n=e.version,a=this.props,r=a.fileId,o=a.version;r===t&&o===n||this.startFetch(t)}},{key:"renderStatus",value:function(){var e=this.state,t=e.loading;if(e.error)return s.default.createElement("a",{className:p.fetchError,onClick:this.handleRefreshImage},s.default.createElement(d.default,null)," \u52a0\u8f7d\u5931\u8d25\uff0c\u70b9\u51fb\u91cd\u65b0\u52a0\u8f7d");if(!t)return null;var n=this.props.fileTypeName,a=void 0===n?"":n,r=null!==a.charAt(0).trim().match(/[A-Za-z]/)?" "+a:a;return s.default.createElement("div",{className:p.fetchLoading},s.default.createElement(f.default,null)," \u6b63\u5728\u52a0\u8f7d",r,"...")}},{key:"renderFile",value:function(){var e=this.state,t=e.loading,n=e.error,a=e.success;return this.props.invisible&&!a?s.default.createElement("div",{className:p.invisibleFile},this.props.children):t||n?null:this.props.children}},{key:"render",value:function(){var e,t=this.state,n=t.loading,a=t.error,r=t.success,o=this.props,i=o.className,l=o.loadingPosition,u=(0,c.default)(i,(y(e={},p.fileLoading,n),y(e,p.fileError,a),y(e,p.fileSuccess,r),y(e,m.default[l],l),e));return s.default.createElement("div",{className:u},this.renderStatus(),this.renderFile())}}]),t}(),a.initial={loading:!0,success:!1,error:!1},r);v.propTypes={className:l.default.string.isRequired,children:l.default.any,fetchPromise:l.default.func.isRequired,fileId:l.default.number,fileTypeName:l.default.string.isRequired,invisible:l.default.bool,loadingPosition:l.default.string,version:l.default.string},v.defaultProps={invisible:!1,loadingPosition:"center"},t.default=v},1598:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1902);Object.defineProperty(t,"FilterInput",{enumerable:!0,get:function(){return o(a).default}});var r=n(1904);function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"SearchInput",{enumerable:!0,get:function(){return o(r).default}})},1636:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.fetchWikis=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l.WIKI_PAGE_SIZE,u=(0,r.buildParams)({orderBy:a,page:n,pageSize:i});return(0,o.dispatchWithProjectAPIPrefix)(function(e,t){return(0,o.autoDispatch)((0,r.get)(e+"/wikis/page?"+u),t,l.ACTION.FETCH_WIKIS)})},t.postWiki=function(e){var t=e.path,n=e.iid,i=e.parentId,u=e.title,s=e.content,c=e.msg,f=e.order;return(0,o.dispatchWithProjectAPIPrefix)(function(e,d){return(0,o.autoDispatch)((0,r.post)(e+"/wiki",{iid:n||0,parentIid:i||0,title:u,content:s,msg:c,order:f}),d,l.ACTION.POST_WIKI,function(e){return a({},e.data,{path:t})})})},t.setVersion=function(e,t,n,a){var i=(0,r.buildParams)({version:a});return(0,o.dispatchWithProjectAPIPrefix)(function(e){return(0,r.post)(e+"/wiki/"+n+"/history?"+i)})},t.delHistories=function(e,t,n,a){var i=(0,r.buildParams)({version:a});return(0,o.dispatchWithProjectAPIPrefix)(function(e){return(0,r.del)(e+"/wiki/"+n+"/history?"+i)})},t.getWiki=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=(0,r.buildParams)({version:a});return(0,o.dispatchWithProjectAPIPrefix)(function(e,t){return(0,o.autoDispatch)((0,r.get)(e+"/wiki/"+n+"?"+i),t,l.ACTION.GET_WIKI)})},t.delWiki=function(e,t){return(0,o.dispatchWithProjectAPIPrefix)(function(n,a){return(0,o.autoDispatch)((0,r.del)(n+"/wiki/"+e),a,l.ACTION.DEL_WIKI,function(){return{iid:e,path:t}})})},t.getWikiHistories=function(e,t,n){return(0,o.dispatchWithProjectAPIPrefix)(function(e,t){return(0,o.autoDispatch)((0,r.get)(e+"/wiki/"+n+"/histories"),t,l.ACTION.GET_WIKI_HISTORIES)})},t.fetchDirectory=function(){return(0,o.dispatchWithProjectAPIPrefix)(function(e,t){return(0,o.autoDispatch)((0,r.get)(e+"/wikis"),t,l.ACTION.FETCH_DIRECTORY)})},t.moveWiki=function(e,t,n){return(0,o.dispatchWithProjectAPIPrefix)(function(i,s,c){var f=i+"/wiki/reorder",d=c(),p=d.WIKI.directory,m=(0,u.getNode)(p,e),h=(0,u.getMoveType)(n),y={iid:m.iid},v={};if(""===t)v=a({},y),n.dropOnTop?v.after=p.tree[0].order:v.before=p.tree.slice(-1)[0].order;else{var E=(0,u.getNode)(p,t);if("INSERT_AFTER"===h){var b=(0,u.splitIdByPath)(t),g=b.parentPath,w=b.id,_=""===g?p.tree:(0,u.getNode)(p,g).children,P=_.findIndex(function(e){return e.iid.toString()===w}),O=_[P+1]||{};v=a({},y,{parentIid:(0,u.splitIdByPath)(g).id,before:E.order,after:O.order})}else if("AS_FIRST_CHILD"===h){var k=E.children[0];v=a({},y,{parentIid:E.iid,after:k.order})}else"AS_LAST_CHILD"===h&&(v=a({},y,{parentIid:E.iid}))}var T={fromPath:e,toPath:t,ACTION_TYPE:h};(0,o.autoDispatch)((0,r.post)(f,v),s,l.ACTION.MOVE_WIKI,function(){},function(){},function(){return{data:T}})})},t.shareWiki=function(e,t){var n={projectId:e,resourceId:t,resourceType:i.RESOURCE_TYPE.WIKI,accessType:i.ACCESS_TYPE.PUBLIC};return function(e){return(0,o.autoDispatch)((0,r.post)("/api/share/create",n),e,l.ACTION.SHARE_WIKI,function(e){return{payload:e.data,iid:t}})}},t.stopShareWiki=function(e,t){return function(n){return(0,o.autoDispatch)((0,r.del)("/api/share/"+t),n,l.ACTION.STOP_SHARE_WIKI,function(){return{iid:e}})}};var r=n(84),o=n(548),i=n(106),l=n(2233),u=n(1953)},1638:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.acquireHost=t.getHostDetail=t.getHosts=t.getOauthPlatforms=void 0;var a=n(2056);Object.defineProperty(t,"getOauthPlatforms",{enumerable:!0,get:function(){return a.getOauthPlatforms}});var r=n(3480);Object.defineProperty(t,"getHosts",{enumerable:!0,get:function(){return r.getHosts}}),Object.defineProperty(t,"getHostDetail",{enumerable:!0,get:function(){return r.getHostDetail}}),Object.defineProperty(t,"acquireHost",{enumerable:!0,get:function(){return r.acquireHost}}),t.startOneClickDeploy=function(e){var t=e.type,n=e.branch,a=e.path,r=void 0===a?"/":a,o=e.autoDeploy,l=void 0===o||o,f=e.appRuntime,d=e.hostId,p=void 0===d?"":d;return(0,s.dispatchWithProjectAPIPrefix)(function(e,a){return(0,u.default)((0,i.post)(e+"/git/ocd/create",{type:t,branch:n,path:r,auto_deploy:l,app_runtime:f,host_id:p}),a,c.ACTION.START_ONE_CLICK_DEPLOY)})},t.getDeployStatus=function(){return(0,s.dispatchWithProjectAPIPrefix)(function(e,t){return(0,u.default)((0,i.get)(e+"/git/ocd/status"),t,c.ACTION.GET_DEPLOY_STATUS)})},t.onDomainChanged=function(){return function(e){return e({type:c.ACTION.DOMAIN_CHANGED})}},t.getDeployType=function(){return(0,s.dispatchWithProjectAPIPrefix)(function(e,t){return(0,u.default)((0,i.get)(e+"/git/ocd"),t,c.ACTION.GET_DEPLOY_TYPE)})},t.getDeployTaskStatus=f,t.addDomain=function(e){return(0,s.dispatchWithProjectAPIPrefix)(function(t,n){return(0,u.default)((0,i.post)(t+"/git/ocd/add-domain",e),n,c.ACTION.ADD_DOMAIN)})},t.getDomainChallenge=function(e){return(0,s.dispatchWithProjectAPIPrefix)(function(t,n){return(0,u.default)((0,i.post)(t+"/git/ocd/get-domain-challenge",e),n,c.ACTION.GET_DOMAIN_CHALLENGE)})},t.removeDomain=function(e){return(0,s.dispatchWithProjectAPIPrefix)(function(t,n){return(0,u.default)((0,i.post)(t+"/git/ocd/remove-domain",e),n,c.ACTION.REMOVE_DOMAIN)})},t.deleteOneClickDeploy=function(){return(0,s.dispatchWithProjectAPIPrefix)(function(e,t){return(0,u.default)((0,i.post)(e+"/git/ocd/remove"),t,c.ACTION.DELETE_ONE_CLICK_DEPLOY)})},t.fetchRefs=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,s.dispatchWithProjectAPIPrefix)(function(t,n){return(0,u.default)(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,i.get)(e+"/git/list_branches").then(function(n){return(0,i.get)(e+"/git/list_tags?"+(t&&"withoutReleaseTags=true")).then(function(e){return{branches:n.data,tags:e.data}}).then(function(t){return function(e,t){var n=t.branches,a=t.tags;return(0,i.get)(e+"/git/treeinfo/master").then(function(e){if(e&&0===e.code&&e.data){var t=e.data.infos,r=t.some(function(e){return"docs"===e.name&&"tree"===e.mode});if(r){var o=n.findIndex(function(e){return"master"===e.name});if(o>-1){var i=Object.assign({},n[o]);i.value=c.PREFIX_CUSTOME_BRANCH+"_"+i.name,i.name="master \u5206\u652f / docs \u76ee\u5f55",i.path="docs",n.push(i)}}}return{branches:n,tags:a}})}(e,t)})})}(t,e).then().then(function(e){return{code:0,data:e}}),n,c.ACTION.FETCH_REFS)})},t.createTerminal=function(){return(0,s.dispatchWithProjectAPIPrefix)(function(e,t){return(0,u.default)((0,i.post)(e+"/git/ocd/create-terminal"),t,"")})},t.removeTerminal=function(){return(0,s.dispatchWithProjectAPIPrefix)(function(e,t){return(0,u.default)((0,i.post)(e+"/git/ocd/remove-terminal"),t,"")})},t.updateDeploySource=function(e){var t=e.branch,n=e.path,a=void 0===n?"":n;return(0,s.dispatchWithProjectAPIPrefix)(function(e,n){return(0,u.default)((0,i.post)(e+"/git/ocd/update-deploy-source",{branch:t,path:a}),n,"")})},t.deploy=function(){return(0,s.dispatchWithProjectAPIPrefix)(function(e,t){return(0,u.default)((0,i.post)(e+"/git/ocd/deploy"),t,"")})},t.setForceRedeploy=function(e){return(0,s.dispatchWithProjectAPIPrefix)(function(t,n){return(0,u.default)((0,i.post)(t+"/git/ocd/set-force-redeploy",{force_redeploy:e}),n,"")})},t.setAutoDeploy=function(e){return(0,s.dispatchWithProjectAPIPrefix)(function(t,n){return(0,u.default)((0,i.post)(t+"/git/ocd/set-auto-deploy",{auto_deploy:e}),n,"")})},t.setPrimaryDomain=function(e){return(0,s.dispatchWithProjectAPIPrefix)(function(t,n){return(0,u.default)((0,i.post)(t+"/git/ocd/set-primary-domain",{domain:e}),n,"")})},t.setDomainToPrimary=function(e){var t=e.toPrimary,n=e.domain;return(0,s.dispatchWithProjectAPIPrefix)(function(e,a){return(0,u.default)((0,i.post)(e+"/git/ocd/set-domain-to-primary",{to_primary:t,domain:n}),a,"")})},t.applySslCertificate=function(e){var t=e.domain;return(0,s.dispatchWithProjectAPIPrefix)(function(e,n){return(0,u.default)((0,i.post)(e+"/git/ocd/apply-ssl-certificate",{domain:t}),n,"")})},t.setForceSsl=function(e){var t=e.forceSsl;return(0,s.dispatchWithProjectAPIPrefix)(function(e,n){return(0,u.default)((0,i.post)(e+"/git/ocd/set-force-ssl",{force_ssl:t}),n,"")})},t.poolingForDeployTaskStatus=function e(){return function(t,n){f()(t,n).then(function(a){!a||"RUNNING"!==a.status&&"FETCHING"!==a.status&&"BUILDING"!==a.status||setTimeout(function(){return e()(t,n)},5e3)})}},t.cleanUpData=function(){return function(e){e({type:c.ACTION.CLEAN_UP_DATA})}};var o,i=n(84),l=n(227),u=(o=l)&&o.__esModule?o:{default:o},s=n(548),c=n(1695);function f(){return(0,s.dispatchWithProjectAPIPrefix)(function(e,t){return(0,u.default)((0,i.get)(e+"/git/ocd/deploy-status"),t,c.ACTION.GET_DEPLOY_TASK_STATUS)})}},1677:function(e,t,n){e.exports={"search-input":"search-input-2b4",searchInput:"search-input-2b4"}},1692:function(e,t,n){e.exports=n.p+"static/media/folderIcon.501e80cf.svg"},1694:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flowInit=function(e){return(0,r.dispatchWithProjectAPIPrefix)(function(t){return(0,a.post)(t+"/flow",{type:e})})},t.flowCommits=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return(0,r.dispatchWithProjectAPIPrefix)(function(n,i){return(0,r.autoDispatch)((0,a.get)(n+"/flow/commits?"+(0,a.buildParams)({page:e,pageSize:t})),i,o.ACTION.FETCH_FLOW_COMMITS)})},t.flowFlows=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return(0,r.dispatchWithProjectAPIPrefix)(function(n,i){return(0,r.autoDispatch)((0,a.get)(n+"/flow/flows?"+(0,a.buildParams)({page:e,pageSize:t})),i,o.ACTION.FETCH_FLOW_FLOWS)})},t.pubRelease=function(e){return(0,r.dispatchWithProjectAPIPrefix)(function(t,n){return(0,r.autoDispatch)((0,a.post)(t+"/flow/release",e),n,o.ACTION.PUB_RELEASE)})},t.phaseChangeStatus=function(e,t,n,i){return(0,r.dispatchWithProjectAPIPrefix)(function(l,u){return(0,r.autoDispatch)((0,a.post)(l+"/flow/phase/"+t+"/status?status="+n),u,o.ACTION.PHASE_CHANGE_STATUS,function(t){return{type:i,id:e,data:t.data}})})},t.phaseAddMark=function(e,t,n){return(0,r.dispatchWithProjectAPIPrefix)(function(i,l){return(0,r.autoDispatch)((0,a.post)(i+"/flow/marks/add",t),l,o.ACTION.PHASE_ADD_MARK,function(t){return{type:n,id:e,data:t.data}})})},t.phaseAutoSkip=function(e,t){return(0,r.dispatchWithProjectAPIPrefix)(function(n,i){return(0,r.autoDispatch)((0,a.post)(n+"/flow/auto-skip?phaseName="+e),i,o.ACTION.PHASE_AUTO_SKIP,function(){return{type:t,phaseName:e}})})},t.phaseAutoSkipCancel=function(e,t){return(0,r.dispatchWithProjectAPIPrefix)(function(n,i){return(0,r.autoDispatch)((0,a.post)(n+"/flow/auto-skip/cancel?phaseName="+e),i,o.ACTION.PHASE_AUTO_SKIP_CANCEL,function(){return{type:t,phaseName:e}})})},t.addFlow=function(e,t){return(0,r.dispatchWithProjectAPIPrefix)(function(n,i){return(0,r.autoDispatch)((0,a.post)(n+"/flow/create",{branchName:"coding-flow/"+e,title:t}),i,o.ACTION.ADD_FLOW)})},t.addFeatureFlow=function(e,t,n){return(0,r.dispatchWithProjectAPIPrefix)(function(i,l){return(0,r.autoDispatch)((0,a.post)(i+"/flow/"+e+"/feature/create",{branchName:t,title:n}),l,o.ACTION.ADD_FEATURE_FLOW)})},t.listFeatureFlow=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,l={type:t,page:n,pageSize:i};return(0,r.dispatchWithProjectAPIPrefix)(function(t,n){return(0,r.autoDispatch)((0,a.get)(t+"/flow/"+e+"/feature/list?"+(0,a.buildParams)(l)),n,o.ACTION.LIST_FEATURE_FLOW)})},t.fetchFlowDetail=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,r.dispatchWithProjectAPIPrefix)(function(n,i){return(0,r.autoDispatch)((0,a.get)(n+"/flow/"+e+"?"+(0,a.buildParams)({tag_name:t})),i,o.ACTION.FETCH_FLOW_DETAIL)})},t.fetchFeatureFlowDetail=function(e,t){return(0,r.dispatchWithProjectAPIPrefix)(function(n,i){return(0,r.autoDispatch)((0,a.get)(n+"/flow/"+e+"/feature/"+t),i,o.ACTION.FETCH_FEATURE_FLOW_DETAIL)})},t.featureFlowApplyReview=function(e,t,n,i){return(0,r.dispatchWithProjectAPIPrefix)(function(l,u){return(0,r.autoDispatch)((0,a.post)(l+"/flow/"+e+"/feature/"+t+"/review",{body:n,reviewers:i}),u,o.ACTION.FEATURE_FLOW_APPLY_REVIEW)})};var a=n(84),r=n(548),o=n(1543)},1695:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PREFIX_CUSTOME_BRANCH=t.CERTIFICATION_APPLYING_STATUS_COLORS=t.CERTIFICATION_APPLYING_STATUS=t.PERM_ADMIN=t.PERM_CODE=t.PERM_ALL=t.OCD_ACTIVATED_ENVIRONMENT=t.ACTION=void 0;var a=n(106);t.ACTION={GET_DEPLOY_TYPE:"ONE_CLICK_DEPLOY.GET.DEPLOY.TYPE",GET_DEPLOY_STATUS:"ONE_CLICK_DEPLOY.GET.DEPLOY.STATUS",GET_DEPLOY_TASK_STATUS:"ONE_CLICK_DEPLOY.GET.DEPLOY.TASK.STATUS",START_ONE_CLICK_DEPLOY:"ONE_CLICK_DEPLOY.START.ONE.CLICK.DEPLOY",DELETE_ONE_CLICK_DEPLOY:"ONE_CLICK_DEPLOY.DELETE.ONE.CLICK.DEPLOY",CLEAN_UP_DATA:"ONE_CLICK_DEPLOY.CLEAN_UP_DATA",FETCH_REFS:"ONE_CLICK_DEPLOY.FETCH.REFS",ADD_DOMAIN:"ONE_CLICK_DEPLOY.ADD_DOMAIN",REMOVE_DOMAIN:"ONE_CLICK_DEPLOY.REMOVE_DOMAIN",GET_DOMAIN_CHALLENGE:"ONE_CLICK_DEPLOY.GET_DOMAIN_CHALLENGE",DOMAIN_CHANGED:"ONE_CLICK_DEPLOY.DOMAIN_CHANGED"},t.OCD_ACTIVATED_ENVIRONMENT=[{name:"PHP + MySQL",value:"php",description:"\u72ec\u7acb\u7684 PHP \u8fd0\u884c\u4e3b\u673a\uff0c\u914d\u5907\u72ec\u7acb\u7684 MySQL \u6570\u636e\u5e93\u3002",spaces:["qcloud"]},{name:"\u9759\u6001 Pages",value:"static",description:"\u9759\u6001 Pages \u5e94\u7528\u652f\u6301\u5c06\u9759\u6001\u9875\u9762\u53d1\u5e03\u5230\u7f51\u7edc\uff0c\u9002\u7528\u4e8e\u5c55\u793a\u7531 HTML\u3001CSS\u3001JavaScript \u7b49\u6587\u4ef6\u6784\u6210\u7684\u4e2a\u4eba\u7f51\u7ad9\u3001\u516c\u53f8\u7f51\u7ad9\u3001\u7b80\u5386\u3001\u4f5c\u54c1\u96c6\u3001\u7167\u7247\u96c6\u7b49\u9759\u6001\u7f51\u9875\u3002",spaces:["shared"],exp:{"coding-ocd-pages":!0}},{name:"Java + MySQL",value:"java",description:"\u72ec\u7acb\u7684 Java \u8fd0\u884c\u4e3b\u673a\uff0c\u914d\u5907\u72ec\u7acb\u7684 MySQL \u6570\u636e\u5e93\u3002",spaces:["qcloud"],exp:{"coding-ocd-java":!0}},{name:"Python + MySQL",value:"python",description:"\u72ec\u7acb\u7684 Python \u8fd0\u884c\u4e3b\u673a\uff0c\u914d\u5907\u72ec\u7acb\u7684 MySQL \u6570\u636e\u5e93\u3002",spaces:["qcloud"],exp:{"coding-ocd-java":!0}}],t.PERM_ALL=[a.ROLE_AUTH.ADMIN,a.ROLE_AUTH.OWNER,a.ROLE_AUTH.MEMBER,a.ROLE_AUTH.MEMBER_NO_CODE],t.PERM_CODE=[a.ROLE_AUTH.ADMIN,a.ROLE_AUTH.OWNER,a.ROLE_AUTH.MEMBER],t.PERM_ADMIN=[a.ROLE_AUTH.ADMIN,a.ROLE_AUTH.OWNER],t.CERTIFICATION_APPLYING_STATUS={NORMAL:"\u6b63\u5e38",ERROR:"\u9519\u8bef",REQUESTING:"\u7533\u8bf7\u4e2d"},t.CERTIFICATION_APPLYING_STATUS_COLORS={NORMAL:"#27BA66",ERROR:"#F46365",REQUESTING:"#76808E"},t.PREFIX_CUSTOME_BRANCH="f59qS0vdf03EYJtx"},1696:function(e,t,n){e.exports={header:"header-3W4",title:"title-Okj",tips:"tips-2zM",success:"success-3HN",container:"container-1Do"}},1785:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=f(n(0)),o=n(2),i=f(o),l=f(n(8)),u=f(n(700)),s=f(n(1454)),c=n(1786);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,a=e.title,r=e.placement,o=(0,l.default)(c.tooltip,n),f=i.default.createElement(u.default,{className:o},a);return i.default.createElement(s.default,{placement:r,overlay:f},t)}}]),t}();d.propTypes={className:r.default.string,children:r.default.any,placement:r.default.string,title:r.default.any},d.defaultProps={placement:"top"},t.default=d},1786:function(e,t,n){e.exports={toolbar:"toolbar-1sb",item:"item-2Rh",rest:"rest-1ez","rest-item":"rest-item-2a4",restItem:"rest-item-2a4",tooltip:"tooltip-3c1","file-breadcrumb":"file-breadcrumb-2se",fileBreadcrumb:"file-breadcrumb-2se","file-suffix-name":"file-suffix-name-139",fileSuffixName:"file-suffix-name-139"}},1789:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizedActivityTypes=t.userPropTypes=t.activityPropTypes=t.filePropTypes=t.types=void 0;var a,r=n(0),o=(a=r)&&a.__esModule?a:{default:a},i=n(1541);var l=new i.schema.Entity("files",{},{idAttribute:"path"}),u=new i.schema.Entity("projects",{},{idAttribute:"path"}),s=new i.schema.Entity("users",{},{idAttribute:"name"}),c=new i.schema.Entity("projectFiles",{owner:s}),f=new i.schema.Entity("projectFileComments",{owner:s}),d=new i.schema.Entity("ProjectFiles",{file:l,project:u,user:s}),p=new i.schema.Entity("ProjectFileComments",{project:u,user:s,projectFile:c,projectFileComment:f}),m=new i.schema.Array({ProjectFiles:d,ProjectFileComments:p},function(e){return e.targetType+"s"}),h=(t.types={activities:m},t.filePropTypes=o.default.shape({name:o.default.string,path:o.default.string})),y=t.activityPropTypes=o.default.shape({file:o.default.string,targetType:o.default.string,project:o.default.string,action:o.default.string,createdAtText:o.default.string,createdAt:o.default.string,id:o.default.number,type:o.default.string,historyId:o.default.string,user:o.default.string,version:o.default.string,actionMsg:o.default.string});t.userPropTypes=o.default.shape({path:o.default.string,name:o.default.string,avatar:o.default.string}),t.normalizedActivityTypes=o.default.shape({result:o.default.arrayOf(o.default.shape({id:o.default.number,schema:o.default.oneOf(["ProjectFiles","ProjectFileComments"])})),entities:o.default.shape({files:o.default.objectOf(h),ProjectFiles:o.default.objectOf(y)})})},1795:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=E(i),u=E(n(0)),s=E(n(1550)),c=E(n(8)),f=E(n(78)),d=E(n(262)),p=E(n(544)),m=n(168),h=E(n(3434)),y=E(n(263)),v=E(n(3438));function E(e){return e&&e.__esModule?e:{default:e}}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=(r=a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.commitCard=e.commitCard.bind(e),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"commitCard",value:function(){var e=this.props,t=e.commit,n=e.projectPath;return l.default.createElement("div",{className:v.default.commitCard},l.default.createElement("div",{className:(0,c.default)(v.default.author,"clearfix")},l.default.createElement(m.Link,{to:t.committer.link},l.default.createElement(d.default,{src:t.committer.avatar,size:"tiny"}),t.committer.name),l.default.createElement("span",{className:v.default.vline},"|"),l.default.createElement("span",{className:v.default.time},(0,y.default)(new Date(t.commitTime)).format("YYYY-MM-DD HH:mm"))),l.default.createElement("div",{className:(0,c.default)(v.default.msg,"clearfix")},l.default.createElement("span",{className:v.default.sha},l.default.createElement(s.default,null),t.commitId.substring(0,7)),l.default.createElement(m.Link,{to:n+"/git/commit/"+t.commitId,className:v.default.short},t.shortMessage)),this.props.newRelease&&l.default.createElement(p.default,{empty:!0,className:v.default.new,onClick:this.props.newRelease},"\u53d1\u5e03\u6b64\u7248\u672c"))}},{key:"renderPoint",value:function(e){var t=this,n=this.props.isShowRing,a=function(e){return[l.default.createElement("div",{className:(0,c.default)(v.default.background,e?v.default.green:v.default.black),key:0},l.default.createElement(s.default,{className:v.default.icon})),t.props.left?l.default.createElement("div",{className:v.default.left,key:1}):null]},r=this.props.commit;if(!e.includes(v.default.empty)||n&&n.condition&&n.data&&n.data.length>0){var o=n&&n.data||r.release&&r.release.phases||[];return l.default.createElement("div",{className:v.default.commitPoint},l.default.createElement(h.default,{phases:o},a(o.every(function(e){return"success"===e.status}))))}return l.default.createElement("div",{className:e},a())}},{key:"renderEmptyCommit",value:function(e){return l.default.createElement("div",{className:e},l.default.createElement("div",{className:v.default.background},l.default.createElement("i",{className:v.default.icon})),this.props.left&&l.default.createElement("div",{className:v.default.left}))}},{key:"render",value:function(){var e=(0,c.default)(v.default.commitPoint,b({},v.default.empty,this.props.empty)),t=(0,c.default)(v.default.dropDown,this.props.className,b({},v.default.down,"down"===this.props.placement));return this.props.showCommitCard&&!this.props.emptyCommit?l.default.createElement(f.default,{menu:this.commitCard(),hoverTrigger:!0,className:t},this.renderPoint(e)):this.props.emptyCommit?this.renderEmptyCommit((0,c.default)(v.default.emptyCommit,this.props.className)):this.renderPoint((0,c.default)(e,this.props.className))}}]),t}(),a.propTypes={className:u.default.string,empty:u.default.bool,left:u.default.bool,showCommitCard:u.default.bool,projectPath:u.default.string,newRelease:u.default.func,commit:u.default.object,placement:u.default.string,emptyCommit:u.default.bool,isShowRing:u.default.object},a.defaultProps={className:"",empty:!1,left:!1,showCommitCard:!1,projectPath:"",newRelease:void 0,commit:{},placement:"right",emptyCommit:!1},r);t.default=g},1797:function(e,t,n){e.exports={"sidebar-container":"sidebar-container-2v0",sidebarContainer:"sidebar-container-2v0",section:"section-6vQ",title:"title-2yA",empty:"empty-38n",author:"author-2-m","drop-down-title":"drop-down-title-2NY",dropDownTitle:"drop-down-title-2NY",icon:"icon-2ay",items:"items-2LH",name:"name-2Nh","remove-icon":"remove-icon-1Lk",removeIcon:"remove-icon-1Lk",label:"label-30B","label-name":"label-name-3tC",labelName:"label-name-3tC",deadline:"deadline-2Gh"}},1902:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=E(n(0)),u=n(2),s=E(u),c=E(n(8)),f=E(n(1545)),d=E(n(1490)),p=E(n(554)),m=E(n(261)),h=E(n(547)),y=E(n(1538)),v=n(1677);function E(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var g=(r=a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=b(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={value:a.props.value},a.debounceChange=(0,p.default)(function(e){a.props.onChange(e)},a.props.timeout),a.clearChange=function(){a.setState({value:""}),a.props.onChange("")},a.handleChange=function(e,t){var n=t.trim();a.setState({value:n}),a.debounceChange(n)},b(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Component),i(t,[{key:"renderIcon",value:function(e){return 0===(0,f.default)(e)?s.default.createElement(y.default,null):s.default.createElement(h.default,{onClick:this.clearChange})}},{key:"render",value:function(){var e=this.state.value,t=(0,d.default)(this.props,"timeout");return s.default.createElement(m.default,o({},t,{className:(0,c.default)(v.searchInput,this.props.className),value:e,icon:this.renderIcon(e),onChange:this.handleChange}))}}]),t}(),a.propTypes={value:l.default.string,placeholder:l.default.string,className:l.default.any,onChange:l.default.func.isRequired,timeout:l.default.number},a.defaultProps={value:"",placeholder:"\u7b5b\u9009...",timeout:300},r);t.default=g},1904:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=y(n(0)),u=n(2),s=y(u),c=y(n(8)),f=y(n(1545)),d=y(n(1490)),p=y(n(261)),m=y(n(1474)),h=n(1677);function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var E=(r=a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={value:a.props.value},a.handleSearch=function(){a.props.onSearch(a.state.value)},a.handleChange=function(e,t){var n=t.trim();a.props.onChange(n),a.setState({value:n},function(){0===(0,f.default)(n)&&a.handleSearch()})},v(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Component),i(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.value;t!==this.state.value&&this.setState({value:t})}},{key:"render",value:function(){var e=this,t=(0,d.default)(this.props,"onSearch","className");return s.default.createElement(p.default,o({},t,{className:(0,c.default)(h.searchInput,this.props.className),value:this.state.value,onChange:this.handleChange,icon:s.default.createElement(m.default,{onClick:this.handleSearch}),onPressEnter:this.handleSearch,ref:function(t){t&&(e.input=t.input)}}))}}]),t}(),a.propTypes={value:l.default.string,placeholder:l.default.string,className:l.default.any,onChange:l.default.func,onSearch:l.default.func.isRequired},a.defaultProps={value:"",placeholder:"\u641c\u7d22...",onChange:function(){}},r);t.default=E},1937:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(546),r=n(51),o=n(1449),i={"/processing":1,"/done":2},l=/(.+\/tasks).*(\/\w+$)/,u=function(e,t){var n=e.location.pathname.match(l);if(n){var a=n[1],r=n[2],o=r&&i[r];t(o?{pathname:a,query:{status:o}}:a)}};t.default={path:"tasks",documentTitle:(0,o.projectPage)(function(){return"\u4efb\u52a1\u5217\u8868"}),getComponent:function(e,t){Promise.all([n.e(30),n.e(140)]).then(function(){(0,a.injectAsyncReducer)("TASK",n(1969).default),(0,r.injectAsyncI18n)("TASK",n(1970)),t(null,n(3587).default)}.bind(null,n)).catch(n.oe)},childRoutes:[{path:"user/:global_key/all",onEnter:u},{path:"user/:global_key/processing",onEnter:u},{path:"user/:global_key/done",onEnter:u},{path:"user/:global_key/watch",onEnter:u},{path:"user/:global_key/create",onEnter:u},{path:"user/:global_key",onEnter:u},{path:"all",onEnter:u},{path:"processing",onEnter:u},{path:"done",onEnter:u},{path:"watch",onEnter:u},{path:"create",onEnter:u}]}},1938:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(546),r=n(51),o=n(1449);t.default={path:"tasks/board",documentTitle:(0,o.projectPage)(function(){return"\u4efb\u52a1\u770b\u677f"}),getComponent:function(e,t){Promise.all([n.e(184),n.e(141)]).then(function(){(0,a.injectAsyncReducer)("TASK_BOARD",n(3597).default),(0,r.injectAsyncI18n)("TASK_BOARD",n(3598)),t(null,n(3599).default)}.bind(null,n)).catch(n.oe)},getChildRoutes:function(e,t){t(null,[{}])}}},1939:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(546),r=n(51),o=n(1449);t.default={path:"task/:id",documentTitle:(0,o.projectPage)(function(e){var t=e.TASK_DETAIL.detail.content;return t?t+" - \u4efb\u52a1\u8be6\u60c5":"\u4efb\u52a1\u8be6\u60c5"}),getComponent:function(e,t){Promise.all([n.e(186),n.e(72),n.e(142)]).then(function(){(0,a.injectAsyncReducer)("TASK_DETAIL",n(1699).default),(0,r.injectAsyncI18n)("TASK_DETAIL",n(1802)),(0,a.injectAsyncReducer)("REFERENCE_SELECTOR",n(1608).default),(0,r.injectAsyncI18n)("REFERENCE_SELECTOR",n(1609)),t(null,n(3629).default)}.bind(null,n)).catch(n.oe)}}},1940:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1449),r=n(546),o=n(51);t.default={path:"milestone",documentTitle:(0,a.projectPage)(function(){return"\u91cc\u7a0b\u7891"}),getComponent:function(e,t){Promise.all([n.e(71),n.e(143)]).then(function(){(0,r.injectAsyncReducer)("MILESTONE",n(3688).default),(0,o.injectAsyncI18n)("MILESTONE",n(3689)),t(null,n(3690).default)}.bind(null,n)).catch(n.oe)}}},1941:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(546),r=n(51),o=n(1449);t.default={path:"milestone/:id",documentTitle:(0,o.projectPage)(function(e){return(e.MILESTONE_DETAIL.name||"")+" - \u91cc\u7a0b\u7891"}),getComponent:function(e,t){Promise.all([n.e(30),n.e(71),n.e(144)]).then(function(){(0,a.injectAsyncReducer)("MILESTONE_DETAIL",n(3744).default),(0,a.injectAsyncReducer)("TASK",n(1969).default),(0,r.injectAsyncI18n)("MILESTONE_DETAIL",n(3745)),(0,r.injectAsyncI18n)("TASK",n(1970)),t(null,n(3746).default)}.bind(null,n)).catch(n.oe)}}},1942:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(3269)),r=u(n(3344)),o=u(n(76)),i=n(1479),l=n(1449);function u(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!isNaN(t)&&e.length>0){var n=e.filter(function(e){return e.fileId===parseInt(t,10)});if(1===n.length)return n[0].name}return null}t.default={path:"attachment",indexRoute:{component:a.default},documentTitle:(0,l.projectPage)(function(){return"\u6587\u4ef6"}),childRoutes:[{path:":folderId/create/:fileType",component:r.default,documentTitle:(0,l.projectPage)(function(e,t){var n=e.PROJECT.file.folderPaths,a=t.params,r=a.folderId,o=a.fileType,l=i.AVAILABLE_FILE_TYPES_TO_CREATE[o],u=s(n,r);return u?"\u521b\u5efa "+l+" \u6587\u4ef6 - "+u:"\u521b\u5efa "+l+" \u6587\u4ef6"})},{path:":folderId",component:a.default,documentTitle:(0,l.projectPage)(function(e,t){var n=e.PROJECT.file.folderPaths,a=t.params.folderId;if("share"===a)return"\u5171\u4eab\u6587\u4ef6\u5939";var r=s(n,a);return r?r+" - \u6587\u4ef6\u5939":"\u6587\u4ef6\u5939"})},{path:":folderId/preview/:previewFileId",component:a.default,documentTitle:(0,l.projectPage)(function(e){var t=e.PROJECT.file.preview.current;return(0,o.default)(t)?"\u6587\u4ef6\u9884\u89c8":t.name+" - \u6587\u4ef6\u9884\u89c8"})}]}},1944:function(e,t,n){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.tryReadFilesFromFolder=function(e){var t=e.dataTransfer.items;return Promise.all(Array.map(t,function(e){var t=e.webkitGetAsEntry();return t?function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t.isFile)return new Promise(function(e){t.file(function(t){t.path=n,e(t)})});if(t.isDirectory){var r=t.createReader();return new Promise(function(o,i){var l=[];r.readEntries(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],u=[];Array.forEach(r,function(r){var o=r.isFile,s=r.isDirectory,c=e(r,""+n+t.name+"/");u.push(c),c.then(function(e){o?l.push(e):s&&(l=[r].concat(a(e),a(l)))}).catch(i)}),Promise.all(u).finally(function(){o(l)})})})}return Promise.reject()}(t):Promise.reject()}))},t.isMarkdownFile=function(e){return r.test(e)},t.isOfficeFile=function(e){return o.test(e)},t.isPdfFile=function(e){return"pdf"===e},t.isCsvFile=function(e){return"csv"===e},t.isSupportedVideoFile=function(e){var t=(n=!!window.opr&&!!opr||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,a="undefined"!==typeof InstallTrigger,r=navigator.userAgent.indexOf("Safari")>-1,o=!!document.documentMode,i=!o&&!!window.StyleMedia,l=!!window.chrome&&!!window.chrome.webstore,u=(l||n)&&!!window.CSS,{opera:n,firefox:a,safari:r,ie:o,edge:i,chrome:l,blink:u});var n,a,r,o,i,l,u;if(t.chrome||t.firefox)return-1!==["mp4","ogv","webm"].indexOf(e);if(t.safari)return"mp4"===e;return!1};var r=/\.?(markdown|md)$/i,o=t.OFFICE_FILE_REG=/\.?(doc|docx|dot|docm|dotm|dotx|ppt|pptx|ppsx|pps|pptm|potm|ppam|potx|ppsm|xls|xlsx|xlsb|xlsm)$/;t.TYPE={FOLDER:0,TEXT:1,IMAGE:2,BINARY:3}},1945:function(e,t,n){"use strict";(function(e){e.PDFJS.workerSrc=n(2202)}).call(this,n(71))},1947:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=y(n(0)),l=n(2),u=y(l),s=n(51),c=y(n(549)),f=y(n(701)),d=y(n(261)),p=y(n(1619)),m=n(106),h=y(n(3317));function y(e){return e&&e.__esModule?e:{default:e}}var v=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onToggle=function(){return a.props.sharing?a.props.onStopShare():a.props.onShare()},(0,s.injectAsyncI18n)("SHARE_MODAL",n(3319)),a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"renderTitle",value:function(e){switch(e){case m.RESOURCE_TYPE.FILE:return u.default.createElement(s.I18n,{region:"SHARE_MODAL",i18n:"share.file"});case m.RESOURCE_TYPE.WIKI:return u.default.createElement(s.I18n,{region:"SHARE_MODAL",i18n:"share.wiki"});default:return null}}},{key:"render",value:function(){return u.default.createElement(c.default,{show:this.props.show,className:h.default.container,onHide:this.props.onHide,onEscapeKeyUp:this.props.onHide},u.default.createElement("div",null,this.renderTitle(this.props.type),u.default.createElement("span",{className:h.default.name},this.props.targetName)),u.default.createElement("div",{className:h.default.action},u.default.createElement(s.I18n,{region:"SHARE_MODAL",i18n:"current.status"}),this.props.sharing?u.default.createElement(s.I18n,{region:"SHARE_MODAL",i18n:"sharing"}):u.default.createElement(s.I18n,{region:"SHARE_MODAL",i18n:"not.sharing"}),u.default.createElement(f.default,{toggle:!0,className:h.default.checkbox,checked:this.props.sharing,onChange:this.onToggle})),u.default.createElement("div",{className:h.default.link},this.props.sharing?u.default.createElement("div",null,u.default.createElement(s.I18n,{region:"SHARE_MODAL",i18n:"sharing.link.tip"}),u.default.createElement("div",{className:h.default.clipboard},u.default.createElement(d.default,{readOnly:!0,value:this.props.url,className:h.default.input,size:"small"}),u.default.createElement(p.default,{text:this.props.url,className:"ml-10"}))):u.default.createElement(s.I18n,{region:"SHARE_MODAL",i18n:"sharing.tip"})))}}]),t}(),a.propTypes={show:i.default.bool,onHide:i.default.func,type:i.default.number,targetName:i.default.string,sharing:i.default.bool,url:i.default.string,onShare:i.default.func,onStopShare:i.default.func},r);t.default=v},1948:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=n(1449);t.default={path:"setting",documentTitle:(0,r.projectPage)(function(){return"\u9879\u76ee\u8bbe\u7f6e"}),indexRoute:a({},n(3347).default),getChildRoutes:function(e,t){n.e(145).then(function(e){t(null,[n(3772).default,n(3779).default,n(3785).default,n(3786).default,n(3787).default,n(3791).default,n(3792).default,n(3796).default])}.bind(null,n)).catch(n.oe)}}},1949:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(546),r=n(51),o=n(1449);t.default={path:"wiki",documentTitle:(0,o.projectPage)(function(){return"Wiki"}),getComponent:function(e,t){n.e(147).then(function(){(0,a.injectAsyncReducer)("WIKI",n(3811).default),(0,r.injectAsyncI18n)("WIKI",n(3812)),t(null,n(3813).default)}.bind(null,n)).catch(n.oe)},indexRoute:{component:n(2216).default},childRoutes:[{path:"new",component:n(3405).default,documentTitle:{prefix:"\u65b0\u5efa Wiki"}},{path:"pages",component:n(3408).default,documentTitle:(0,o.projectPage)(function(){return"\u9875\u9762\u5217\u8868"})},{path:":iid",component:n(2216).default,documentTitle:(0,o.projectPage)(function(e){return(e.WIKI.wiki.title||"Coding Enterprise")+" - Wiki"})},{path:"page/:iid",component:n(3413).default,documentTitle:(0,o.projectPage)(function(e){return e.WIKI.wiki.title+" - Wiki"})},{path:"page/:iid/histories",component:n(3414).default,documentTitle:(0,o.projectPage)(function(e){return e.WIKI.wiki.title+" - Wiki \u5386\u53f2\u7248\u672c"})},{path:"page/:iid/edit",component:n(3417).default,documentTitle:(0,o.projectPage)(function(e){return e.WIKI.wiki.title+" - \u7f16\u8f91 Wiki"})}]}},1953:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMoveType=function(e){var t=e.dropOnTop,n=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(e,["dropOnTop"]);if((0,o.default)(n))return t?"INSERT_AT_ROOT_TOP":"INSERT_AT_ROOT_BOTTOM";var a=n.isInsert,r=n.isDirectory,i=n.collapsed;if(a)return!r||i?"INSERT_AFTER":"AS_FIRST_CHILD";return"AS_LAST_CHILD"},t.getNode=function(e,t){var n=e.tree,a=void 0;return t.split("/").slice(1).forEach(function(e){a=n.find(function(t){return t.iid.toString()===e}),n=a.children}),a},t.splitIdByPath=function(e){var t=e.lastIndexOf("/");if(-1===t)return{};var n=e.slice(0,t),a=e.slice(t+1);return{parentPath:n,id:a}};var a,r=n(76),o=(a=r)&&a.__esModule?a:{default:a}},1954:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(546),r=n(1449),o=n(106),i=u(n(1504)),l=u(n(3419));function u(e){return e&&e.__esModule?e:{default:e}}var s={path:"git",documentTitle:(0,r.projectPage)(function(){return"\u4ee3\u7801\u6d4f\u89c8"}),getComponent:function(e,t){n.e(148).then(function(){(0,a.injectAsyncReducer)("DEPOT",n(1704).default),t(null,i.default.projectPermRequired(o.PERM_CODE,function(e){return e.shared})((0,l.default)(n(3814).default)))}.bind(null,n)).catch(n.oe)},indexRoute:{getComponent:function(e,t){Promise.all([n.e(20),n.e(68),n.e(149)]).then(function(){(0,a.injectAsyncReducer)("TREE",n(2283).default),t(null,n(2285).default)}.bind(null,n)).catch(n.oe)}},getChildRoutes:function(e,t){Promise.all([n.e(185),n.e(72),n.e(150)]).then(function(e){t(null,[n(3831).default,n(3832).default,n(3833).default,n(3834).default,n(3835).default,n(3836).default,n(3837).default,n(3838).default,n(3839).default,n(3876).default,n(3877).default,n(3878).default,n(3882).default,n(3883).default,n(3890).default,n(3891).default,n(3892).default])}.bind(null,n)).catch(n.oe)}};t.default=s},1955:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(546),r={path:"svn",documentTitle:(0,n(1449).projectPage)(function(){return"\u4ee3\u7801\u6d4f\u89c8"}),getComponent:function(e,t){n.e(151).then(function(){t(null,n(3893).default)}.bind(null,n)).catch(n.oe)},indexRoute:{getComponent:function(e,t){n.e(66).then(function(){(0,a.injectAsyncReducer)("SVN_TREE",n(2297).default),t(null,n(2299).default)}.bind(null,n)).catch(n.oe)}},childRoutes:[n(3420).default,n(3421).default]};t.default=r},1956:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(546),r={path:"flow",documentTitle:(0,n(1449).projectPage)(function(){return"\u6d41\u6c34\u7ebf"}),getComponent:function(e,t){n.e(153).then(function(){(0,a.injectAsyncReducer)("FLOW",n(3914).default),t(null,n(2236).default)}.bind(null,n)).catch(n.oe)},indexRoute:{component:n(2236)},childRoutes:[{path:":iid",component:n(3457).default},{path:":iid/feature/:feature_iid",component:n(3468).default}]};t.default=r},1957:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=E(i),u=E(n(0)),s=E(n(78)),c=E(n(3429)),f=E(n(544)),d=E(n(1733)),p=E(n(8)),m=E(n(263)),h=E(n(1550)),y=n(1543),v=E(n(2241));function E(e){return e&&e.__esModule?e:{default:e}}var b=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={open:!1,touchMe:!0},n.renderMenu=n.renderMenu.bind(n),n.onToggle=n.onToggle.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"onToggle",value:function(e){this.setState({open:!e},function(){})}},{key:"renderMenu",value:function(){var e,t=this;return this.props.pushTips&&this.props.pushTips.length>0?l.default.createElement("div",{className:v.default.pushTips},l.default.createElement("div",{className:v.default.tip1},"\u8bf7\u6309\u5982\u4e0b\u64cd\u4f5c\u4e3a\u6b64\u529f\u80fd\u7ebf\u6dfb\u52a0\u4ee3\u7801\u63d0\u4ea4"),l.default.createElement("div",{className:v.default.tip2},"\u5728\u672c\u5730 git \u5ba2\u6237\u7aef\u4e2d\u5207\u6362\u5230 Git \u5206\u652f\uff0c\u63d0\u4ea4 \u65b0\u7684\u4ee3\u7801\u3002"),l.default.createElement("div",{className:v.default.tip3},l.default.createElement("pre",null,l.default.createElement("code",null,"git fetch\ngit checkout "+this.props.pushTips+'\nWrite your codes.\ngit commit -m "commit message"\ngit push origin '+this.props.pushTips)))):this.props.canApplyReview?l.default.createElement("div",{className:v.default.dropDown,onClick:function(e){return e.stopPropagation()}},l.default.createElement("div",{className:v.default.show},l.default.createElement("div",{className:v.default.title},"\u5982\u60a8\u5df2\u7ecf\u5f00\u53d1\u597d\u4ee3\u7801\uff0c\u8bf7\u63d0\u4ea4\u8bc4\u5ba1\u7533\u8bf7\u3002"),l.default.createElement("div",{className:(0,p.default)(v.default.tips,v.default.pr)},l.default.createElement(d.default,{className:v.default.prIcon}),l.default.createElement("span",{className:v.default.prTips},"\u63d0\u4ea4\u8bc4\u5ba1\u7533\u8bf7\u540e\u6211\u4eec\u4f1a\u81ea\u52a8\u521b\u5efa\u5408\u5e76\u8bf7\u6c42\u3002"))),l.default.createElement("div",{className:v.default.actions},l.default.createElement(f.default,{onClick:this.props.applyReview,className:v.default.applyReview},"\u63d0\u4ea4\u8bc4\u5ba1\u7533\u8bf7"))):this.props.canPubRelease?l.default.createElement("div",{className:v.default.dropDown,onClick:function(e){return e.stopPropagation()}},l.default.createElement("div",{className:v.default.show},l.default.createElement("div",{className:v.default.title},"\u5982\u60a8\u5df2\u7ecf\u5f00\u53d1\u597d\u4ee3\u7801\uff0c\u8bf7\u63d0\u4ea4\u53d1\u5e03\u3002")),l.default.createElement("div",{className:v.default.actions},l.default.createElement(f.default,{onClick:this.props.pubRelease,className:v.default.applyReview},"\u63d0\u4ea4\u53d1\u5e03\u6b64\u7248\u672c"))):this.props.canApplyMerge?l.default.createElement("div",{className:v.default.dropDown,onClick:function(e){return e.stopPropagation()}},l.default.createElement("div",{className:v.default.show},l.default.createElement("div",{className:v.default.title},"\u5982\u60a8\u5df2\u7ecf\u5f00\u53d1\u597d\u4ee3\u7801\uff0c\u8bf7\u63d0\u4ea4\u8bc4\u5ba1\u7533\u8bf7\u3002"),l.default.createElement("div",{className:(0,p.default)(v.default.tips,v.default.pr)},l.default.createElement(d.default,{className:v.default.prIcon}),l.default.createElement("span",{className:v.default.prTips},"\u63d0\u4ea4\u8bc4\u5ba1\u7533\u8bf7\u540e\u6211\u4eec\u4f1a\u81ea\u52a8\u521b\u5efa\u5408\u5e76\u8bf7\u6c42\u3002"))),l.default.createElement("div",{className:v.default.actions},l.default.createElement(f.default,{onClick:this.props.applyReview,className:v.default.applyReview},"\u63d0\u4ea4\u8bc4\u5ba1\u7533\u8bf7"))):["pending","failed"].some(function(e){return t.props.previousPhaseStatus.includes(e)})?l.default.createElement("div",{className:v.default.disabledDropdown,onClick:function(e){return e.stopPropagation()}},l.default.createElement("div",{className:v.default.disabledTips},"\u9700\u8981\u5148\u901a\u8fc7\u4e0a\u4e00\u9636\u6bb5")):l.default.createElement("div",{className:v.default.dropDown,onClick:function(e){return e.stopPropagation()}},l.default.createElement("div",{className:v.default.show},"pending"!==this.props.phase.status&&l.default.createElement("div",{className:v.default.createdAt},(e=this.props.phase.updated_at,(0,m.default)(new Date(e)).format("YYYY-MM-DD HH:mm:ss"))),l.default.createElement("div",{className:"status-desc-"+this.props.phase.status},this.props.phase.status_desc),"pending"===this.props.phase.status&&l.default.createElement("div",{className:v.default.tips},"\u8bf7\u5f00\u59cb",this.props.phase.name,this.props.refName&&this.props.refName.length>0&&l.default.createElement("div",{className:v.default.versionName,title:this.props.refName},this.props.refName," \u7248\u672c"),l.default.createElement("div",{className:v.default.versionSha},l.default.createElement(h.default,null),l.default.createElement("code",null,this.props.commitSha.substring(0,7))),"\u5982",this.props.phase.name,"\u6210\u529f\uff0c\u8bf7\u6807\u8bb0\u9636\u6bb5\u901a\u8fc7\u3002"),l.default.createElement("ul",{className:v.default.marks},this.props.phase.marks&&this.props.phase.marks.map(function(e,t){return l.default.createElement("li",{key:t,title:e.name},l.default.createElement("a",{href:e.url,target:"_blank"},(n=e.icon,a=y.MARK_ICON.find(function(e){return e.name===n}),a||y.MARK_ICON[0]).icon,e.name));var n,a}),l.default.createElement("li",{onClick:this.props.addMark,className:v.default.addMark},"\u6dfb\u52a0\u6807\u8bb0"))),this.props.autoSkipPhases&&this.props.autoSkipPhases.findIndex(function(e){return e===t.props.phase.name})>=0&&"pending"!==this.props.phase.status&&l.default.createElement("div",{className:v.default.actions},l.default.createElement("a",{className:v.default.skipAction,onClick:function(){t.props.autoSkipCancel(t.props.phase.name)}},"\u53d6\u6d88\u603b\u662f\u8df3\u8fc7")),this.props.autoSkipPhases&&-1===this.props.autoSkipPhases.findIndex(function(e){return e===t.props.phase.name})&&"pending"!==this.props.phase.status&&l.default.createElement("div",{className:v.default.actions},l.default.createElement("a",{className:v.default.skipAction,onClick:function(){return t.props.phaseAutoSkip(t.props.phase.name)}},"\u603b\u662f\u8df3\u8fc7")),"pending"===this.props.phase.status&&l.default.createElement("div",{className:v.default.actions},l.default.createElement("div",{className:v.default.main},l.default.createElement(f.default,{type:"confirm",className:v.default.pass,onClick:function(){t.props.changeStatus(t.props.phase.id,t.props.phase.name,t.props.phase.mrId,y.PHASE_STATUS.SUCCESS)}},"\u901a\u8fc7"),l.default.createElement(f.default,{type:"danger",onClick:function(){t.props.changeStatus(t.props.phase.id,t.props.phase.name,t.props.phase.mrId,y.PHASE_STATUS.FAILED)}},"\u4e0d\u901a\u8fc7")),l.default.createElement("a",{className:v.default.skip,onClick:function(){t.props.changeStatus(t.props.phase.id,t.props.phase.name,t.props.phase.mrId,y.PHASE_STATUS.SKIPPED)}},"\u8df3\u8fc7")))}},{key:"render",value:function(){return l.default.createElement("div",{className:v.default.container},l.default.createElement(s.default,{menu:this.renderMenu(),open:this.state.open,onToggle:this.onToggle},l.default.createElement(c.default,{text:this.props.phase.status_desc,status:this.props.phase.status,icon:this.props.icon,up:this.state.open})))}}]),t}(),a.propTypes={phase:u.default.object,icon:u.default.bool,previousPhaseStatus:u.default.string,applyReview:u.default.func,commitSha:u.default.string,refName:u.default.string,canApplyReview:u.default.bool,canApplyMerge:u.default.bool,autoSkipPhases:u.default.array,phaseAutoSkip:u.default.func,autoSkipCancel:u.default.func,changeStatus:u.default.func,addMark:u.default.func,canPubRelease:u.default.bool,pubRelease:u.default.func,showTouchMe:u.default.bool,pushTips:u.default.string,getActiveIndex:u.default.func,className:u.default.string},a.defaultProps={icon:!0,applyReview:function(){},canApplyReview:!1,commitSha:"",refName:"",autoSkipPhases:[],phaseAutoSkip:function(){},addMark:function(){},canPubRelease:!1,pubRelease:function(){},showTouchMe:!1,pushTips:"",isRequire:function(){}},r);t.default=b},1958:function(e,t,n){e.exports=n.p+"static/media/next-to-right-2.2c9bb622.svg"},1959:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=h(i),u=h(n(0)),s=h(n(549)),c=h(n(261)),f=h(n(544)),d=h(n(1466)),p=n(1543),m=h(n(3431));function h(e){return e&&e.__esModule?e:{default:e}}var y=d.default.RadioGroup,v=(r=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"render",value:function(){return l.default.createElement(s.default,{show:this.props.modalShow,onHide:this.props.onHideModel,style:{width:420},className:m.default.addMark},l.default.createElement(s.default.Header,null,"\u6dfb\u52a0\u6807\u8bb0"),l.default.createElement(s.default.Body,null,l.default.createElement("div",{className:m.default.name},"\u6807\u8bb0\u540d\u79f0"),l.default.createElement(c.default,{placeholder:"\u8bf7\u8f93\u5165\u6807\u8bb0\u540d\u79f0",size:"large",onChange:this.props.onNameChange,value:this.props.name}),l.default.createElement("div",{className:m.default.name},"\u6807\u8bb0\u56fe\u6807"),l.default.createElement(y,{name:"icon",defaultValue:"circle-o",onChange:this.props.onIconChange},p.MARK_ICON.map(function(e){return l.default.createElement(d.default,{key:e.name,value:e.name},e.icon)})),l.default.createElement("div",{className:m.default.name},"\u6807\u8bb0\u94fe\u63a5"),l.default.createElement(c.default,{placeholder:"\u8bf7\u8f93\u5165\u6807\u8bb0\u94fe\u63a5",size:"large",onChange:this.props.onUrlChange,className:m.default.lastInput,value:this.props.url})),l.default.createElement(s.default.Footer,null,l.default.createElement(f.default,{onClick:this.props.onSubmit},"\u6dfb\u52a0"),l.default.createElement(f.default,{empty:!0,onClick:this.props.onHideModel},"\u53d6\u6d88")))}}]),t}(),a.propTypes={modalShow:u.default.bool,onHideModel:u.default.func,onSubmit:u.default.func,name:u.default.string,onNameChange:u.default.func,icon:u.default.string,onIconChange:u.default.func,url:u.default.string,onUrlChange:u.default.func},r);t.default=v},1960:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=d(i),u=d(n(1796)),s=d(n(8)),c=n(3443),f=d(n(3447));function d(e){return e&&e.__esModule?e:{default:e}}var p=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderText=function(){var e=n.props,t=e.status,a=e.type,r=c.TYPE_ENUM[a].text;if(t===c.STATUS_ENUM.pending.status){return"\u7b49\u5f85".concat(r)}return r.concat(c.STATUS_ENUM[t].dec)},n.state={},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default.Component),o(t,[{key:"render",value:function(){var e=this.props,t=e.status,n=e.type,a=e.text,r=e.wrapClassName,o=e.feature;return l.default.createElement("div",{className:(0,s.default)(f.default.wrap,r,t?f.default[c.STATUS_ENUM[t].status]:"",o?f.default[o]:"")},l.default.createElement("span",{className:f.default.iconWrap},t===c.STATUS_ENUM.success.status?l.default.createElement(u.default,null):c.TYPE_ENUM[n].icon),l.default.createElement("span",{className:f.default.text},a||this.renderText()))}}]),t}(),a.propTypes={status:i.PropTypes.oneOf(Object.keys(c.STATUS_ENUM)),type:i.PropTypes.oneOf(Object.keys(c.TYPE_ENUM)),text:i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.element]),wrapClassName:i.PropTypes.string,feature:i.PropTypes.oneOf(["white"])},a.defaultProps={},r);t.default=p},1961:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=h(n(0)),l=n(2),u=h(l),s=h(n(8)),c=h(n(560)),f=h(n(547)),d=h(n(262)),p=n(78),m=h(n(1797));function h(e){return e&&e.__esModule?e:{default:e}}var y=(0,p.hocDropdown)(function(e){var t=e.canEdit;return u.default.createElement("div",{className:m.default.dropDownTitle},u.default.createElement("span",{className:"fs-12"},"\u8bc4\u5ba1\u8005"),t&&u.default.createElement(c.default,{className:m.default.icon}))},p.MediaDropdown.MenuItem),v=(r=a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.onSelect=e.onSelect.bind(e),e.state={members:[]},e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.members;this.setState({members:t.filter(function(t){return t.id!==e.props.author.id})})}},{key:"onSelect",value:function(e){if(e){var t=this.props.members.find(function(t){return t.id===e.value}),n={avatar:t.media,id:t.id,name:t.name,username:t.globalKey};this.props.reviewers.findIndex(function(t){return t.id===e.value})>-1?this.props.delReviewer(n):this.props.addReviewer(n)}}},{key:"onSearch",value:function(e,t){var n=e.toLowerCase();return t.filter(function(e){return e.text.toLowerCase().indexOf(n)>-1||e.globalKey.toLowerCase().indexOf(n)>-1||e.pinyin.toLowerCase().indexOf(n)>-1})}},{key:"renderReviewer",value:function(e,t){var n=this;return u.default.createElement("li",{key:t},u.default.createElement(d.default,{src:e.avatar,size:"tiny"}),u.default.createElement("span",{className:m.default.name},e.name),this.props.canEdit&&u.default.createElement(f.default,{className:m.default.removeIcon,onClick:function(){n.props.delReviewer(e)}}))}},{key:"render",value:function(){var e=this.props.reviewers;return u.default.createElement("div",{className:(0,s.default)(m.default.section,m.default.deadline)},u.default.createElement(y,{multiple:!0,items:this.state.members,value:e.map(function(e){return e.id}),onSelect:this.onSelect,disabled:!this.props.canEdit,canEdit:this.props.canEdit,searchable:!0,searchPlaceholder:"\u7b5b\u9009\u6210\u5458",onSearch:this.onSearch}),0===e.length&&u.default.createElement("div",{className:m.default.empty},"\u5c1a\u672a\u6dfb\u52a0\u4efb\u4f55\u8bc4\u5ba1\u8005"),0!==e.length&&u.default.createElement("ul",{className:m.default.items},e.map(this.renderReviewer,this)))}}]),t}(),a.propTypes={reviewers:i.default.array,addReviewer:i.default.func,delReviewer:i.default.func,members:i.default.array,canEdit:i.default.bool,author:i.default.object},r);t.default=v},1962:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(546),o=n(51),i=n(1449),l=n(3474),u=(a=l)&&a.__esModule?a:{default:a};t.default={path:"git/pages",documentTitle:(0,i.projectPage)(function(){return"Pages \u670d\u52a1"}),getComponent:function(e,t){n.e(154).then(function(){(0,r.injectAsyncReducer)("ONE_CLICK_DEPLOY",n(3915).default),(0,o.injectAsyncI18n)("ONE_CLICK_DEPLOY",n(3918)),t(null,n(3919).default)}.bind(null,n)).catch(n.oe)},indexRoute:{component:u.default},getChildRoutes:function(e,t){n.e(155).then(function(){t(null,[n(3920).default,{path:"*",onEnter:function(e,t){var n=e.params;t("/u/"+n.owner+"/p/"+n.project+"/git/pages")}}])}.bind(null,n)).catch(n.oe)}}},2195:function(e,t){},2196:function(e,t){},2197:function(e,t){},2203:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=y(n(0)),i=n(2),l=y(i),u=y(n(8)),s=y(n(261)),c=y(n(544)),f=y(n(550)),d=y(n(547)),p=y(n(1946)),m=n(1555),h=n(1459);function y(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));a.handleNameChange=a.handleNameChange.bind(a),a.onSave=a.onSave.bind(a);var r=e.file.name,o=p.default.extname(r),i=r.replace(o,"");return a.state={ext:o,fileName:i,saving:!1},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"componentWillUnmount",value:function(){this.unmounted=!0}},{key:"handleNameChange",value:function(e,t){this.setState({fileName:t})}},{key:"fullName",value:function(){var e=this.state;return""+e.fileName+e.ext}},{key:"onSave",value:function(){var e=this,t=this.state,n=t.fileName;if(!t.saving){var a=this.props,r=a.file,o=a.onSaved,i=a.onCancel;if(a.checkSameName&&n===r.name)i();else{var l=this.props.onConfirm(this.fullName(),r.id);if(!(l instanceof Promise))throw new Error("Promise instance required for onConfirm return");this.setState({saving:!0}),l.then(function(){o(e.fullName())}).finally(function(){e.unmounted||e.setState({saving:!1})})}}}},{key:"renderButtons",value:function(){var e=this.props,t=e.useButton,n=e.onCancel,r=this.state.saving,o={title:"\u4fdd\u5b58",onClick:this.onSave,key:"save"},i={title:"\u53d6\u6d88",onClick:n,key:"cancel"};return t?[l.default.createElement(c.default,a({},o,{loading:r,disabled:r,style:{margin:"0 10px"}}),"\u4fdd\u5b58"),l.default.createElement(c.default,a({},i,{disabled:r,empty:!0}),"\u53d6\u6d88")]:[l.default.createElement(f.default,o),l.default.createElement(d.default,i)]}},{key:"render",value:function(){var e,t,n,a=this,r=this.state.fileName,o=(0,u.default)(m.fileRename,(e={},t=m.fileRenameBlock,n=this.props.block,t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e));return l.default.createElement("div",{className:o},l.default.createElement(s.default,{autoFocus:!0,value:r,onChange:this.handleNameChange,onPressEnter:this.onSave,ref:function(e){e&&(a.input=e.input)}}),this.renderButtons())}}]),t}();v.propTypes={file:h.filePropTypes.isRequired,checkSameName:o.default.bool.isRequired,onCancel:o.default.func.isRequired,onConfirm:o.default.func.isRequired,onSaved:o.default.func.isRequired,useButton:o.default.bool,block:o.default.bool},v.defaultProps={checkSameName:!0,useButton:!1,block:!1},t.default=v},2204:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=l(n(0)),o=n(2),i=l(o);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleContentChange=function(e,t){var a=n.props.onChange;n.setState({editorState:e},t),a(n.props.getPlainText(e))},n.state={editorState:e.createWithContent(e.value)},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.projectId,r=t.header,o=t.autoSaveKey,l=t.projectOwner,u=t.projectName,s=t.mentionParams,c=t.MediumMarkEditor;return i.default.createElement(c,{className:n,ref:function(t){return e.hocEditor=t},projectId:a,editorState:this.state.editorState,onChange:this.handleContentChange,hashSearchParams:{owner:l,project:u},header:r,autoSize:!1,autoSaveKey:o,mentionParams:s,placeholder:"\u6587\u4ef6\u5185\u5bb9",emojiList:[],recommentEmojiList:[]})}}]),t}();u.propTypes={className:r.default.string,value:r.default.string,projectId:r.default.number,onChange:r.default.func.isRequired,header:r.default.node.isRequired,autoFocus:r.default.bool,autoSaveKey:r.default.string,projectName:r.default.string,projectOwner:r.default.string,mentionParams:r.default.object,defaultEditorState:r.default.object,MediumMarkEditor:r.default.func,getPlainText:r.default.func,createWithContent:r.default.func},t.default=u},2205:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=l(n(2)),o=l(n(261)),i=n(1506);function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return r.default.createElement(o.default,a({type:"textarea",placeholder:"\u6587\u4ef6\u5185\u5bb9"},(0,i.input)(e)))}},2206:function(e,t,n){e.exports={summary:"summary-daV","summary-line":"summary-line-2-m",summaryLine:"summary-line-2-m","summary-line-folder":"summary-line-folder-1RN",summaryLineFolder:"summary-line-folder-1RN","history-wrapper":"history-wrapper-1w7",historyWrapper:"history-wrapper-1w7",history:"history-LW2",version:"version-3Ep",active:"active-YNg",detail:"detail-1Ln",title:"title-QkO",time:"time-38v",operation:"operation-29A"}},2207:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=d(n(0)),o=n(2),i=d(o),l=d(n(8)),u=d(n(1790)),s=d(n(78)),c=d(n(1785)),f=n(1786);function d(e){return e&&e.__esModule?e:{default:e}}var p=r.default.shape({content:r.default.any,action:r.default.string.isRequired,context:r.default.any,title:r.default.string}),m=r.default.shape({visible:r.default.arrayOf(p),rest:r.default.arrayOf(p)}).isRequired,h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"renderVisibleItem",value:function(e){var t=e.content,n=e.action,a=e.context,r=e.title,o=this.props,u=o.onAction,s=o.toolTipPosition,d=o.itemClass,p=(0,l.default)(f.item,d);return i.default.createElement("div",{key:n,className:p,onClick:function(){u(n,a)}},i.default.createElement(c.default,{placement:s,title:r},t))}},{key:"renderVisibleItems",value:function(){return this.props.menu.visible.map(this.renderVisibleItem,this)}},{key:"renderRestItem",value:function(e){var t=this,n=e.action,a=e.content,r=e.context,o=e.title;return i.default.createElement("li",{key:n,className:f.restItem,title:o,onClick:function(){t.props.onAction(n,r)}},a)}},{key:"renderRest",value:function(){var e=this.props.menu.rest;return i.default.createElement("ul",{className:f.rest},e.map(this.renderRestItem,this))}},{key:"renderMore",value:function(){return 0===this.props.menu.rest.length?null:i.default.createElement("div",{className:f.item},i.default.createElement(s.default,{menu:this.renderRest()},i.default.createElement(u.default,null)))}},{key:"render",value:function(){return i.default.createElement("div",{className:f.toolbar},this.renderVisibleItems(),this.renderMore())}}]),t}();h.propTypes={menu:m,onAction:r.default.func.isRequired,toolTipPosition:r.default.string,itemClass:r.default.string},h.defaultProps={toolTipPosition:"top",itemClass:""},t.default=h},2209:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(0)),r=u(n(2)),o=u(n(3321)),i=u(n(545)),l=n(738);function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t=e.text,n=e.keys,a=void 0===n?[]:n;return r.default.createElement(o.default,{searchWords:a,textToHighlight:t,highlightClassName:"highlight-keyword"})};s.displayName="Highlight",s.propTypes={text:a.default.string,keys:a.default.arrayOf(a.default.string)},t.default=(0,i.default)(function(e){var t=e.PROJECT.file.filterKey;return{keys:(0,l.splitWithBlankSpace)(t)}},{})(s)},2210:function(e,t,n){e.exports={"share-icon":"share-icon-32L",shareIcon:"share-icon-32L","upload-progress-bar":"upload-progress-bar-2NF",uploadProgressBar:"upload-progress-bar-2NF"}},2211:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=g(n(0)),o=n(2),i=g(o),l=g(n(8)),u=n(168),s=g(n(2209)),c=n(1459),f=g(n(3323)),d=g(n(1693)),p=g(n(3330)),m=g(n(2203)),h=n(1479),y=n(1462),v=g(n(545)),E=n(1555),b=g(n(699));function g(e){return e&&e.__esModule?e:{default:e}}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state={renaming:e.newFolder||!1},a.onRename=a.onRename.bind(a),a.onRenameDone=a.onRenameDone.bind(a),a.onRenameCancel=a.onRenameCancel.bind(a),a.handleFolderClick=a.handleFolderClick.bind(a),a.onNameClick=a.onNameClick.bind(a),a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"onRename",value:function(){this.setState({renaming:!0})}},{key:"onRenameDone",value:function(){this.props.newFolder||this.setState({renaming:!1})}},{key:"onRenameCancel",value:function(){this.onRenameDone(),this.props.onCancel()}},{key:"handleFolderClick",value:function(e){var t=e.target,n=[E.fileNameHeader,"folder-icon"],a=Array.some(n,function(e){return(t.className||t.parentElement.className).indexOf(e)>=0});!this.state.renaming&&a||e.preventDefault()}},{key:"componentWillReceiveProps",value:function(e){"undefined"!==typeof this.props.newFolder&&e.newFolder!==this.state.renaming&&this.setState({renaming:e.newFolder})}},{key:"renderName",value:function(){var e=this.state.renaming,t=this.props,n=t.file,a=t.isFiltering,r=t.newFolder,o=t.uploading;if(e)return i.default.createElement(m.default,{onConfirm:this.props.onNameChange,onSaved:this.onRenameDone,onCancel:this.onRenameCancel,file:n,checkSameName:!r,ref:function(e){e&&r&&e.input.select()}});var l=o?"\u6587\u4ef6\u4e0a\u4f20\u4e2d...":n.name;return i.default.createElement("span",{title:l,style:{cursor:o?"not-allowed":"pointer"}},a?i.default.createElement(s.default,{text:l}):l,o&&this.renderUploadProgress())}},{key:"renderUploadProgress",value:function(){var e=this.props.file.progress;return i.default.createElement("span",{style:{paddingLeft:"15px"}},i.default.createElement(b.default,null)," ",e,"%")}},{key:"renderHeader",value:function(){var e=this.props.file;return i.default.createElement("div",{className:E.fileNameHeader+" ellipsis"},i.default.createElement(f.default,{file:e}),this.renderName())}},{key:"onNameClick",value:function(e,t){t||this.props.onOpenPreview()}},{key:"renderLinkableHeader",value:function(){var e=this,t=this.state.renaming,n=this.props,a=n.file,r=a.type,o=a.fileId,l=a.parentId,s=n.projectPath,c=n.newFolder,f=n.uploading,d=n.isShareFolder,p=r===h.TYPE.FOLDER;if(!c&&!t&&!f){var m=s+"/attachment/"+o,y=void 0;return y=d?s+"/attachment/share/preview/"+o:s+"/attachment/"+(0===l?"default":l)+"/preview/"+o,i.default.createElement(u.Link,{className:E.folderLink,to:p?m:y,onClick:function(t){return e.onNameClick(t,p)}},this.renderHeader())}return this.renderHeader()}},{key:"render",value:function(){var e=this.props,t=e.file,n=e.toolbar,a=e.share,r=(0,l.default)(E.fileName,w({},E.fileNameRenaming,this.state.renaming)),o=!n&&a;return i.default.createElement("div",{className:r},this.renderLinkableHeader(),i.default.createElement("div",{className:(0,l.default)(E.fileNameToolbar,w({},E.gray,!o))},o&&i.default.createElement("span",{className:E.shareIcon},i.default.createElement(d.default,null)),n&&!t.select?i.default.createElement(p.default,{file:t,onRename:this.onRename}):null))}}]),t}();_.propTypes={file:c.filePropTypes,share:r.default.object,uploading:r.default.bool,toolbar:r.default.bool.isRequired,isFiltering:r.default.bool,newFolder:r.default.bool,onNameChange:r.default.func.isRequired,previewFile:r.default.func.isRequired,onOpenPreview:r.default.func.isRequired,onCancel:r.default.func,projectPath:r.default.string,isShareFolder:r.default.bool.isRequired},_.defaultProps={toolbar:!1,onCancel:function(){},onNameChange:function(){},onOpenPreview:function(){},isShareFolder:!1},t.default=(0,v.default)(function(e,t){var n=e.PROJECT.file.upload.uploadFiles,a=void 0===n?[]:n,r=t.file.fileId;return{uploading:Object.keys(a).some(function(e){var t=a[e];return t&&t.fileId===r})}},{previewFile:y.previewFile})(_)},2214:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=f(n(0)),o=n(2),i=f(o),l=n(1786),u=n(168),s=f(n(545)),c=n(1459);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"renderFolders",value:function(){var e=this.props,t=e.projectPath,n=e.folderPaths,a=e.append,r=a?[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n),[{fileId:"create",name:a}]):n;if(0===r.length)return i.default.createElement("li",null,"\u6240\u6709\u6587\u4ef6");var o=t+"/attachment";return[i.default.createElement("li",{key:"allAttachment"},i.default.createElement(u.Link,{to:o},"\u6240\u6709\u6587\u4ef6"))].concat(r.map(function(e,t){var n=e.fileId,a=e.name;return i.default.createElement("li",{key:n},t===r.length-1?a:i.default.createElement(u.Link,{to:o+"/"+n},a))}))}},{key:"render",value:function(){return i.default.createElement("ul",{className:"ellipsis "+l.fileBreadcrumb},this.renderFolders())}}]),t}();d.propTypes={projectPath:r.default.string.isRequired,folderPaths:r.default.arrayOf(c.folderPathPropTypes),append:r.default.string},d.defaultProps={pageSize:0,totalRow:0,filteredResultCount:0},t.default=(0,s.default)(function(e){return{projectPath:e.APP.projectPath,folderPaths:e.PROJECT.file.folderPaths}},{})(d)},2215:function(e,t,n){e.exports={toolbar:"toolbar-1Fu",item:"item-2kq",rest:"rest-miG","rest-item":"rest-item-r2e",restItem:"rest-item-r2e",tooltip:"tooltip-3PQ","file-breadcrumb":"file-breadcrumb-3me",fileBreadcrumb:"file-breadcrumb-3me","file-suffix-name":"file-suffix-name-2JO",fileSuffixName:"file-suffix-name-2JO",header:"header-1KH","form-line":"form-line-2a1",formLine:"form-line-2a1",editor:"editor-3YC","ext-name":"ext-name-2Dq",extName:"ext-name-2Dq","editor-header":"editor-header-3gL",editorHeader:"editor-header-3gL","name-input":"name-input-itQ",nameInput:"name-input-itQ",buttons:"buttons-3dl"}},2216:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=h(n(0)),u=n(2),s=h(u),c=h(n(699)),f=h(n(3348)),d=h(n(2231)),p=h(n(2232)),m=h(n(3403));function h(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var v=(r=a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={directoryLoading:!1,directoryError:null},y(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Component),i(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.params.iid;this.fetchDirectory().then(function(){e.goto(t)})}},{key:"componentWillUnmount",value:function(){this.unmounted=!0}},{key:"componentWillReceiveProps",value:function(e){this.props.params.iid!==e.params.iid&&this.goto(e.params.iid)}},{key:"goto",value:function(e){var t=this.props.params,n=t.owner,a=t.project;if(e)this.props.getWiki(n,a,e);else{var r=this.props.directory.tree;r.length>0&&this.props.getWiki(n,a,r[0].iid)}}},{key:"fetchDirectory",value:function(){var e=this;return this.setState({directoryLoading:!0}),this.props.fetchDirectory().then(function(){e.unmounted||e.setState({directoryLoading:!1})}).catch(function(t){e.unmounted||e.setState({directoryLoading:!1,directoryError:t})})}},{key:"renderNotFound",value:function(){return s.default.createElement("div",{className:m.default.empty},s.default.createElement("img",{src:"https://dn-coding-net-production-pp.codehub.cn/bd0ba0f6-ce8e-49c7-933e-dcbb0ddcc2ae.png"}),s.default.createElement("div",{className:m.default.tip},"\u76f8\u5173\u8054\u7684\u6587\u7ae0\u4e0d\u5b58\u5728"))}},{key:"render",value:function(){var e=this.props,t=e.directory,n=e.currentProject,a=e.postWiki,r=e.delWiki,i=e.moveWiki,l=e.params,u=e.router,h=e.wiki,y=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(e,["directory","currentProject","postWiki","delWiki","moveWiki","params","router","wiki"]),v=this.state,E=v.directoryLoading,b=v.directoryError;if(E)return s.default.createElement("div",{className:m.default.loading},s.default.createElement(c.default,null));if(!b&&0===t.tree.length)return s.default.createElement(p.default,{router:u});var g=o({},l,{iid:l.iid||t.tree[0]&&t.tree[0].iid});return s.default.createElement("div",{className:m.default.content},s.default.createElement(f.default,{initialPath:h.path,router:this.props.router,currentProject:n,directory:t,activeId:g.iid.toString(),postWiki:a,delWiki:r,moveWiki:i}),s.default.createElement("div",{className:m.default.main},h?s.default.createElement(d.default,o({},y,{wiki:h,params:g,delWiki:r})):this.renderNotFound()))}}]),t}(),a.propTypes=o({},f.default.propTypes,{params:l.default.object,fetchDirectory:l.default.func,delWiki:l.default.func}),r);t.default=v},2230:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TYPES=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=p(n(0)),l=n(2),u=p(l),s=n(16),c=p(n(8)),f=p(n(3394)),d=n(1606);function p(e){return e&&e.__esModule?e:{default:e}}var m=t.TYPES={ITEM:"TREE_ITEM"};var h={canDrop:function(e,t){if(!t.isOver({shallow:!0}))return!1;var n=e.id,a=e.path,r=t.getItem();return n!==r.id&&!a.startsWith(r.path)},hover:function(e,t,n){if(h.canDrop(e,t)){var a=(0,s.findDOMNode)(n),r=a.querySelector(".tree-view > .tree-view_item"),o=r.getBoundingClientRect(),i=t.getClientOffset(),l=(o.bottom-o.top)/2,u=i.y-o.top;u>l&&u<o.height+10?a.classList.add("dnd-insert-mark"):(u>2*o.height?r.classList.add("dnd-nest-hover"):r.classList.remove("dnd-nest-hover"),a.classList.remove("dnd-insert-mark"))}},drop:function(e,t,n){var a=(0,s.findDOMNode)(n),r=e.path,o=e.collapsed,i=e.children,l=t.getItem(),u=a.classList.contains("dnd-insert-mark");e.moveWiki(l.path,r,{isInsert:u,collapsed:o,isDirectory:i.length>0})}};var y=(r=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"render",value:function(){var e=this.props,t=e.connectDragSource,n=e.isDragging,a=e.connectDropTarget,r=e.canDrop,o=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(e,["connectDragSource","isDragging","connectDropTarget","canDrop"]),i=(0,c.default)("tree-view_dnd_wrapper",{canDrop:r,isDrag:n});return delete o.path,delete o.moveWiki,t(a(u.default.createElement("div",{className:i},u.default.createElement(f.default,o))))}}]),t}(),a.propTypes={connectDragSource:i.default.func.isRequired,connectDropTarget:i.default.func.isRequired,isDragging:i.default.bool.isRequired,canDrop:i.default.bool.isRequired},r);t.default=(0,d.DropTarget)(m.ITEM,h,function(e,t){return{connectDropTarget:e.dropTarget(),canDrop:t.canDrop()}})((0,d.DragSource)(m.ITEM,{beginDrag:function(e){return{id:e.id,path:e.path}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(y))},2231:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=C(n(0)),i=n(2),l=C(i),u=C(n(8)),s=C(n(263)),c=n(168),f=C(n(1782)),d=C(n(1505)),p=C(n(547)),m=C(n(1693)),h=C(n(544)),y=C(n(704)),v=C(n(1460)),E=C(n(3398)),b=n(112),g=C(n(545)),w=C(n(1947)),_=C(n(1665)),P=C(n(1666)),O=n(1581),k=n(106),T=C(n(76)),S=C(n(3399)),N=n(559);function C(e){return e&&e.__esModule?e:{default:e}}function I(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var j={params:o.default.any,getWiki:o.default.func,wiki:o.default.shape({iid:o.default.number,editor:o.default.object,share:o.default.object}),delWiki:o.default.func,setVersion:o.default.func,push:o.default.func,projectPath:o.default.string,projectId:o.default.number,shareWiki:o.default.func,stopShareWiki:o.default.func,showRemindButton:o.default.bool},F=(0,E.default)()(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=I(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={show:!1},a.onShow=function(){a.setState({show:!0})},a.onHide=function(){a.setState({show:!1})},a.setVersion=function(){var e=a.props,t=e.params,n=e.wiki,r=e.projectPath;confirm("\u8bf7\u95ee\u662f\u5426\u8981\u6062\u590d\u5230\u5f53\u524d\u7248\u672c\uff1f")&&a.props.setVersion(t.owner,t.project,t.iid,n.currentVersion).then(function(){(0,b.success)("\u8bbe\u7f6e\u6210\u529f"),a.props.push(r+"/wiki/"+t.iid)})},a.remove=function(){var e=a.props,t=e.params,n=e.wiki,r=e.projectPath,o=n.path.substring(0,n.path.lastIndexOf("/")),i=""===o?o:"/"+o;n.children&&n.children.length>0?(0,b.danger)("\u6b64\u6587\u7ae0\u4e0b\u4ecd\u5b58\u5728\u5b50\u6587\u7ae0\uff0c\u4e0d\u80fd\u5220\u9664\u3002"):confirm("\u5220\u9664\u7684\u540c\u65f6\u4e5f\u4f1a\u5220\u9664\u5386\u53f2\u7248\u672c\uff0c\u8bf7\u786e\u8ba4\u5220\u9664\u8be5 Wiki ?")&&a.props.delWiki(t.iid,i).then(function(){(0,b.success)("\u5220\u9664\u6210\u529f"),a.props.push(r+"/wiki")})},a.shareWiki=function(){var e=a.props,t=e.wiki,n=e.projectId;a.props.shareWiki(n,t.iid)},a.stopShareWiki=function(){var e=a.props.wiki,t=e.iid,n=e.share;a.props.stopShareWiki(t,n.hash)},I(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.wiki,a=t.projectPath,r=a+"/wiki/"+n.iid,o=n.share,i=void 0===o?{}:o;return l.default.createElement("div",{className:S.default.wikiShow},l.default.createElement(w.default,{show:this.state.show,onHide:this.onHide,type:k.RESOURCE_TYPE.WIKI,targetName:n.title,sharing:!(0,T.default)(i),url:i.url,onShare:this.shareWiki,onStopShare:this.stopShareWiki}),l.default.createElement(O.PutInMotion,{of:"worktable-remind-motion",offsetY:18,motion:l.default.createElement(P.default,null),key:n.id},function(t){return l.default.createElement("div",{className:S.default.headerContainer},l.default.createElement("div",{className:S.default.header},l.default.createElement("h2",{className:S.default.title},n.title)),l.default.createElement("div",{className:S.default.wikiInfo},l.default.createElement("span",{className:S.default.idTag},"#",n.iid),l.default.createElement("span",{className:S.default.editor},n.editor.name),l.default.createElement("span",{className:S.default.date},"\u66f4\u65b0\u4e8e",(0,s.default)(n.updatedAt).format("YYYY-MM-DD HH:mm")),l.default.createElement("span",{className:S.default.edit},l.default.createElement(c.Link,{to:a+"/wiki/page/"+n.iid+"/histories"},l.default.createElement(f.default,{className:S.default.icon}),"\u5171 ",n.historiesCount," ","\u4e2a\u7248\u672c")),l.default.createElement("span",{className:S.default.edit},"\u5f53\u524d\u7248\u672c ",n.currentVersion),l.default.createElement("span",{className:S.default.share,onClick:e.onShow},l.default.createElement(m.default,{className:S.default.icon}),n.share?"\u5df2\u5206\u4eab":"\u5206\u4eab"),l.default.createElement("span",{className:S.default.edit},l.default.createElement(c.Link,{to:a+"/wiki/page/"+n.iid+"/edit"},l.default.createElement(d.default,{className:S.default.icon}),"\u7f16\u8f91")),l.default.createElement("span",{className:(0,u.default)(S.default.edit,S.default.remove),hidden:n.currentVersion!==n.lastVersion,onClick:e.remove},l.default.createElement(p.default,{className:S.default.icon}),"\u5220\u9664"),l.default.createElement("spam",{className:S.default.remind},l.default.createElement("span",{className:S.default.btn},l.default.createElement(h.default,{size:"small",type:"general",hidden:n.currentVersion===n.lastVersion,onClick:e.setVersion,empty:!0},"\u6062\u590d\u81f3\u8be5\u7248\u672c")),l.default.createElement(_.default,{reminded:n.reminded,targetId:n.id,triggerPutIn:t,targetType:_.default.TargetType.WIKI}))))}),l.default.createElement("div",{className:S.default.warning,hidden:n.currentVersion===n.lastVersion},l.default.createElement(y.default,{type:"warning"},"\u8fd9\u662f\u8be5\u9875\u9762\u7684\u4e00\u4e2a\u65e7\u7248\u672c\uff0c\u67e5\u770b\u5b83\u7684",l.default.createElement(c.Link,{to:r},"\u6700\u65b0\u7248\u672c"),"\u6216\u6d4f\u89c8\u5b83\u7684",l.default.createElement(c.Link,{to:a+"/wiki/page/"+n.iid+"/histories"},"\u5386\u53f2\u7248\u672c"),"\u3002")),l.default.createElement(v.default,{html:n.html}))}}]),t}())||a;F.propTypes=j,t.default=(0,g.default)(function(e){var t=e.APP;return{projectPath:t.projectPath,projectId:t.currentProject.id}},{shareWiki:N.shareWiki,stopShareWiki:N.stopShareWiki},function(e){return e})(F)},2232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=h(n(0)),l=n(2),u=h(l),s=h(n(545)),c=n(51),f=h(n(544)),d=n(168),p=h(n(702)),m=n(3401);function h(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var v=(r=a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={showNewModal:!1},y(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"render",value:function(){var e=this.props.projectPath+"/wiki/new";return u.default.createElement("div",{className:m.empty},u.default.createElement("img",{src:p.default.ICONS.Wiki}),u.default.createElement(c.I18n,{region:"WIKI",i18n:"welcome.to.use.wiki",className:m.welcome}),u.default.createElement(c.I18n,{region:"WIKI",i18n:"wiki.info",className:m.tip}),u.default.createElement(d.Link,{to:e},u.default.createElement(f.default,{size:"large"},u.default.createElement(c.I18n,{region:"WIKI",i18n:"create.wiki.now"}))))}}]),t}(),a.propTypes={router:i.default.object,projectPath:i.default.string},r);t.default=(0,s.default)(function(e){return{projectPath:e.APP.currentProject.project_path}})(v)},2233:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ACTION={FETCH_WIKIS:"WIKI.FETCH.WIKIS",POST_WIKI:"WIKI.POST_WIKI",GET_WIKI:"WIKI.GET_WIKI",DEL_WIKI:"WIKI.DEL_WIKI",MOVE_WIKI:"WIKI.MOVE_WIKI",GET_WIKI_HISTORIES:"WIKI.GET_WIKI_HISTORIES",FETCH_DIRECTORY:"WIKI.FETCH_DIRECTORY",SHARE_WIKI:"WIKI.SHARE_WIKI",STOP_SHARE_WIKI:"WIKI.STOP_SHARE_WIKI"},t.WIKI_PAGE_SIZE=20},2234:function(e,t,n){e.exports={"new-wiki":"new-wiki-3VQ",newWiki:"new-wiki-3VQ",header:"header-9Yv",msg:"msg-2A9","button-group":"button-group-2cD",buttonGroup:"button-group-2cD",editor:"editor-1fm"}},2235:function(e,t,n){e.exports={"wiki-top-menu":"wiki-top-menu-2Wn",wikiTopMenu:"wiki-top-menu-2Wn","wiki-shoulder":"wiki-shoulder-Psm",wikiShoulder:"wiki-shoulder-Psm",header:"header-cI2",back:"back-1s_",dropdown:"dropdown-2FZ",table:"table-36N","wiki-title":"wiki-title-3je",wikiTitle:"wiki-title-3je","file-icon":"file-icon-3vD",fileIcon:"file-icon-3vD","share-icon":"share-icon-qM0",shareIcon:"share-icon-qM0",show:"show-1b1","wiki-iid":"wiki-iid-3tW",wikiIid:"wiki-iid-3tW","wiki-created-at":"wiki-created-at-32E",wikiCreatedAt:"wiki-created-at-32E","wiki-creator":"wiki-creator-1i8",wikiCreator:"wiki-creator-1i8"}},2236:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=O(n(0)),l=n(2),u=O(l),s=O(n(545)),c=O(n(76)),f=n(106),d=n(707),p=n(1484),m=n(1694),h=O(n(3425)),y=O(n(3427)),v=O(n(3442)),E=O(n(698)),b=O(n(544)),g=O(n(8)),w=n(112),_=O(n(3454)),P=O(n(2240));function O(e){return e&&e.__esModule?e:{default:e}}var k=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isNoCommit=function(){var e=n.props.currentDepot;return new Promise(function(t,n){e&&e.hasCommits||t(),n()})},n.toCodePage=function(){n.props.router.push(""+n.props.currentDepot.depot_path)},n.state={addFlowModalShow:!1,addFlowBranch:"",addFlowName:""},n.onAddFlowModalHide=n.onAddFlowModalHide.bind(n),n.onSubmitAddFlow=n.onSubmitAddFlow.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.params,n=e.currentDepot;if(f.IS_ENTERPRISE){var a=this.props.enterprise;((0,c.default)(t)||n.path)&&(a.key+"/"+t.project).toLowerCase()===n.path.toLowerCase()&&n.hasCommits||this.getDepotStatistics(t.owner,t.project)}else((0,c.default)(t)||n.path)&&(t.owner+"/"+t.project).toLowerCase()===n.path.toLowerCase()||this.getDepotStatistics(t.owner,t.project)}},{key:"componentWillReceiveProps",value:function(e){var t=e.params,n=t.owner,a=t.project,r=this.props,o=r.params,i=r.currentDepot;if(f.IS_ENTERPRISE){var l=this.props.enterprise;(a!==o.project||i.path&&(l.key+"/"+a).toLowerCase()!==i.path.toLowerCase())&&this.getDepotStatistics(n,a)}else(n!==o.owner||a!==o.project||i.path&&n+"/"+a!==i.path)&&this.getDepotStatistics(n,a)}},{key:"getDepotStatistics",value:function(e,t){var n=this;this.props.getCurrentDepot(e,t).then(function(e){n.props.fetchBranchesList(),n.props.fetchTagsList(),n.props.fetchCommitsByBranch(e.depot.default_branch),n.isNoCommit().then(function(){n.toCodePage()}).catch(function(){})})}},{key:"onAddFlowModalHide",value:function(){this.setState({addFlowModalShow:!1,addFlowBranch:"",addFlowName:""})}},{key:"onSubmitAddFlow",value:function(){var e=this;this.props.addFlow(this.state.addFlowBranch,this.state.addFlowName).then(function(){(0,w.success)("\u6dfb\u52a0\u6210\u529f"),e.setState({addFlowModalShow:!1,addFlowBranch:"",addFlowName:""})})}},{key:"render",value:function(){var e=this;if(this.props.currentDepotLoading||this.props.currentProjectLoading)return u.default.createElement("div",{className:P.default.container},u.default.createElement(E.default,{show:!0}));if(this.props.params.iid){var t=this.props,n=t.children,a=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(t,["children"]);return u.default.createElement("div",{className:P.default.container},u.default.cloneElement(n,a))}return u.default.createElement("div",{className:P.default.container},u.default.createElement("div",{className:(0,g.default)(P.default.header,"clearfix")},u.default.createElement("h3",{className:P.default.title},this.props.currentDepot.hasCommits&&0===this.props.currentDepot.flow_type&&"\u6d41\u6c34\u7ebf",this.props.currentDepot.hasCommits&&1===this.props.currentDepot.flow_type&&"\u5feb\u901f\u8fed\u4ee3\u6a21\u578b",this.props.currentDepot.hasCommits&&2===this.props.currentDepot.flow_type&&"\u5e76\u884c\u5f00\u53d1\u6a21\u578b"),this.props.currentDepot.hasCommits&&2===this.props.currentDepot.flow_type&&this.props.flows.data.list&&0!==this.props.flows.data.list.length&&u.default.createElement(b.default,{className:P.default.addBtn,onClick:function(){e.setState({addFlowModalShow:!0})}},"\u65b0\u5efa\u5f00\u53d1\u7ebf")),this.props.currentDepot.hasCommits&&0===this.props.currentDepot.flow_type&&u.default.createElement(h.default,{flowInit:this.props.flowInit,getDepot:this.props.getCurrentDepot,params:this.props.params}),this.props.currentDepot.hasCommits&&1===this.props.currentDepot.flow_type&&u.default.createElement(y.default,{depot:this.props.currentDepot,project:this.props.currentProject,location:this.props.location}),this.props.currentDepot.hasCommits&&2===this.props.currentDepot.flow_type&&u.default.createElement(v.default,{depot:this.props.currentDepot,project:this.props.currentProject,location:this.props.location,addFlow:function(){e.setState({addFlowModalShow:!0})}}),u.default.createElement(_.default,{modalShow:this.state.addFlowModalShow,onHideModal:this.onAddFlowModalHide,onSubmit:this.onSubmitAddFlow,branch:this.state.addFlowBranch,onBranchChange:function(t){return e.setState({addFlowBranch:t.target.value})},flowName:this.state.addFlowName,onFlowNameChange:function(t){return e.setState({addFlowName:t.target.value})}}))}}]),t}(),a.propTypes={children:i.default.any,params:i.default.object,getCurrentDepot:i.default.func,currentDepotLoading:i.default.bool,currentDepot:i.default.object,currentProjectLoading:i.default.bool,currentProject:i.default.object,fetchTagsList:i.default.func,fetchBranchesList:i.default.func,fetchCommitsByBranch:i.default.func,flowInit:i.default.func,addFlow:i.default.func,projectPath:i.default.string,location:i.default.object,flows:i.default.object,enterprise:i.default.object,router:i.default.object.isRequired},r);t.default=(0,s.default)(function(e){var t=e.APP;return{currentDepotLoading:t.currentDepotLoading,currentDepot:t.currentDepot,currentProjectLoading:t.currentProjectLoading,currentProject:t.currentProject,enterprise:t.enterprise,flows:e.FLOW.flows}},{getCurrentDepot:d.getCurrentDepot,flowInit:m.flowInit,addFlow:m.addFlow,fetchTagsList:p.fetchTagsList,fetchBranchesList:p.fetchBranchesList,fetchCommitsByBranch:p.fetchCommitsByBranch})(k)},2240:function(e,t,n){e.exports={container:"container-33s",header:"header-3qi",title:"title-2R2",icon:"icon-1gL","add-btn":"add-btn-3Co",addBtn:"add-btn-3Co","empty-title":"empty-title-1jE",emptyTitle:"empty-title-1jE","empty-types":"empty-types-30i",emptyTypes:"empty-types-30i",archive:"archive-1zz","type-tow":"type-tow-3hn",typeTow:"type-tow-3hn",img:"img-1ln",body:"body-gtJ",video:"video-Y4U",infos:"infos-Ld5",info:"info-2bL",desc:"desc-2zm","empty-foot":"empty-foot-2Lu",emptyFoot:"empty-foot-2Lu"}},2241:function(e,t,n){e.exports={container:"container-1hy","disabled-dropdown":"disabled-dropdown-3yd",disabledDropdown:"disabled-dropdown-3yd","disabled-tips":"disabled-tips-1mb",disabledTips:"disabled-tips-1mb","drop-down":"drop-down-3qJ",dropDown:"drop-down-3qJ",show:"show-99D",tips:"tips-3KC",pr:"pr-1g3","version-name":"version-name-2kE",versionName:"version-name-2kE","version-sha":"version-sha-31q",versionSha:"version-sha-31q",icon:"icon-1oN","pr-icon":"pr-icon-2jw",prIcon:"pr-icon-2jw","pr-tips":"pr-tips-3Pl",prTips:"pr-tips-3Pl","created-at":"created-at-3nH",createdAt:"created-at-3nH",marks:"marks-zoc","add-mark":"add-mark-2k_",addMark:"add-mark-2k_",actions:"actions--Ly","apply-review":"apply-review-2ze",applyReview:"apply-review-2ze",main:"main-2dI",pass:"pass-3R4",skip:"skip-BKN","skip-action":"skip-action-3iU",skipAction:"skip-action-3iU","push-tips":"push-tips-16k",pushTips:"push-tips-16k",tip1:"tip1-2vy",tip2:"tip2-26f",tip3:"tip3-2YJ","touch-me":"touch-me-SCW",touchMe:"touch-me-SCW",phase:"phase-2ae",next:"next-1ck",step:"step-2x8","has-icon":"has-icon-Bz2",hasIcon:"has-icon-Bz2",right:"right-5wW"}},2242:function(e,t,n){e.exports={container:"container-2vQ",hide:"hide-1ss","commit-group":"commit-group-3Ot",commitGroup:"commit-group-3Ot",date:"date-2o_",dashed:"dashed-2g7",commit:"commit-3e6","grey-border":"grey-border-3Si",greyBorder:"grey-border-3Si",processWrap:"processWrap-3Pe",text:"text-BPJ",commitContainer:"commitContainer-2LE","point-wrap":"point-wrap-32l",pointWrap:"point-wrap-32l","dec-wrap":"dec-wrap-oK5",decWrap:"dec-wrap-oK5","title-link":"title-link-31j",titleLink:"title-link-31j",content:"content-3h9","commit-title":"commit-title-2BM",commitTitle:"commit-title-2BM","release-title":"release-title-3ZY",releaseTitle:"release-title-3ZY","commit-point":"commit-point-TGt",commitPoint:"commit-point-TGt",icon:"icon-2q-","release-point":"release-point-1kN",releasePoint:"release-point-1kN","empty-commit":"empty-commit-1t5",emptyCommit:"empty-commit-1t5","commit-icon-wrap":"commit-icon-wrap-xCQ",commitIconWrap:"commit-icon-wrap-xCQ",single:"single-3-_",phases:"phases-1qG",next:"next-3MW","page-bar":"page-bar-1SY",pageBar:"page-bar-1SY","empty-tips":"empty-tips-3vG",emptyTips:"empty-tips-3vG",link:"link-3g5"}},2243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=p(i),u=p(n(0)),s=p(n(549)),c=p(n(261)),f=p(n(544)),d=p(n(3440));function p(e){return e&&e.__esModule?e:{default:e}}var m=(r=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"render",value:function(){return l.default.createElement(s.default,{show:this.props.modalShow,onHide:this.props.onHideModel,style:{width:360},className:d.default.newRelease},l.default.createElement(s.default.Header,null,"\u53d1\u5e03\u6b64\u7248\u672c"),l.default.createElement(s.default.Body,null,l.default.createElement("div",{className:d.default.tipMessage},"\u5efa\u8bae\u4f7f\u7528",l.default.createElement("a",{href:"https://semver.org/lang/zh-CN/"},"\u300c\u8bed\u4e49\u5316\u7248\u672c\u300d"),"\u6765\u89c4\u5212\u60a8\u7684\u53d1\u5e03\u3002 \u53d1\u5e03\u65b0\u7248\u672c\uff0c\u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a Release\u3002"),l.default.createElement(c.default,{placeholder:"\u8bf7\u8f93\u5165\u7248\u672c\u53f7\uff0c\u4f8b\u5982 v1.0.1",size:"large",value:this.props.title,onChange:this.props.onTitleChange})),l.default.createElement(s.default.Footer,null,l.default.createElement(f.default,{onClick:this.props.onSubmit},"\u786e\u8ba4\u53d1\u5e03"),l.default.createElement(f.default,{empty:!0,onClick:this.props.onHideModel},"\u53d6\u6d88")))}}]),t}(),a.propTypes={modalShow:u.default.bool,onHideModel:u.default.func,onSubmit:u.default.func,title:u.default.string,onTitleChange:u.default.func},r);t.default=m},2244:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=c(i),u=c(n(8)),s=c(n(3449));function c(e){return e&&e.__esModule?e:{default:e}}var f={pending:"#D8DDE4",success:"#37BD78",skipped:"#F2C143",failed:"#F46365",canceled:"#F46365"},d=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderPhase=function(){return n.props.list.map(function(e,t){return l.default.createElement("i",{key:t,className:s.default.phase,style:{backgroundColor:f[e.status]}})})},n.renderText=function(){var e=["skipped","success"],t=n.props.list.every(function(t){return e.some(function(e){return e===t.status})});return l.default.createElement("div",{className:(0,u.default)(s.default.dec,t?s.default.finished:"")},t?"\u5df2\u5b8c\u6210":"\u8fdb\u884c\u4e2d")},n.state={},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default.Component),o(t,[{key:"render",value:function(){return l.default.createElement("div",{className:s.default.wrap},l.default.createElement("div",{className:s.default.phases},this.renderPhase()),this.renderText())}}]),t}(),a.propTypes={list:i.PropTypes.arrayOf(i.PropTypes.shape({status:i.PropTypes.string.isRequired}))},a.defaultProps={list:[{status:"pending"}]},r);t.default=d},2245:function(e,t,n){e.exports={container:"container--vT",header:"header-3wU",icon:"icon-1P4",title:"title-3M_",titleContainer:"titleContainer-3oJ",infos:"infos-2K7",time:"time-in8","branch-label":"branch-label-1fX",branchLabel:"branch-label-1fX",flow:"flow-2nv","left-line":"left-line-2ZF",leftLine:"left-line-2ZF",dotted:"dotted-1qW","right-line":"right-line-C6I",rightLine:"right-line-C6I","main-line":"main-line-1an",mainLine:"main-line-1an","commit-point":"commit-point-1RL",commitPoint:"commit-point-1RL","branch-line":"branch-line-1-3",branchLine:"branch-line-1-3",item:"item-18j",commit:"commit-2Dm","apply-review":"apply-review-1Fz",applyReview:"apply-review-1Fz",editor:"editor-3OY",review:"review-1Zd",wrap:"wrap-2Ai",leftBox:"leftBox-3i_",rightBox:"rightBox-3Df",leftIcon:"leftIcon-1lt",rightIcon:"rightIcon-2VI",success:"success-32f",topLeftLine:"topLeftLine-ZBG",branchLabelContainer:"branchLabelContainer-2jF",topRightArrow:"topRightArrow-2JZ",childrenContainer:"childrenContainer-8rv",commitWrap:"commitWrap-1ku"}},2246:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(2)),r=s(n(0)),o=n(168),i=s(n(1454)),l=s(n(700)),u=s(n(3476));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){return a.default.createElement("div",{className:e.className},[0,1,2,3].map(function(t){return function(e,t){if(!t)return a.default.createElement("div",{key:"no_"+e,className:u.default.deploySquare});var n=a.default.createElement(l.default,{placement:"top"},t.project_name);return a.default.createElement(i.default,{placement:"top",overlay:n,key:t.id+"-"+e},a.default.createElement(o.Link,{to:"/u/"+t.global_key+"/p/"+t.project_name+"/git/pages"},a.default.createElement("div",{className:u.default.deploySquare+" "+u.default.deployed})))}(t,e.sites[t])}))};c.propTypes={className:r.default.string,sites:r.default.array},c.defaultProps={className:"",sites:[]},t.default=c},2247:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ACTION={GET_HOSTS:"ONE_CLICK_DEPLOY.GET.HOST",GET_HOST:"ONE_CLICK_DEPLOY.GET.HOST",ACQUIRE_HOST:"ONE_CLICK_DEPLOY.ACQUIRE.HOST",CANCEL_HOST:"ONE_CLICK_DEPLOY.CANCEL.HOST"}},2248:function(e,t,n){e.exports={introduction:"introduction-1sa",header:"header-1C9",explanation:"explanation-2TF","explanation-extra":"explanation-extra-22o",explanationExtra:"explanation-extra-22o","start-now":"start-now-2LT",startNow:"start-now-2LT",suggestion:"suggestion-3B1","suggestion-title":"suggestion-title-3yR",suggestionTitle:"suggestion-title-3yR","suggestion-items":"suggestion-items-1TB",suggestionItems:"suggestion-items-1TB","suggestion-item":"suggestion-item-20v",suggestionItem:"suggestion-item-20v","suggestion-icon":"suggestion-icon-2pF",suggestionIcon:"suggestion-icon-2pF","suggestion-desc":"suggestion-desc-1cA",suggestionDesc:"suggestion-desc-1cA",checkbox:"checkbox-29-"}},3269:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=C(n(0)),o=n(2),i=C(o),l=C(n(8)),u=C(n(545)),s=C(n(1453)),c=n(112),f=n(226),d=C(n(3270)),p=n(3314),m=C(n(1947)),h=C(n(698)),y=C(n(76)),v=n(106),E=n(1459),b=n(1462),g=C(n(3320)),w=C(n(3331)),_=C(n(3333)),P=C(n(3334)),O=C(n(3337)),k=C(n(3338)),T=C(n(3339)),S=C(n(3341)),N=C(n(1555));function C(e){return e&&e.__esModule?e:{default:e}}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=s.default.Item,F=f.routerActions.push,A=f.routerActions.replace,R=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.isEmptyList=function(){var e=a.props,t=e.files.result,n=void 0===t?[]:t,r=e.newFolder;return 0===n.length&&!r},a.onFileExplorerHide=function(){a.props.setFileMoving(!1)},a.onShareModalHide=function(){a.props.setShareModal(!1)},a.onShareFile=function(){var e=a.props.projectId,t=a.props.currentShareFile.fileId;a.props.shareFile(e,t)},a.onStopShareFile=function(){var e=a.props.currentShareFile.fileId,t=a.props.files.entities.shares[e];t&&a.props.stopShareFile(t.hash,e)},a.state={loading:!0,isViewerFromList:!1},a.onBeforeUpload=a.onBeforeUpload.bind(a),a.onFilesDrop=a.onFilesDrop.bind(a),a.onFileViewerHide=a.onFileViewerHide.bind(a),a.onOpenPreview=a.onOpenPreview.bind(a),a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.folderId,n=e.isShareFolder;this.fetchData(t,!0,n)}},{key:"componentWillUnmount",value:function(){this.unmounted=!0,window.removeEventListener("beforeunload",this.beforeunload)}},{key:"setupEventListenerOfBeforeUnload",value:function(){this.props.hasFilesUploading?window.addEventListener("beforeunload",this.beforeunload):window.removeEventListener("beforeunload",this.beforeunload)}},{key:"beforeunload",value:function(e){return(e||window.event).returnValue="\u60a8\u786e\u5b9a\u8981\u79bb\u5f00\u6b64\u9875\u9762\u5417\uff1f","\u60a8\u786e\u5b9a\u8981\u79bb\u5f00\u6b64\u9875\u9762\u5417\uff1f"}},{key:"fetchData",value:function(e,t,n){var a=this;this.setState({loading:!0}),this.props.getFolderPaths(e);var r=this.props.previewFileId;return new Promise(function(o){a.props.getProjectFiles(e,n).then(function(){t&&!isNaN(r)&&a.props.previewFile(r)}).then(o).finally(function(){a.unmounted||a.setState({loading:!1})})})}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.folderId,a=e.previewFileId,r=e.isShareFolder,o=this.props,i=o.isShareFolder,l=o.illegalFolderId,u=o.folderId,s=o.projectPath,f=o.previewFileId,d=o.previewing;if(!i&&l)return(0,c.danger)("\u6587\u4ef6\u5939\u4e0d\u5b58\u5728"),void this.props.replace(s+"/attachment");var p=Promise.resolve();u===n&&i===r||(p=this.fetchData(n,a,r)),p.then(function(){if(isNaN(a)&&!isNaN(f))t.props.quitFilePreview();else{var e=!isNaN(f)&&!isNaN(a)&&f!==a,n=!isNaN(a)&&!d;(e||n)&&t.props.previewFile(a)}})}},{key:"onOpenPreview",value:function(){this.setState({isViewerFromList:!0})}},{key:"renderFile",value:function(e,t){var n=this.props.files.entities,a=n.files,r=n.users,o=n.shares,l=this.props.isShareFolder,u=a[e],s=r[u.owner],c=o&&u.share?o[u.share]:null;return u.duplicate?null:i.default.createElement(j,{key:t},i.default.createElement(g.default,{file:u,owner:s,share:c,isShareFolder:l,onOpenPreview:this.onOpenPreview}))}},{key:"renderNewFolder",value:function(){return this.props.newFolder?i.default.createElement(j,{key:"newFolder"},i.default.createElement(k.default,null)):null}},{key:"renderList",value:function(){var e=this.props,t=e.files.result,n=void 0===t?[]:t,a=e.filterKey,r=e.folderId;return this.isEmptyList()?i.default.createElement("div",null,i.default.createElement(P.default,{hasFilter:0!==a.length,isFolder:r>0})):i.default.createElement("div",null,i.default.createElement("div",{className:"file-list"},i.default.createElement(s.default,{className:N.default.fileList,type:"block",blockItemPadding:"20",hover:!0,bordered:!0,empty:""},this.renderNewFolder(),n.map(this.renderFile,this))))}},{key:"onFilesDrop",value:function(e){0!==e.length&&this.props.uploadFiles(e).then(function(){(0,c.success)("\u4e0a\u4f20 "+e.length+" \u4e2a\u6587\u4ef6\u6210\u529f")})}},{key:"onBeforeUpload",value:function(){this.dropzone.open()}},{key:"onFileViewerHide",value:function(){var e=this,t=this.props,n=t.previewFileId,a=t.projectPath,r=t.folderId,o=t.isShareFolder,i=this.state.isViewerFromList;this.setState({showFileViewer:!1},function(){var t=void 0;if(t=o?"share":r||"default",!isNaN(n)){var l=a+"/attachment/"+t;i?e.props.router.goBack():e.props.push(l)}})}},{key:"renderStickyHeader",value:function(){var e,t=this.isEmptyList(),n=this.props.sideMenu,a=(0,l.default)(N.default.fileHeader,(I(e={sticky:!t},N.default.expanded,n.expanded),I(e,N.default.collapsed,!n.expanded),e));return i.default.createElement(p.Sticky,{ref:function(e){e&&e.state&&e.state.height<115&&e.setState({height:115})},stickyClassName:a,topOffset:-90},this.renderHeaderTop(),!t&&i.default.createElement(w.default,null))}},{key:"renderHeaderTop",value:function(){var e=this.props,t=e.folderId,n=e.projectPath,a=e.isShareFolder;return[i.default.createElement(O.default,{key:"file-top-menu",projectPath:n,folderId:t,isShareFolder:a,onBeforeUpload:this.onBeforeUpload}),i.default.createElement(_.default,{key:"file-stats"})]}},{key:"render",value:function(){var e=this,t=this.state.loading,n=this.props,a=n.previewing,r=n.moving,o=n.showShareModal,u=n.currentShareFile,s=n.isShareFolder,c=this.props.files.entities.shares,f=(void 0===c?{}:c)[u.id],E=!(0,y.default)(f);return this.setupEventListenerOfBeforeUnload(),i.default.createElement("div",{className:N.default.fileListContainer},i.default.createElement(T.default,{multiple:!0,onDrop:this.onFilesDrop,ref:function(t){t&&(e.dropzone=t.dropdown)}},i.default.createElement(p.StickyContainer,{className:(0,l.default)(I({},N.default.fileSticky,!t))},this.renderStickyHeader(),!t&&this.renderList()),i.default.createElement(h.default,{show:t})),i.default.createElement(d.default,{show:a,onHide:this.onFileViewerHide}),i.default.createElement(S.default,{show:r,onHide:this.onFileExplorerHide,isShareFolder:s}),i.default.createElement(m.default,{show:o,onHide:this.onShareModalHide,sharing:E,url:E?f.url:"",targetName:u.name,onShare:this.onShareFile,onStopShare:this.onStopShareFile,type:v.RESOURCE_TYPE.FILE}))}}]),t}();R.propTypes={router:r.default.object.isRequired,files:E.normalizedFilesTypes,filterKey:r.default.string,getProjectFiles:r.default.func.isRequired,uploadFiles:r.default.func.isRequired,getFolderPaths:r.default.func.isRequired,quitFilePreview:r.default.func.isRequired,newFolder:r.default.bool.isRequired,folderId:r.default.number.isRequired,illegalFolderId:r.default.bool.isRequired,isShareFolder:r.default.bool.isRequired,previewFileId:r.default.number,previewing:r.default.bool.isRequired,previewFile:r.default.func.isRequired,push:r.default.func.isRequired,replace:r.default.func.isRequired,projectPath:r.default.string,setFileMoving:r.default.func.isRequired,moving:r.default.bool,projectId:r.default.number.isRequired,showShareModal:r.default.bool.isRequired,setShareModal:r.default.func.isRequired,currentShareFile:r.default.object.isRequired,shareFile:r.default.func.isRequired,stopShareFile:r.default.func.isRequired,sideMenu:r.default.shape({expanded:r.default.bool}).isRequired,hasFilesUploading:r.default.bool},R.defaultProps={files:[],newFolder:!1},t.default=(0,u.default)(function(e,t){var n=e.PROJECT.file,a=n.files,r=n.filterKey,o=n.newFolder,i=n.previewing,l=n.moving,u=n.showShareModal,s=n.currentShareFile,c=n.upload.uploadFiles,f=void 0===c?[]:c,d=e.APP,p=d.projectPath,m=d.currentProject.id,h=e.LAYOUT.sideMenu,y=t.routeParams,v=y.folderId,E=void 0===v?0:v,b=y.previewFileId;return{files:a,filterKey:r,newFolder:o,previewing:i,folderId:"default"===E||isNaN(E)?0:parseInt(E,10),illegalFolderId:"default"!==E&&isNaN(E),isShareFolder:"share"===E,previewFileId:parseInt(b,10),projectPath:p,moving:l,showShareModal:u,currentShareFile:s,projectId:m,sideMenu:h,hasFilesUploading:Object.keys(f).length>0}},{getProjectFiles:b.getProjectFiles,uploadFiles:b.uploadFiles,getFolderPaths:b.getFolderPaths,quitFilePreview:b.quitFilePreview,previewFile:b.previewFile,push:F,replace:A,setFileMoving:b.setFileMoving,setShareModal:b.setShareModal,shareFile:b.shareFile,stopShareFile:b.stopShareFile})(R)},3270:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=y(n(0)),o=n(2),i=y(o),l=y(n(549)),u=y(n(545)),s=n(1462),c=n(112),f=y(n(3271)),d=y(n(3302)),p=y(n(3304)),m=n(1459),h=n(1542);function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var E=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return n=a=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.handleClose=function(){a.props.onHide()},a.handleNameChange=function(e,t){return a.props.renameFile(e,t).then(function(){(0,c.success)('\u91cd\u547d\u540d "'+e+'" \u6210\u529f'),a.props.updatePreviewFile(t)})},a.renderBody=function(){var e=a.props.preview;return e.editing?i.default.createElement(d.default,{preview:e}):i.default.createElement(f.default,{preview:e,onClose:a.handleClose,onRename:a.handleRename,onNameChange:a.handleNameChange})},v(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"render",value:function(){var e=this.props,t=e.show,n=e.onHide,a=e.preview.current;return i.default.createElement(l.default,{tabIndex:!1,show:t,className:h.fileViewer,onHide:n,onEscapeKeyUp:n},this.renderBody(),i.default.createElement(p.default,{file:a,onClose:this.handleClose}))}}]),t}();E.propTypes={show:r.default.bool.isRequired,onHide:r.default.func.isRequired,preview:m.previewPropTypes.isRequired,renameFile:r.default.func.isRequired,updatePreviewFile:r.default.func.isRequired},E.defaultProps={show:!0,onHide:function(){}},t.default=(0,u.default)(function(e){return{preview:e.PROJECT.file.preview}},{renameFile:s.renameFile,updatePreviewFile:s.updatePreviewFile})(E)},3271:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=p(n(0)),o=n(2),i=p(o),l=n(1459),u=p(n(3277)),s=p(n(2203)),c=n(1462),f=p(n(545)),d=n(1542);function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var h=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return n=a=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.onRenameDone=function(){return a.props.renamePreviewFile(!1)},a.onRenameCancel=function(){a.onRenameDone()},a.handleRename=function(){a.props.renamePreviewFile(!0)},a.renderName=function(e){if(a.props.preview.renaming)return i.default.createElement(s.default,{onConfirm:a.props.onNameChange,onSaved:a.onRenameDone,onCancel:a.onRenameCancel,file:e,useButton:!0,block:!0,ref:function(e){e&&e.input.select()}});var t=e.remark||e.name;return i.default.createElement("span",{title:t,onDoubleClick:a.handleRename},t)},m(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"render",value:function(){var e=this.props.preview,t=e.current;return i.default.createElement("div",{className:d.viewerBody},i.default.createElement("div",{className:d.viewerFileName},this.renderName(t)),i.default.createElement("div",{className:d.viewerFileContent},i.default.createElement(u.default,{preview:e})))}}]),t}();h.propTypes={preview:l.previewPropTypes.isRequired,onNameChange:r.default.func.isRequired,renamePreviewFile:r.default.func.isRequired},h.defaultProps={onNameChange:function(){}},t.default=(0,f.default)(null,{renamePreviewFile:c.renamePreviewFile})(h)},3277:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=N(n(0)),o=n(2),i=N(o),l=n(168),u=N(n(8)),s=N(n(2189)),c=N(n(1784)),f=N(n(1623)),d=N(n(545)),p=N(n(1785)),m=n(1459),h=n(1944),y=n(1479),v=n(1462),E=n(226),b=n(1573),g=N(n(1692)),w=N(n(3280)),_=N(n(3281)),P=N(n(3283)),O=N(n(3284)),k=N(n(3298)),T=N(n(3299)),S=N(n(3300));function N(e){return e&&e.__esModule?e:{default:e}}function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var I=E.routerActions.push,j=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=C(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.handlePreview=function(e){if(!e)return function(){};var t=e.fileId,n=e.parentId,r=a.props.projectPath;return function(){var e=r+"/attachment/"+(n||"default")+"/preview/"+t;a.props.router.replace(e)}},C(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"componentDidMount",value:function(){var e=this.props.location.query.v,t=this.props.preview.current.fileId;e&&this.props.getFileContent(t,e)}},{key:"componentWillReceiveProps",value:function(e){var t=e.location.query.v,n=this.props.preview.current.fileId;t&&t!==this.props.location.query.v&&this.props.getFileContent(n,t)}},{key:"renderSwitcher",value:function(){var e=this.props.preview,t=e.previous,n=e.next,a=e.renaming,r=e.editing,o=e.current;if(!((t||n)&&!(a||r)))return null;var l=i.default.createElement(w.default,{onPreview:this.handlePreview(t),onNext:this.handlePreview(n),key:"preview-navigator"});return y.TYPE.IMAGE!==o.type?l:[t?i.default.createElement(p.default,{placement:"right",title:t.name,key:"preview-btn"},i.default.createElement("div",{className:b.previousButton,onClick:this.handlePreview(t)},i.default.createElement(s.default,null))):null,n?i.default.createElement(p.default,{placement:"left",title:n.name,key:"next-btn"},i.default.createElement("div",{className:b.nextButton,onClick:this.handlePreview(n)},i.default.createElement(c.default,null))):null,l]}},{key:"renderDownloadIcon",value:function(){var e,t,n,a=this.props,r=a.preview.current,o=a.projectId,l=r.fileId,s=r.fileType,c=s.length,d=c>10?10:c,p=(0,u.default)((n=d,(t="file-type-size-"+d)in(e={})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e)),m=this.props.location.query.v,h=m?"/api/project/"+o+"/files/histories/"+m+"/download":"/api/project/"+o+"/files/"+l+"/download";return i.default.createElement("div",{className:b.filePreview},i.default.createElement("a",{href:h,target:"_blank"},i.default.createElement("div",{className:b.previewDownload},i.default.createElement("h3",{className:p,title:s},s),i.default.createElement(f.default,null))))}},{key:"renderFolder",value:function(){return i.default.createElement("div",{className:b.filePreview},i.default.createElement("img",{width:"200",src:g.default,alt:"folder"}))}},{key:"renderPreview",value:function(){var e=this.props.preview.current,t=e.type;return y.TYPE.FOLDER===t?this.renderFolder():t?(0,h.isOfficeFile)(e.fileType)?i.default.createElement(P.default,{file:e}):(0,h.isPdfFile)(e.fileType)?i.default.createElement(O.default,{file:e}):(0,h.isMarkdownFile)(e.fileType)?i.default.createElement(k.default,{file:e}):(0,h.isSupportedVideoFile)(e.fileType)?i.default.createElement(S.default,{file:e}):y.TYPE.IMAGE===t?i.default.createElement(_.default,{file:e}):y.TYPE.TEXT===t||(0,h.isCsvFile)(e.fileType)?i.default.createElement(T.default,{file:e}):this.renderDownloadIcon():null}},{key:"render",value:function(){return i.default.createElement("div",{className:b.filePreviewWrapper},this.renderPreview(),this.renderSwitcher())}}]),t}();j.propTypes={router:r.default.object.isRequired,preview:m.previewPropTypes.isRequired,push:r.default.func.isRequired,projectId:r.default.number,projectPath:r.default.string,location:r.default.object.isRequired,getFileContent:r.default.func.isRequired},j.defaultProps={},t.default=(0,d.default)(function(e){var t=e.APP;return{projectId:t.currentProject.id,projectPath:t.projectPath}},{push:I,getFileContent:v.getFileContent})((0,l.withRouter)(j))},3280:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),i=(a=o)&&a.__esModule?a:{default:a},l=n(2);var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.handleKeydown=a.handleKeydown.bind(a),a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),r(t,[{key:"handleKeydown",value:function(e){var t=e.key,n=e.keyIdentifier;switch(t||n){case"ArrowRight":case"ArrowDown":case"Right":case"Down":return this.props.onNext();case"ArrowLeft":case"ArrowUp":case"Left":case"Up":return this.props.onPreview();default:return!0}}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeydown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeydown)}},{key:"render",value:function(){return null}}]),t}();u.propTypes={onPreview:i.default.func.isRequired,onNext:i.default.func.isRequired},t.default=u},3281:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=y(i),u=n(168),s=n(1459),c=y(n(1785)),f=y(n(545)),d=y(n(1574)),p=n(1573),m=n(1462),h=n(718);function y(e){return e&&e.__esModule?e:{default:e}}var v=(r=a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state={refreshToken:"",url:"",ownerPreview:"",width:0,height:0,stageHeight:0,stageWidth:0},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"renderAdjustedImage",value:function(){var e=this.props.file.name,t=this.state.url,n=this.state,a=n.refreshToken,r=n.width,o=n.height,i=n.stageHeight,u=n.stageWidth,s=(0,h.updateUrlParameter)(t,"_t_",a),c={};return o>r&&(c.maxHeight=Math.min(o,i)-80),o<=r&&r>u&&(c.maxWidth=Math.min(r,u)-90),l.default.createElement("img",{src:s,alt:e,style:c})}},{key:"renderImage",value:function(){var e=this.state.ownerPreview;return l.default.createElement("div",{className:p.filePreviewImage,id:p.filePreviewImage+"-id"},l.default.createElement(c.default,{title:"\u70b9\u51fb\u67e5\u770b\u539f\u56fe",placement:"bottom"},l.default.createElement("a",{href:e,target:"_blank"},this.renderAdjustedImage())))}},{key:"processImage",value:function(e,t,n,a){var r=this,o="preview-image-id-"+n,i=this,l=(0,h.updateUrlParameter)(e,"_t_",a);return new Promise(function(e,t){if("undefined"!==typeof document){var n=document.createElement("img");n.id=o,n.onload=function(){i.setState({width:n.width,height:n.height,stageHeight:window.innerHeight-60,stageWidth:window.innerWidth-360},e)},n.onerror=t,n.src=l,n.style.display="none",document.querySelector("body").appendChild(n)}}).then(function(){if(r.setState({refreshToken:a,url:e,ownerPreview:t}),"undefined"!==typeof document){var n=document.querySelector("#"+o);document.querySelector("body").removeChild(n)}})}},{key:"fetchImage",value:function(e,t){var n=this,a=this.props.location.query.v;if(a)return this.props.getFileContent(e,a).then(function(e){return e.file}).then(function(a){return n.processImage(a.preview,a.owner_preview,e,t)});var r=this.props.file;return this.processImage(r.url,r.ownerPreview,e,t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.file.fileId,a=t.location.query;return l.default.createElement(d.default,{className:p.filePreview,fileId:n,version:a.v,fileTypeName:"\u56fe\u7247",fetchPromise:function(t,n){return e.fetchImage(t,n)}},this.renderImage())}}]),t}(),a.propTypes={location:i.PropTypes.object.isRequired,file:i.PropTypes.object.isRequired,getFileContent:i.PropTypes.func.isRequired},r);v.propTypes={file:s.filePropTypes.isRequired},t.default=(0,f.default)(null,{getFileContent:m.getFileContent})((0,u.withRouter)(v))},3283:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=p(n(0)),o=n(2),i=p(o),l=n(168),u=n(1459),s=n(1462),c=p(n(545)),f=n(1573),d=p(n(1574));function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state={downloadUrl:""},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"fetchDownloadUrl",value:function(e){var t=this,n=this.props.location.query.v;return(n?this.props.getFileContent(e,n).then(function(){return t.props.getDownloadUrl(n)}):this.props.getDownloadUrl(e)).then(function(e){var n=e.downloadUrl;t.setState({downloadUrl:n})})}},{key:"render",value:function(){var e=this,t=this.state.downloadUrl,n=this.props,a=n.file.fileId,r=n.location.query,o="https://owas.coding.net/op/view.aspx?PdfMode=1&src="+encodeURIComponent(t);return i.default.createElement(d.default,{className:f.filePreview,fileId:a,version:r.v,fileTypeName:"Office \u6587\u4ef6",fetchPromise:function(t){return e.fetchDownloadUrl(t)}},i.default.createElement("iframe",{className:f.filePreviewOffice,src:o,frameBorder:"0"}))}}]),t}();m.propTypes={file:u.filePropTypes.isRequired,getDownloadUrl:r.default.func.isRequired,getFileContent:r.default.func.isRequired,location:r.default.object.isRequired},m.defaultProps={},t.default=(0,c.default)(null,{getDownloadUrl:s.getDownloadUrl,getFileContent:s.getFileContent})((0,l.withRouter)(m))},3284:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=v(n(0)),i=n(2),l=v(i),u=v(n(2190)),s=n(168),c=v(n(545)),f=n(1459),d=n(1462),p=n(1573),m=v(n(3296)),h=v(n(1574)),y=n(3297);function v(e){return e&&e.__esModule?e:{default:e}}n(1945);var E=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state={doc:{numPages:0},currentPageNum:1,isFullscreen:!1,currentPage:null,autoSize:{},cachedAutoSize:{}},a.navigateToPage=a.navigateToPage.bind(a),a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"renderPage",value:function(e){var t=this.state.isFullscreen?2:1.5,n=e.getViewport(t),a=this.refs.canvas,r=a.getContext("2d");a.height=n.height,a.width=n.width;var o={canvasContext:r,viewport:n};e.render(o)}},{key:"navigateToPage",value:function(e){var t=this;this.setState({currentPageNum:e}),this.state.doc.getPage(e).then(function(e){var n=(0,y.stageSize)();t.setState({currentPage:e,autoSize:n,cachedAutoSize:n}),t.renderPage(e)})}},{key:"loadPdfDocument",value:function(e){var t=this;return u.default.getDocument({url:e,withCredentials:!0}).then(function(e){t.setState({doc:e}),t.navigateToPage(1)})}},{key:"fetchFileDownloadUrl",value:function(e){var t=this,n=this.props.projectApiPrefix,a=this.props.location.query.v;if(a)return this.props.getFileContent(e,a).then(function(e){return e.file}).then(function(e){var a=n+"/files/"+e.fileId+"/pdf-stream";return t.loadPdfDocument(a)});var r=n+"/files/"+e+"/pdf-stream";return this.loadPdfDocument(r)}},{key:"render",value:function(){var e=this,t=this.state,n=t.autoSize,r=t.cachedAutoSize,o=t.doc,i=t.currentPageNum,u=this.props,s=u.file.fileId,c=u.location.query;return l.default.createElement(h.default,{className:p.filePreview,fileId:s,version:c.v,fileTypeName:"PDF \u6587\u4ef6",fetchPromise:function(t){return e.fetchFileDownloadUrl(t)},invisible:!0},l.default.createElement("div",{className:p.filePreviewPdf,ref:"pdfStage",style:a({},n)},l.default.createElement("canvas",{ref:"canvas"}),l.default.createElement(m.default,{currentPage:i,totalPage:o.numPages,onPageChange:this.navigateToPage,getFullscreen:function(){return e.refs.pdfStage},onFullscreenChange:function(t){e.setState({isFullscreen:t,autoSize:t?{}:r},function(){var t=e.state.currentPage;e.renderPage(t)})}})))}}]),t}();E.propTypes={file:f.filePropTypes,projectApiPrefix:o.default.string,location:o.default.object.isRequired,getFileContent:o.default.func.isRequired},t.default=(0,c.default)(function(e){return{projectApiPrefix:e.APP.projectApiPrefix}},{getFileContent:d.getFileContent})((0,s.withRouter)(E))},3296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=p(n(0)),o=n(2),i=p(o),l=p(n(2198)),u=p(n(2199)),s=p(n(1788)),c=p(n(2200)),f=p(n(2201)),d=n(1573);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state={isFullscreen:!1},a.handleFullscreenChange=a.handleFullscreenChange.bind(a),a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"handleFullscreenChange",value:function(){var e=this;this.setState({isFullscreen:l.default.isFullscreen},function(){e.props.onFullscreenChange(e.state.isFullscreen)})}},{key:"componentDidMount",value:function(){l.default.enabled&&document.addEventListener(l.default.raw.fullscreenchange,this.handleFullscreenChange)}},{key:"componentWillUnmount",value:function(){l.default.enabled&&document.removeEventListener(l.default.raw.fullscreenchange,this.handleFullscreenChange)}},{key:"renderFullscreen",value:function(){return this.state.isFullscreen?[i.default.createElement(f.default,{key:"exit-fullscreen"}),"\u9000\u51fa\u5168\u5c4f"]:[i.default.createElement(c.default,{key:"fullscreen"}),"\u5168\u5c4f"]}},{key:"render",value:function(){var e=this.props,t=e.currentPage,n=e.totalPage,a=e.onPageChange,r=e.getFullscreen,o=t+"/"+n;return i.default.createElement("div",{className:d.fileInnerNavigator},i.default.createElement("div",{className:"numbers"},i.default.createElement(u.default,{onClick:function(){return a(Math.max(t-1,1))}}),i.default.createElement("em",null,o),i.default.createElement(s.default,{onClick:function(){return a(Math.min(t+1,n))}})),i.default.createElement("div",{className:"fullscreen",onClick:function(){return l.default.toggle(r())}},this.renderFullscreen()))}}]),t}();m.propTypes={currentPage:r.default.number.isRequired,totalPage:r.default.number.isRequired,onPageChange:r.default.func,getFullscreen:r.default.func,onFullscreenChange:r.default.func},m.defaultProps={onFullscreenChange:function(){}},t.default=m},3297:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stageSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:360,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;if("undefined"!==typeof window){var n=window,a=n.innerHeight,r=void 0===a?0:a,o=n.innerWidth,i=void 0===o?0:o;return{width:i-e,height:r-t}}return{width:0,height:0}},t.stageFitSize=function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:80,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:90,i=a-r,l=n-o;t>e&&(i=Math.min(t,a)-r);t<=e&&e>n&&(l=Math.min(e,n)-o);return{maxWidth:l,maxHeight:i}}},3298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=m(n(0)),o=n(2),i=m(o),l=m(n(1460)),u=n(168),s=m(n(545)),c=n(1462),f=n(1459),d=m(n(1574)),p=n(1573);function m(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state={html:null},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"fetchMarkdownPreview",value:function(e){var t=this,n=this.props.location.query.v;return(n?this.props.getMarkdownPreviewByVersion(e,n).then(function(e){return e.data}):this.props.getMarkdownPreview(e)).then(function(e){t.setState({html:e})})}},{key:"render",value:function(){var e=this,t=this.state.html,n=this.props,a=n.file.fileId,r=n.location.query;return i.default.createElement(d.default,{className:p.filePreview,fileId:a,version:r.v,fetchPromise:function(t){return e.fetchMarkdownPreview(t)},fileTypeName:"Markdown \u6587\u4ef6"},i.default.createElement("div",{className:p.filePreviewMarkdown},i.default.createElement(l.default,{html:t})))}}]),t}();h.propTypes={file:f.filePropTypes,getMarkdownPreview:r.default.func.isRequired,getMarkdownPreviewByVersion:r.default.func.isRequired,location:r.default.object.isRequired},t.default=(0,s.default)(null,{getMarkdownPreview:c.getMarkdownPreview,getMarkdownPreviewByVersion:c.getMarkdownPreviewByVersion})((0,u.withRouter)(h))},3299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=p(n(0)),o=n(2),i=p(o),l=n(168),u=p(n(545)),s=n(1462),c=n(1459),f=p(n(1574)),d=n(1573);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state={content:null},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"fetchTextFileContent",value:function(e,t){var n=this,a=this.props.location.query.v,r=a?this.props.getFileContent(e,a):this.props.viewFile(e);return a&&"csv"===t.fileType&&(r=r.then(function(){return(0,s.viewFile)(e)})),r.then(function(e){var t=e.content;n.setState({content:t})})}},{key:"render",value:function(){var e=this,t=this.state.content,n=this.props,a=n.file,r=n.file.fileId,o=n.location.query;return i.default.createElement(f.default,{className:d.filePreview,fileId:r,version:o.v,fetchPromise:function(t){return e.fetchTextFileContent(t,a)},fileTypeName:"\u6587\u672c\u6587\u4ef6"},i.default.createElement("div",{className:d.filePreviewText},i.default.createElement("pre",null,t)))}}]),t}();m.propTypes={file:c.filePropTypes,viewFile:r.default.func.isRequired,location:r.default.object.isRequired,getFileContent:r.default.func.isRequired},t.default=(0,u.default)(null,{viewFile:s.viewFile,getFileContent:s.getFileContent})((0,l.withRouter)(m))},3300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=d(n(0)),o=n(2),i=d(o),l=n(168),u=d(n(545)),s=n(1459),c=d(n(1574)),f=n(1573);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var m=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return n=a=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.renderVideoPlayer=function(){return i.default.createElement("video",{src:a.props.file.url,height:"90%",controls:!0,preload:"auto"})},p(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"render",value:function(){var e=this.props,t=e.file.fileId,n=e.location.query;return i.default.createElement(c.default,{className:f.filePreview,fileId:t,version:n.v,fetchPromise:function(){return Promise.resolve()},fileTypeName:"\u89c6\u9891\u6587\u4ef6"},this.renderVideoPlayer())}}]),t}();m.propTypes={file:s.filePropTypes,location:r.default.object.isRequired},t.default=(0,u.default)(null,{})((0,l.withRouter)(m))},3302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=_(n(0)),l=n(2),u=_(l),s=n(715),c=n(114),f=_(n(76)),d=_(n(544)),p=n(112),m=n(1459),h=n(1462),y=n(1506),v=_(n(3303)),E=n(266),b=n(1542),g=_(n(2204)),w=_(n(2205));function _(e){return e&&e.__esModule?e:{default:e}}function P(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var O=(0,E.withAsyncMarkEditor)()(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),l=0;l<o;l++)i[l]=arguments[l];return n=a=P(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),a.fetchFile=function(e){a.props.viewFile(e).then(function(){var e=a.props.preview.viewFile.content;a.editor&&a.editor.onFetch(e)})},a.handleEditCancel=function(){a.props.editPreviewFile(!1),a.editor&&a.editor.onCancel()},a.renderEditorHeader=function(){return u.default.createElement("div",{className:b.editorHeader},u.default.createElement("div",{className:b.nameInput},a.renderNameInput({borderless:!0,size:"medium",block:!0})),u.default.createElement("div",{className:b.buttons},a.renderButtons()))},a.renderEditor=function(){var e=a.props,t=e.fields.content,n=e.projectId,o=e.projectName,i=e.projectOwner,l=e.preview.current,s=l.fileId;if("md"===l.fileType){var c="PROJECT_"+n+"_FILE_"+s+"_EDIT";return u.default.createElement(g.default,r({ref:function(e){return a.editor=e&&e.hocEditor},className:b.viewerEditor,projectId:n,projectName:o,projectOwner:i,mentionParams:{context_type:"project_member",item_id:n},header:a.renderEditorHeader(),autoSaveKey:c},t,{createWithContent:a.props.createWithContent,getPlainText:a.props.getPlainText,MediumMarkEditor:a.props.MediumMarkEditor}))}return u.default.createElement(w.default,r({className:b.viewerEditor,autoFocus:!0},t))},a.renderButtons=function(){var e=a.props,t=e.submitting,n=e.invalid,r=e.pristine;return[u.default.createElement(d.default,{title:"\u4fdd\u5b58",key:"save",htmlType:"submit",loading:t,disabled:r||t||n,style:{margin:"0 10px 0 15px"}},"\u4fdd\u5b58"),u.default.createElement(d.default,{title:"\u53d6\u6d88",onClick:a.handleEditCancel,key:"cancel",disabled:t,empty:!0},"\u53d6\u6d88")]},a.onSubmit=function(e){var t=e.fileName,n=e.ext,r=e.content,o=e.fileId,i=""+t+n;return a.props.editFile(o,i,r).then(function(){a.editor&&a.editor.onSave()}).then(function(){(0,p.success)("\u6587\u4ef6 "+i+" \u66f4\u65b0\u6210\u529f"),a.props.editPreviewFile(!1)})},P(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"componentDidMount",value:function(){var e=this.props.preview.current.fileId;this.fetchFile(e)}},{key:"componentWillReceiveProps",value:function(e){var t=e.preview.current;this.props.preview.current.fileId!==t.fileId&&this.fetchFile(t.fileId)}},{key:"renderNameInput",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{borderless:!1},t=this.props.fields,n=t.fileName,a=t.ext;return u.default.createElement("div",{className:b.viewerFileNameInput},u.default.createElement(v.default,r({},(0,y.input)(n),e,{ext:a.value,placeholder:"\u6587\u4ef6\u540d",block:!0})))}},{key:"render",value:function(){var e=this.props.handleSubmit;return u.default.createElement("form",{className:b.viewerBody,onSubmit:e(this.onSubmit)},u.default.createElement("div",{className:b.viewerFileName},this.renderNameInput(),u.default.createElement("div",{className:b.viewerFormButtons},this.renderButtons())),u.default.createElement("div",{className:b.viewerFileContent},u.default.createElement("div",{className:b.viewerEditorWrapper},this.renderEditor())))}}]),t}())||a;O.propTypes=r({projectId:i.default.number,projectName:i.default.string,projectOwner:i.default.string,preview:m.previewPropTypes.isRequired,editPreviewFile:i.default.func.isRequired,viewFile:i.default.func.isRequired,editFile:i.default.func.isRequired,MediumMarkEditor:i.default.func,getPlainText:i.default.func,createWithContent:i.default.func},s.propTypes),t.default=(0,s.reduxForm)({fields:["fileName","ext","content","fileId"],validate:function(e){var t=e.fileName,n=e.content,a=e.fileId,r={};return isNaN(a)&&(r.fileId="\u7f16\u8f91\u7684\u6587\u4ef6\u4e0d\u5b58\u5728"),(0,f.default)(t)&&(r.fileName="\u6587\u4ef6\u540d\u4e0d\u80fd\u4e3a\u7a7a"),(0,f.default)(n)&&(r.content="\u6587\u4ef6\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"),r},form:"PreviewFileEditForm",touchOnBlur:!1},function(e,t){var n=e.APP.currentProject,a=n.id,o=n.name,i=n.owner_user_name,l=t.preview,u=l.current,s=u.fileId,c=u.name,f=u.fileType,d=l.viewFile.content,p=r({fileId:s},v.default.splitName(c));return"md"!==f&&(p=r({},p,{content:d})),{projectName:o,projectOwner:i,projectId:a,initialValues:p}},function(e){return{editPreviewFile:(0,c.bindActionCreators)(h.editPreviewFile,e),viewFile:(0,c.bindActionCreators)(h.viewFile,e),editFile:(0,c.bindActionCreators)(h.editFile,e)}})(O)},3303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=p(n(0)),i=n(2),l=p(i),u=p(n(8)),s=p(n(1946)),c=p(n(261)),f=p(n(1657)),d=n(1786);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"render",value:function(){var e=(0,f.default)(this.props,["className","ext"]),t=e.left,n=e.right,r=(0,u.default)(t.className,d.fileSuffixName);return l.default.createElement(c.default,a({icon:l.default.createElement("em",null,t.ext),className:r},n))}}],[{key:"splitName",value:function(e){var t=s.default.extname(e);return{fileName:e.replace(t,""),ext:t}}}]),t}();m.propTypes={value:o.default.string,ext:o.default.string},t.default=m},3304:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=p(n(0)),o=n(2),i=p(o),l=n(1459),u=p(n(547)),s=p(n(1785)),c=n(1542),f=p(n(3305)),d=p(n(3313));function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"render",value:function(){var e=this.props,t=e.file,n=e.onClose;return i.default.createElement("div",{className:c.viewerMenu},i.default.createElement("div",{className:c.viewerToolbar},i.default.createElement(d.default,{file:t,toolTipPosition:"bottom"}),i.default.createElement("div",{className:c.previewClose},i.default.createElement(s.default,{title:"\u5173\u95ed\u9884\u89c8",placement:"bottom"},i.default.createElement(u.default,{onClick:n})))),i.default.createElement("div",{className:c.viewerTabs},i.default.createElement(f.default,null)))}}]),t}();m.propTypes={file:l.filePropTypes,onClose:r.default.func.isRequired},t.default=m},3305:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=m(n(0)),o=n(2),i=m(o),l=m(n(1467)),u=m(n(545)),s=n(1462),c=n(1542),f=m(n(3306)),d=m(n(3310)),p=m(n(3312));function m(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var y=[{key:"activity",child:i.default.createElement(f.default,null),tab:"\u52a8\u6001"},{key:"history",child:i.default.createElement(d.default,null),tab:"\u6587\u4ef6\u5386\u53f2"},{key:"summary",child:i.default.createElement(p.default,null),tab:"\u6587\u4ef6\u8be6\u60c5"}],v=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=h(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.handleTabClick=function(e){a.props.changePreviewActivityTabKey(e)},h(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"render",value:function(){return i.default.createElement("div",{className:c.viewerTabs},i.default.createElement(l.default,{activeKey:this.props.activeTabKey,onTabClick:this.handleTabClick,tabs:y,plain:!0}))}}]),t}();v.propTypes={activeTabKey:r.default.string.isRequired,changePreviewActivityTabKey:r.default.func.isRequired},v.defaultProps={activeTabKey:"activity"},t.default=(0,u.default)(function(e){return{activeTabKey:e.PROJECT.file.preview.activeTabKey}},{changePreviewActivityTabKey:s.changePreviewActivityTabKey})(v)},3306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=m(n(0)),o=n(2),i=m(o),l=m(n(545)),u=n(1462),s=n(1459),c=n(1789),f=m(n(3307)),d=n(1542),p=m(n(1574));function m(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"fetchActivities",value:function(e){return e?this.props.getFileActivity(e):null}},{key:"renderActivity",value:function(e,t,n){var a=n.users,r=n.files,o=a[t.user],l=r[t.file],u=t.key,s=t.targetType;switch(e){case"ProjectFiles":return i.default.createElement(f.default,{activity:t,user:o,file:l,key:u});default:return i.default.createElement("div",{key:u},"\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u52a8\u6001\u7c7b\u578b: ",s)}}},{key:"renderActivities",value:function(){var e=this,t=this.props.activities,n=t.result,a=t.entities;return 0===n.length?"\u6ca1\u6709\u4efb\u4f55\u6587\u4ef6\u52a8\u6001":n.map(function(t){var n=t.id,r=t.schema,o=a[r][n];return e.renderActivity(r,o,a)},this)}},{key:"render",value:function(){var e=this,t=this.props.file.fileId;return t?i.default.createElement(p.default,{className:d.tabContent,loadingPosition:"top",fileTypeName:"\u6587\u4ef6\u52a8\u6001",fileId:t,fetchPromise:function(t){return e.fetchActivities(t)}},this.renderActivities()):null}}]),t}();h.propTypes={getFileActivity:r.default.func.isRequired,file:s.filePropTypes,activities:c.normalizedActivityTypes},t.default=(0,l.default)(function(e){var t=e.PROJECT.file;return{activities:t.activities,file:t.preview.current}},{getFileActivity:u.getFileActivity})(h)},3307:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(2),o=c(r),i=n(168),l=c(n(262)),u=n(1789),s=n(3308);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),a(t,[{key:"isHistory",value:function(e){return e.indexOf("history")>=0}},{key:"isFolder",value:function(e){return e.indexOf("dir")>=0}},{key:"actionToFileType",value:function(e){return"rename"===e?"\u4fee\u6539\u4e86\u6587\u4ef6\u540d\u79f0":"share_file"===e||"stop_share_file"===e?"":this.isFolder(e)?"\u6587\u4ef6\u5939":this.isHistory(e)?"\u5386\u53f2\u7248\u672c":"\u6587\u4ef6"}},{key:"transformName",value:function(e,t){var n=e.action,a=e.newName,r=e.oldName;return"rename"===n?r+" \u2192 "+a:t}},{key:"render",value:function(){var e=this.props,t=e.activity,n=e.user,a=e.file,r=t.action,u=t.actionMsg,c=t.createdAtText,f=n.path,d=n.avatar,p=n.name,m=this.actionToFileType(r),h=this.transformName(t,a.name);return o.default.createElement("div",{className:s.activity},o.default.createElement("div",{className:s.dot}),o.default.createElement("div",{className:s.content},o.default.createElement("div",{className:s.avatar},o.default.createElement(i.Link,{to:f},o.default.createElement(l.default,{size:"small",src:d}))),o.default.createElement("div",{className:s.detail},o.default.createElement("div",{className:s.title},o.default.createElement(i.Link,{to:f},p),o.default.createElement("em",null,u,m)),o.default.createElement("div",{className:s.time},c),o.default.createElement("div",{className:s.fileName},h))))}}]),t}();f.propTypes={activity:u.activityPropTypes,user:u.userPropTypes,file:u.filePropTypes},t.default=f},3308:function(e,t,n){e.exports={"start-date":"start-date-c2Z",startDate:"start-date-c2Z",activity:"activity-2zV",dot:"dot-21G",content:"content-2P0",avatar:"avatar-3on",detail:"detail-3kX",title:"title-2Yu",time:"time-3pu","file-name":"file-name-ljh",fileName:"file-name-ljh"}},3310:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=b(n(0)),i=n(2),l=b(i),u=b(n(8)),s=n(168),c=b(n(545)),f=b(n(1453)),d=n(1459),p=n(1462),m=n(112),h=n(1479),y=b(n(1574)),v=n(1542),E=n(2206);function b(e){return e&&e.__esModule?e:{default:e}}var g=f.default.Item,w=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"fetchHistory",value:function(e){return this.props.getFileHistory(e)}},{key:"renderDelete",value:function(e,t,n,a){var r=this;return e?null:l.default.createElement("li",null,l.default.createElement("a",{href:"#",onClick:function(){confirm("\u786e\u8ba4\u5220\u9664\u7248\u672c V"+a+" \u6587\u4ef6\u5386\u53f2\uff1f")&&r.props.deleteFileHistory(t,n).then(function(){(0,m.success)("\u7248\u672c V"+a+" \u6587\u4ef6\u5386\u53f2\u5220\u9664\u6210\u529f")})}},"\u5220\u9664"))}},{key:"renderDownload",value:function(e,t){var n=this.props.projectId;if(e)return null;var a="/api/project/"+n+"/files/histories/"+t+"/download";return l.default.createElement("li",null,l.default.createElement("a",{href:a,target:"_blank"},"\u4e0b\u8f7d"))}},{key:"renderHistories",value:function(){var e=this,t=this.props,n=t.histories,r=n.result,o=n.entities,i=t.file,c=i.type,f=i.historyId,d=i.fileId,p=r.length;return r.map(function(t,n){var r,i,m,y=o.histories[t],v=y.remark,b=y.version,w=y.ownerId,_=y.createdAtText,P=o.users[w].name,O=f===t,k=(0,u.default)(E.version,(r={},i=E.active,m=O,i in r?Object.defineProperty(r,i,{value:m,enumerable:!0,configurable:!0,writable:!0}):r[i]=m,r)),T=h.TYPE.FOLDER===c;return l.default.createElement(g,{key:"file-history-"+t},l.default.createElement("div",{className:E.history},l.default.createElement("div",{className:k},b),l.default.createElement("div",{className:E.detail},l.default.createElement("div",{className:E.title},l.default.createElement(s.Link,{onlyActiveOnIndex:!0,to:function(e){return a({},e,{query:{v:p-n}})}},v)),l.default.createElement("div",{className:E.time},P," \u4fee\u6539\u4e8e ",_),l.default.createElement("ul",{className:E.operation},e.renderDelete(O,t,d,b),e.renderDownload(T,t)))))})}},{key:"render",value:function(){var e=this,t=this.props.file.fileId;return l.default.createElement(y.default,{className:v.tabContent+" "+E.historyWrapper,fileTypeName:"\u6587\u4ef6\u5386\u53f2",fileId:t,loadingPosition:"top",fetchPromise:function(t){return e.fetchHistory(t)}},l.default.createElement(f.default,{className:"clearfix",type:"block",blockItemPadding:"28",hover:!0,bordered:!0,empty:""},this.renderHistories()))}}]),t}();w.propTypes={getFileHistory:o.default.func.isRequired,deleteFileHistory:o.default.func.isRequired,file:d.filePropTypes,histories:d.normalizedHistoriesPropTypes,projectId:o.default.number},w.defaultProps={},t.default=(0,c.default)(function(e){var t=e.PROJECT.file;return{histories:t.histories,file:t.preview.current,projectId:e.APP.currentProject.id}},{getFileHistory:p.getFileHistory,deleteFileHistory:p.deleteFileHistory})((0,s.withRouter)(w))},3312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=p(n(0)),o=n(2),i=p(o),l=p(n(545)),u=n(1459),s=n(168),c=p(n(1692)),f=n(2206),d=n(1542);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"ownerName",value:function(){var e=this.props,t=e.file.ownerId,n=e.files.entities;return n&&t?n.users[t].name:null}},{key:"folder",value:function(){var e=this.props,t=e.file.parentId,n=e.folderPaths,a=e.files.entities,r=e.projectPath;if(!a||!t||0===t)return null;var o=n.find(function(e){return e.fileId===t});return o?i.default.createElement("div",{className:f.summaryLine+" "+f.summaryLineFolder},i.default.createElement("em",null,"\u5f53\u524d\u76ee\u5f55"),i.default.createElement("img",{src:c.default}),i.default.createElement(s.Link,{to:r+"/attachment/"+t},o.name)):null}},{key:"render",value:function(){var e=this.props.file,t=e.numberText,n=e.fileType,a=e.createdAtText,r=e.updatedAtText;return i.default.createElement("div",{className:d.tabContent},i.default.createElement("div",{className:f.summary},i.default.createElement("h3",null,"\u57fa\u672c\u4fe1\u606f"),i.default.createElement("div",{className:f.summaryLine},i.default.createElement("em",null,"\u5f15\u7528\u7f16\u53f7"),t),i.default.createElement("div",{className:f.summaryLine},i.default.createElement("em",null,"\u6587\u4ef6\u7c7b\u578b"),n),this.folder(),i.default.createElement("div",{className:f.summaryLine},i.default.createElement("em",null,"\u521b\u5efa\u65f6\u95f4"),a),i.default.createElement("div",{className:f.summaryLine},i.default.createElement("em",null,"\u6700\u8fd1\u66f4\u65b0"),r),i.default.createElement("div",{className:f.summaryLine},i.default.createElement("em",null,"\u521b\u5efa\u4eba"),this.ownerName())))}}]),t}();m.propTypes={file:u.filePropTypes,files:u.normalizedFilesTypes,folderPaths:r.default.arrayOf(u.folderPathPropTypes),projectPath:r.default.string},t.default=(0,l.default)(function(e){var t=e.PROJECT.file;return{file:t.preview.current,files:t.files,folderPaths:t.folderPaths,projectPath:e.APP.projectPath}},{})(m)},3313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=g(n(0)),i=n(2),l=g(i),u=n(168),s=g(n(1623)),c=g(n(1693)),f=g(n(1481)),d=n(84),p=g(n(545)),m=n(112),h=n(1462),y=n(1459),v=g(n(2207)),E=n(1479),b=n(1542);function g(e){return e&&e.__esModule?e:{default:e}}function w(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var _=E.TOOLBAR_ACTIONS.DOWNLOAD,P=E.TOOLBAR_ACTIONS.SHARE,O=E.TOOLBAR_ACTIONS.MOVE,k=E.TOOLBAR_ACTIONS.DELETE,T=E.TOOLBAR_ACTIONS.RENAME,S=E.TOOLBAR_ACTIONS.EDIT,N=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.onAction=a.onAction.bind(a),a.state={menu:a.getMenus(e)},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.projectId,n=e.file,a=e.apiPathPrefix,r=e.editing,o=e.renaming,i=this.props,l=i.projectId,u=i.file,s=i.apiPathPrefix,c=i.editing,f=i.renaming;(null==u&&null!==n||n&&u&&u.fileId!==n.fileId||l!==t||s!==a||c!==r||f!==o)&&this.setState({menu:this.getMenus(e)})}},{key:"getMenus",value:function(e){var t=e.file,n=e.editing,a=e.renaming,r=E.AVAILABLE_FILE_TYPES_TO_EDIT.indexOf(t.fileType)>=0,o={content:l.default.createElement(f.default,null),action:S,title:"\u7f16\u8f91"},i={content:l.default.createElement(f.default,null),action:T,title:"\u91cd\u547d\u540d"},u=[{content:this.getDownloadContent(e),action:_,title:"\u4e0b\u8f7d"}];return n||a||(u=[r?o:i].concat(w(u))),{visible:u=[{content:l.default.createElement(c.default,null),action:P,title:"\u5206\u4eab"}].concat(w(u)),rest:[{content:"\u5220\u9664",action:k}]}}},{key:"getDownloadContent",value:function(e){var t=e.projectId,n=e.file,a=n.fileId,r=n.type,o=n.size,i=e.apiPathPrefix,u="/api/project/"+t+"/files/"+a+"/download",c=o>E.MIN_DOWNLOAD_FILES_SIZE;if(E.TYPE.FOLDER===r){if(c||0===o)return l.default.createElement(s.default,null);u=i+"/folder/"+a+"/download"}return l.default.createElement("a",{href:u,target:"_blank"},l.default.createElement(s.default,null))}},{key:"handleDelete",value:function(){var e=this,t=this.props,n=t.file,a=t.projectId,r=n.fileId,o=n.name,i=n.type;return new Promise(function(t,l){if(i===E.TYPE.FOLDER){if(confirm('\u786e\u8ba4\u5220\u9664\u6587\u4ef6\u5939 "'+o+'" ?'))return void e.props.deleteFolder(a,r).then(function(){(0,m.success)('\u6210\u529f\u5220\u9664\u6587\u4ef6\u5939 "'+o+'"'),t(n)}).catch(l)}else if(confirm('\u786e\u8ba4\u5220\u9664\u6587\u4ef6 "'+o+'" ?'))return void e.props.deleteFile(a,[r]).then(function(){(0,m.success)('\u6210\u529f\u5220\u9664\u6587\u4ef6 "'+o+'"'),t(n)}).catch(l);l()})}},{key:"handleFolderDownload",value:function(){var e=this.props,t=e.file,n=t.fileId,a=t.name,r=t.size,o=e.apiPathPrefix;0===r?(0,m.warning)('\u6587\u4ef6\u5939 "'+a+'" \u4e3a\u7a7a, \u4e0d\u80fd\u4e0b\u8f7d\u7a7a\u6587\u4ef6\u5939'):r>E.MIN_DOWNLOAD_FILES_SIZE&&confirm("\u6279\u91cf\u4e0b\u8f7d\u6587\u4ef6\u8fc7\u5927\uff0c\u6211\u4eec\u5c06\u5728\u540e\u53f0\u6253\u5305\uff0c\u6253\u5305\u5b8c\u6210\u540e\u5c06\u7ed9\u60a8\u53d1\u9001\u7ad9\u5185\u901a\u77e5\u3002\u786e\u8ba4\u4e0b\u8f7d\uff1f")&&this.props.asyncDownloadFolder(o,n).then(function(){(0,m.success)("\u6587\u4ef6\u5df2\u5f00\u59cb\u5728\u540e\u53f0\u6253\u5305")})}},{key:"onAction",value:function(e){var t=this,n=this.props,r=n.file.type,o=n.projectPath;switch(e){case _:E.TYPE.FOLDER===r&&this.handleFolderDownload();break;case P:var i=this.props.file;this.props.setShareModal(!0,i);break;case O:break;case T:this.props.renamePreviewFile(!0);break;case k:this.handleDelete().then(function(e){var n=e.parentId,a=o+"/attachment/"+(0===n?"default":n);t.props.router.push(a)});break;case S:this.props.editPreviewFile(!0),this.props.router.push(a({},this.props.router.location,{query:{}}))}}},{key:"render",value:function(){var e=this.state.menu,t=this.props.toolTipPosition;return l.default.createElement(v.default,{onAction:this.onAction,menu:e,toolTipPosition:t,itemClass:b.toolbarItem})}}]),t}();N.propTypes={file:y.filePropTypes.isRequired,renaming:o.default.bool.isRequired,editing:o.default.bool.isRequired,deleteFile:o.default.func.isRequired,deleteFolder:o.default.func.isRequired,projectId:o.default.number.isRequired,renamePreviewFile:o.default.func.isRequired,editPreviewFile:o.default.func.isRequired,asyncDownloadFolder:o.default.func.isRequired,setShareModal:o.default.func.isRequired,apiPathPrefix:o.default.string,toolTipPosition:o.default.string,router:o.default.object.isRequired,projectPath:o.default.string},t.default=(0,p.default)(function(e){var t=e.APP,n=t.currentProject,a=t.projectPath,r=e.PROJECT.file.preview,o=r.renaming,i=r.editing,l=(0,d.toCamelCase)(n),u=l.id,s=l.name;return{projectId:u,apiPathPrefix:"/api/user/"+l.ownerUserName+"/project/"+s,renaming:o,editing:i,projectPath:a}},{deleteFile:h.deleteFile,deleteFolder:h.deleteFolder,asyncDownloadFolder:h.asyncDownloadFolder,renamePreviewFile:h.renamePreviewFile,editPreviewFile:h.editPreviewFile,setShareModal:h.setShareModal})((0,u.withRouter)(N))},3317:function(e,t,n){e.exports={container:"container-3tc",action:"action-1vM",name:"name-1Ul",checkbox:"checkbox-tCS",link:"link-qAw",clipboard:"clipboard-H-d",input:"input-3tE"}},3319:function(e,t){e.exports={"zh-CN":{"share.file":"\u5206\u4eab\u6587\u4ef6\uff1a","share.wiki":"\u5206\u4eab Wiki \u9875\u9762\uff1a","current.status":"\u5f53\u524d\u72b6\u6001\uff1a",sharing:"\u5df2\u5f00\u542f","not.sharing":"\u672a\u5f00\u542f","sharing.tip":"\u5f00\u542f\u540e\u5c06\u81ea\u52a8\u521b\u5efa\u516c\u5f00\u94fe\u63a5","sharing.link.tip":"\u8be5\u94fe\u63a5\u9002\u7528\u4e8e\u6240\u6709\u4eba\uff0c\u65e0\u9700\u767b\u5f55\u3002"},"en-US":{"share.file":"Share File: ","share.wiki":"Share Wiki: ","current.status":"Current Status: ",sharing:"Sharing","not.sharing":"Not Sharing","sharing.tip":"A public url will be created after sharing","sharing.link.tip":"This public url is available to everyone whether login or not."}}},3320:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=g(n(0)),o=n(2),i=g(o),l=g(n(701)),u=g(n(545)),s=n(112),c=g(n(1665)),f=g(n(1666)),d=n(1581),p=g(n(2209)),m=n(1479),h=n(1459),y=n(1555),v=n(2210),E=g(n(2211)),b=n(1462);function g(e){return e&&e.__esModule?e:{default:e}}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var _=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=w(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={showToolbar:!1},a.handleMouseOver=function(){a.setState({showToolbar:!0})},a.handleMouseLeave=function(){a.setState({showToolbar:!1})},a.handleNameChange=function(e,t){return(a.props.file.type===m.TYPE.FOLDER?a.props.renameFolder:a.props.renameFile)(e,t).then(function(){(0,s.success)('\u91cd\u547d\u540d "'+e+'" \u6210\u529f')})},w(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"renderNumber",value:function(e){return this.props.isFiltering?i.default.createElement(p.default,{text:e}):e}},{key:"renderName",value:function(e){return this.props.isFiltering?i.default.createElement(p.default,{text:e}):e}},{key:"renderUpdatedAt",value:function(){var e=this.props.file,t=e.updatedAtText,n=e.fileId;return i.default.createElement("span",null,n<0?"--":t)}},{key:"renderUploadProgressBar",value:function(){var e=this.props.file.progress;return i.default.createElement("div",{className:v.uploadProgressBar,style:{width:e+"%"}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.file,a=t.owner,r=t.share,o=t.isFiltering,u=t.projectPath,s=t.isShareFolder,p=t.onOpenPreview,m=this.state.showToolbar;return i.default.createElement(d.PutInMotion,{of:"worktable-remind-motion",offsetY:8,motion:i.default.createElement(f.default,null),key:n.id},function(t){return i.default.createElement("div",{className:""+y.fileItem},i.default.createElement("ul",{onMouseOver:e.handleMouseOver,onMouseLeave:e.handleMouseLeave},i.default.createElement("li",{className:"batch"},i.default.createElement(l.default,{checked:n.select,onChange:function(){e.props.toggleSelectFile(n.id)}})),i.default.createElement("li",{className:"name"},i.default.createElement(E.default,{file:n,share:r,toolbar:m,isFiltering:o,onNameChange:e.handleNameChange,projectPath:u,isShareFolder:s,onOpenPreview:p})),i.default.createElement("li",{className:"number"},e.renderNumber(n.numberText)),i.default.createElement("li",{className:"size"},n.sizeText),i.default.createElement("li",{className:"ownerName ellipsis",title:a.name},e.renderName(a.name)),i.default.createElement("li",{className:"updatedAt"},i.default.createElement("span",null,i.default.createElement("span",{className:"updatedTime"},e.renderUpdatedAt()),i.default.createElement(c.default,{className:"remind",reminded:n.reminded,triggerPutIn:t,targetId:n.projectFileId,targetType:c.default.TargetType.FILE})))),n.fileId<0&&e.renderUploadProgressBar())})}}]),t}();_.propTypes={file:h.filePropTypes.isRequired,owner:h.userPropTypes.isRequired,share:h.sharePropTypes,toggleSelectFile:r.default.func.isRequired,renameFile:r.default.func.isRequired,renameFolder:r.default.func.isRequired,isFiltering:r.default.bool,projectPath:r.default.string.isRequired,isShareFolder:r.default.bool.isRequired,onOpenPreview:r.default.func.isRequired},t.default=(0,u.default)(function(e){var t=e.APP.projectPath;return{isFiltering:e.PROJECT.file.isFiltering,projectPath:t}},{toggleSelectFile:b.toggleSelectFile,renameFile:b.renameFile,renameFolder:b.renameFolder})(_)},3323:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=m(i),u=m(n(8)),s=m(n(2212)),c=n(1459),f=n(1479),d=m(n(1692)),p=m(n(3329));function m(e){return e&&e.__esModule?e:{default:e}}var h=(r=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"renderFileIcon",value:function(){var e=this.props.file.fileType,t="other"===e?"other":(e||"").toLowerCase(),n=(0,u.default)("file-icon",t,"ellipsis");return l.default.createElement("div",{className:n,title:t},t)}},{key:"renderFolderIcon",value:function(){return l.default.createElement("div",{className:"folder-icon"},l.default.createElement("img",{src:d.default}))}},{key:"renderImageIcon",value:function(){var e=this.props.file,t=e.name,n=e.preview||p.default;return l.default.createElement("div",{className:"file-icon"},l.default.createElement(s.default,{height:52,once:!0},l.default.createElement("img",{src:n,alt:t,height:"100%"})))}},{key:"render",value:function(){var e=this.props.file,t=e.type,n=e.fileType;return f.TYPE.FOLDER===t?this.renderFolderIcon():"other"===n||"dmg"===n?this.renderFileIcon():f.TYPE.IMAGE===t?this.renderImageIcon():this.renderFileIcon()}}]),t}(),a.propTypes={file:c.filePropTypes},r);t.default=h},3329:function(e,t,n){e.exports=n.p+"static/media/imageIcon.35c317e2.svg"},3330:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=v(n(0)),o=n(2),i=v(o),l=v(n(1623)),u=v(n(1693)),s=n(84),c=v(n(545)),f=n(112),d=n(1462),p=n(1459),m=v(n(2207)),h=n(1479),y=v(n(2210));function v(e){return e&&e.__esModule?e:{default:e}}var E=h.TOOLBAR_ACTIONS.DOWNLOAD,b=h.TOOLBAR_ACTIONS.SHARE,g=h.TOOLBAR_ACTIONS.MOVE,w=h.TOOLBAR_ACTIONS.DELETE,_=h.TOOLBAR_ACTIONS.RENAME,P=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.onAction=a.onAction.bind(a),a.state={menu:a.getMenus(e)},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"getMenus",value:function(e){var t=e.file.type,n=[{content:this.getDownloadContent(e),action:E,title:"\u4e0b\u8f7d"}],a=[{content:"\u91cd\u547d\u540d",action:_},{content:"\u5220\u9664",action:w}];return t!==h.TYPE.FOLDER&&(n=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n),[{content:i.default.createElement(u.default,{className:y.default.shareIcon}),action:b,title:"\u5206\u4eab"}])),{visible:n,rest:a}}},{key:"getDownloadContent",value:function(e){var t=e.projectId,n=e.file,a=n.fileId,r=n.type,o=n.size,u=e.apiPathPrefix,s="/api/project/"+t+"/files/"+a+"/download",c=o>h.MIN_DOWNLOAD_FILES_SIZE;if(h.TYPE.FOLDER===r){if(c||0===o)return i.default.createElement(l.default,null);s=u+"/folder/"+a+"/download"}return i.default.createElement("a",{href:s,target:"_blank"},i.default.createElement(l.default,null))}},{key:"handleDelete",value:function(){var e=this.props,t=e.file,n=t.fileId,a=t.name,r=t.type,o=e.projectId;r===h.TYPE.FOLDER?confirm('\u786e\u8ba4\u5220\u9664\u6587\u4ef6\u5939 "'+a+'" ?')&&this.props.deleteFolder(o,n).then(function(){(0,f.success)('\u6210\u529f\u5220\u9664\u6587\u4ef6\u5939 "'+a+'"')}):confirm('\u786e\u8ba4\u5220\u9664\u6587\u4ef6 "'+a+'" ?')&&this.props.deleteFile(o,[n]).then(function(){(0,f.success)('\u6210\u529f\u5220\u9664\u6587\u4ef6 "'+a+'"')})}},{key:"handleFolderDownload",value:function(){var e=this.props,t=e.file,n=t.fileId,a=t.name,r=t.size,o=e.apiPathPrefix;0===r?(0,f.warning)('\u6587\u4ef6\u5939 "'+a+'" \u4e3a\u7a7a, \u4e0d\u80fd\u4e0b\u8f7d\u7a7a\u6587\u4ef6\u5939'):r>h.MIN_DOWNLOAD_FILES_SIZE&&confirm("\u6279\u91cf\u4e0b\u8f7d\u6587\u4ef6\u8fc7\u5927\uff0c\u6211\u4eec\u5c06\u5728\u540e\u53f0\u6253\u5305\uff0c\u6253\u5305\u5b8c\u6210\u540e\u5c06\u7ed9\u60a8\u53d1\u9001\u7ad9\u5185\u901a\u77e5\u3002\u786e\u8ba4\u4e0b\u8f7d\uff1f")&&this.props.asyncDownloadFolder(o,n).then(function(){(0,f.success)("\u6587\u4ef6\u5df2\u5f00\u59cb\u5728\u540e\u53f0\u6253\u5305")})}},{key:"handleFileShare",value:function(){var e=this.props.file;this.props.setShareModal(!0,e)}},{key:"onAction",value:function(e){var t=this.props,n=t.file.type,a=t.onRename;switch(e){case E:h.TYPE.FOLDER===n&&this.handleFolderDownload();break;case b:this.handleFileShare();break;case g:break;case _:a();break;case w:this.handleDelete()}}},{key:"render",value:function(){var e=this.state.menu;return i.default.createElement(m.default,{onAction:this.onAction,menu:e})}}]),t}();P.propTypes={file:p.filePropTypes.isRequired,deleteFile:r.default.func.isRequired,deleteFolder:r.default.func.isRequired,projectId:r.default.number.isRequired,onRename:r.default.func.isRequired,asyncDownloadFolder:r.default.func.isRequired,apiPathPrefix:r.default.string,setShareModal:r.default.func},P.defaultProps={},t.default=(0,c.default)(function(e){var t=e.APP.currentProject,n=(0,s.toCamelCase)(t),a=n.id,r=n.name;return{projectId:a,apiPathPrefix:"/api/user/"+n.ownerUserName+"/project/"+r}},{deleteFile:d.deleteFile,deleteFolder:d.deleteFolder,asyncDownloadFolder:d.asyncDownloadFolder,setShareModal:d.setShareModal})(P)},3331:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=w(n(0)),o=n(2),i=w(o),l=w(n(2213)),u=w(n(151)),s=w(n(1623)),c=w(n(547)),f=w(n(3332)),d=w(n(701)),p=w(n(8)),m=w(n(545)),h=n(112),y=n(84),v=n(1555),E=n(1479),b=n(1462),g=n(1459);function w(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var P=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return n=a=_(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={headers:{name:"\u540d\u79f0",number:"\u6587\u4ef6ID",size:"\u5927\u5c0f",ownerName:"\u521b\u5efa\u8005",updatedAt:"\u66f4\u65b0\u65e5\u671f"}},a.handleBatchDelete=function(){var e=a.props,t=e.projectId,n=e.selectCount;confirm("\u786e\u8ba4\u5220\u9664\u9009\u4e2d\u7684 "+n+" \u4e2a\u6587\u4ef6/\u6587\u4ef6\u5939\uff08\u975e\u7a7a\u6587\u4ef6\u5939\u5c06\u4e0d\u4f1a\u88ab\u5220\u9664\uff09\uff1f")&&a.props.batchDeleteFiles(t).then(function(e){var t=e.deleteCount;(0,h.success)("\u6210\u529f\u5220\u9664 "+t+" \u4e2a\u6587\u4ef6/\u6587\u4ef6\u5939")})},a.handleBatchDownload=function(){var e=a.props,t=e.batchFiles,n=e.apiPathPrefix,r=t.filter(function(e){return e.select}),o=r.reduce(function(e,t){return e+t.size},0);if(0!==o){if(o>E.MIN_DOWNLOAD_FILES_SIZE&&confirm("\u6279\u91cf\u4e0b\u8f7d\u6587\u4ef6\u8fc7\u5927\uff0c\u6211\u4eec\u5c06\u5728\u540e\u53f0\u6253\u5305\uff0c\u6253\u5305\u5b8c\u6210\u540e\u5c06\u7ed9\u60a8\u53d1\u9001\u7ad9\u5185\u901a\u77e5\u3002\u786e\u8ba4\u4e0b\u8f7d\uff1f")){var i=r.map(function(e){return e.id});a.props.asyncDownloadFilesAndFolders(n,i).then(function(){(0,h.success)("\u6587\u4ef6\u5df2\u5f00\u59cb\u5728\u540e\u53f0\u6253\u5305")})}}else(0,h.warning)("\u9009\u62e9\u7684\u6587\u4ef6\u5939\u4e0d\u5305\u542b\u4efb\u4f55\u53ef\u4e0b\u8f7d\u7684\u6587\u4ef6")},a.handleBatchMove=function(){a.props.setFileMoving(!0)},a.renderMove=function(){return i.default.createElement("li",{className:"move",onClick:a.handleBatchMove},i.default.createElement(f.default,null)," \u79fb\u52a8\u5230...")},_(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"renderIcon",value:function(e){return null===e?null:e===E.SORT.ASC?i.default.createElement(l.default,null):i.default.createElement(u.default,null)}},{key:"toggleSort",value:function(e,t){var n=null;null===t?n=E.SORT.DESC:t===E.SORT.DESC?n=E.SORT.ASC:t===E.SORT.ASC&&(n=E.SORT.DESC),this.props.sortFiles({field:e,sort:n})}},{key:"renderSortableField",value:function(e){var t=this,n=this.state.headers,a=this.props.sorts,r=a.field,o=a.sort,l=n[e],u=(0,p.default)(e,v.sortable);return i.default.createElement("li",{key:e,className:u,onClick:function(){t.toggleSort(e,o)}},l,e===r?this.renderIcon(o):null)}},{key:"renderDelete",value:function(){var e=this.props,t=e.selectCount;return e.batchFiles.filter(function(e){var t=e.type,n=e.size;return e.select&&E.TYPE.FOLDER===t&&n>0}).length===t?null:i.default.createElement("li",{className:"remove",onClick:this.handleBatchDelete},i.default.createElement(c.default,null)," \u5220\u9664")}},{key:"renderDownload",value:function(){var e=this.props,t=e.batchFiles,n=e.apiPathPrefix,a=e.projectId,r=t.filter(function(e){return e.select}),o=r.reduce(function(e,t){return e+t.size},0);if(0===o)return null;if(o>E.MIN_DOWNLOAD_FILES_SIZE)return i.default.createElement("li",{onClick:this.handleBatchDownload},i.default.createElement(s.default,null)," \u4e0b\u8f7d");var l=r.map(function(e){return e.id}),u=n+"/files/mixed/download?"+(0,y.buildParams)({fileIds:l});if(1===l.length){var c=r[0].type===E.TYPE.FOLDER,f=l[0];u=c?n+"/folder/"+f+"/download":"/api/project/"+a+"/files/"+f+"/download"}return i.default.createElement("li",null,i.default.createElement("a",{href:u,target:"_blank"},i.default.createElement(s.default,null)," \u4e0b\u8f7d"))}},{key:"renderBatchToolbar",value:function(){var e=this.props.selectCount;return i.default.createElement("li",{className:v.batchToolbar},i.default.createElement("ul",null,this.renderDownload(),this.renderMove(),this.renderDelete(),i.default.createElement("li",{className:"count"},"\u5df2\u9009\u4e2d ",e," \u4e2a\u6587\u4ef6 / \u6587\u4ef6\u5939")))}},{key:"render",value:function(){var e=this.state.headers;return i.default.createElement("div",{className:v.listHeader},i.default.createElement("ul",null,i.default.createElement("li",{className:"batch"},i.default.createElement(d.default,{checked:this.props.selectAll,onChange:this.props.toggleSelectAll})),this.props.selectCount>0?this.renderBatchToolbar():Object.keys(e).map(this.renderSortableField,this)))}}]),t}();P.propTypes={sortFiles:r.default.func.isRequired,toggleSelectAll:r.default.func.isRequired,batchDeleteFiles:r.default.func.isRequired,asyncDownloadFilesAndFolders:r.default.func.isRequired,sorts:g.sortPropTypes,selectAll:r.default.bool,selectCount:r.default.number,projectId:r.default.number,batchFiles:r.default.array,apiPathPrefix:r.default.string,setFileMoving:r.default.func.isRequired},P.defaultProps={selectCount:0},t.default=(0,m.default)(function(e){var t=e.PROJECT.file,n=t.sorts,a=t.selectAll,r=t.selectCount,o=t.files,i=o.result,l=o.entities.files,u=e.APP.currentProject,s=(0,y.toCamelCase)(u),c=s.id,f=s.name,d=s.ownerUserName;return{projectId:c,sorts:n,selectAll:a,selectCount:r,batchFiles:i.map(function(e){return l[e]}),apiPathPrefix:"/api/user/"+d+"/project/"+f}},{sortFiles:b.sortFiles,toggleSelectAll:b.toggleSelectAll,batchDeleteFiles:b.batchDeleteFiles,asyncDownloadFilesAndFolders:b.asyncDownloadFilesAndFolders,setFileMoving:b.setFileMoving})(P)},3333:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=c(n(0)),o=n(2),i=c(o),l=n(1555),u=c(n(545)),s=c(n(2214));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"renderStats",value:function(){var e=this.props,t=e.filterKey,n=e.filteredCount,a=e.pageSize,r=e.totalRow;return 0===t.length?"\u5df2\u5168\u90e8\u52a0\u8f7d\uff0c\u5171 "+(r<a?r:a)+" \u4e2a":"\u7b5b\u9009\u7ed3\u679c\uff0c\u5171 "+n+" \u4e2a"}},{key:"render",value:function(){return i.default.createElement("div",{className:l.fileStats},i.default.createElement(s.default,null),i.default.createElement("span",{className:"stats"},this.renderStats()))}}]),t}();f.propTypes={filterKey:r.default.string,filteredCount:r.default.number,pageSize:r.default.number,totalRow:r.default.number},f.defaultProps={pageSize:0,totalRow:0,filteredResultCount:0},t.default=(0,u.default)(function(e){var t=e.PROJECT.file,n=t.filterKey,a=t.filteredCount,r=t.pager;return{pageSize:r.pageSize,totalRow:r.totalRow,filterKey:n,filteredCount:a}},{})(f)},3334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=l(a),o=l(n(702)),i=l(n(3335));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){var t=e.hasFilter,n=e.isFolder;return r.default.createElement(o.default,{icon:n?o.default.ICONS.Folder:o.default.ICONS.Document,text:t?r.default.createElement("div",null,"\u65e0\u7b5b\u9009\u7ed3\u679c"):r.default.createElement("div",{className:i.default.emptyFile},r.default.createElement("h3",null,"\u8fd8\u6ca1\u4e0a\u4f20\u4efb\u4f55\u6587\u4ef6\uff0c\u5c06\u6587\u4ef6\u62d6\u62fd\u81f3\u6b64\u9875\u9762\u4e0a\u4f20\uff01"),r.default.createElement("sub",null,"\u652f\u6301\u6240\u6709\u6587\u4ef6\u683c\u5f0f\uff0c\u5355\u4e2a\u6587\u4ef6\u4e0d\u8d85\u8fc7 300M\u3002"))})};u.propTypes={hasFilter:a.PropTypes.bool,isFolder:a.PropTypes.bool},t.default=u},3335:function(e,t,n){e.exports={"empty-file":"empty-file-39x",emptyFile:"empty-file-39x"}},3337:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=h(n(0)),o=n(2),i=h(o),l=h(n(544)),u=h(n(78)),s=h(n(545)),c=n(1598),f=h(n(1453)),d=n(226),p=n(1462),m=h(n(1555));function h(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var v=f.default.Item,E=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.onBeforeCreateFolder=function(){a.props.toggleNewFolder()},y(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"renderCreateButton",value:function(){var e=this,t=this.props,n=t.projectPath,a=t.folderId,r=n+"/attachment/"+(0===a?"default":a),o=i.default.createElement(f.default,{type:"block",blockItemPadding:"0",className:m.default.menu,hover:!0,empty:""},i.default.createElement(v,{className:m.default.menuItem,onClick:function(){return e.props.push(r+"/create/txt")}},"TXT"),i.default.createElement(v,{className:m.default.menuItem,onClick:function(){return e.props.push(r+"/create/markdown")}},"Markdown"));return i.default.createElement(u.default,{className:m.default.createFileDropdown,menu:o,hoverTrigger:!0},i.default.createElement(l.default,{empty:!0},"\u521b\u5efa\u6587\u4ef6"))}},{key:"render",value:function(){return i.default.createElement("div",{className:m.default.fileTopMenu},i.default.createElement("ul",null,i.default.createElement("li",{className:"search",key:"search-input"},i.default.createElement(c.FilterInput,{placeholder:"\u7b5b\u9009\u6587\u4ef6",onChange:this.props.filterFiles})),!this.props.isShareFolder&&i.default.createElement("li",{key:"button-upload"},i.default.createElement(l.default,{onClick:this.props.onBeforeUpload},"\u4e0a\u4f20\u6587\u4ef6")),!this.props.isShareFolder&&i.default.createElement("li",{key:"button-new-folder"},i.default.createElement(l.default,{onClick:this.onBeforeCreateFolder,disabled:this.props.newFolder,empty:!0},"\u65b0\u5efa\u6587\u4ef6\u5939")),!this.props.isShareFolder&&i.default.createElement("li",{key:"buttons-create"},this.renderCreateButton())))}}]),t}();E.propTypes={filterFiles:r.default.func.isRequired,toggleNewFolder:r.default.func.isRequired,onBeforeUpload:r.default.func.isRequired,newFolder:r.default.bool.isRequired,projectPath:r.default.string,folderId:r.default.number,isShareFolder:r.default.bool.isRequired,push:r.default.func},E.defaultProps={onBeforeUpload:function(){}},t.default=(0,s.default)(function(e){return{newFolder:e.PROJECT.file.newFolder}},{filterFiles:p.filterFiles,toggleNewFolder:p.toggleNewFolder,push:d.push})(E)},3338:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=p(n(0)),o=n(2),i=p(o),l=p(n(545)),u=n(112),s=n(1462),c=n(1555),f=p(n(2211)),d=n(1479);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.onNameChange=a.onNameChange.bind(a),a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"onNameChange",value:function(e){return this.props.mkdir(e).then(function(){(0,u.success)('\u6587\u4ef6\u5939 "'+e+'" \u521b\u5efa\u6210\u529f')})}},{key:"render",value:function(){var e={type:d.TYPE.FOLDER,name:"\u65b0\u5efa\u6587\u4ef6\u5939"};return i.default.createElement("div",{className:""+c.fileItem},i.default.createElement("ul",null,i.default.createElement("li",{style:{width:"16px"}}),i.default.createElement("li",{className:"name"},i.default.createElement(f.default,{file:e,newFolder:!0,onNameChange:this.onNameChange,onCancel:this.props.toggleNewFolder}))))}}]),t}();m.propTypes={mkdir:r.default.func.isRequired,toggleNewFolder:r.default.func.isRequired},m.defaultProps={},t.default=(0,l.default)(null,{mkdir:s.mkdir,toggleNewFolder:s.toggleNewFolder})(m)},3339:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=f(n(0)),i=n(2),l=f(i),u=n(1578),s=f(n(3340)),c=n(1555);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"render",value:function(){var e=this;return l.default.createElement(u.DropZone,a({className:c.fileDropzone,activeClassName:c.fileDropzoneActive,disableClick:!0,disablePreview:!0,multiple:!0},this.props,{ref:function(t){e.dropdown=t}}),l.default.createElement("div",{className:c.dropzoneTips},l.default.createElement("div",{className:c.centerRegion},l.default.createElement("h2",null,l.default.createElement(s.default,null)," \u5c06\u6587\u4ef6\u4e0a\u4f20\u81f3\u6b64\u76ee\u5f55"))),this.props.children)}}]),t}();d.propTypes=a({children:o.default.any},u.DropZone.propTypes),d.defaultProps={},t.default=d},3341:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&l.return&&l.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),i=E(o),l=E(n(549)),u=E(n(544)),s=E(n(699)),c=E(n(0)),f=n(4199),d=E(f),p=n(1462),m=n(112),h=n(1459),y=E(n(545)),v=n(3342);function E(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var g=0,w="_attachments",_=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,l=Array(o),u=0;u<o;u++)l[u]=arguments[u];return n=r=b(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.state={folderId:null,loading:!0,submitting:!1},r.handleLoadData=function(e){var t=e.props.eventKey;return r.props.getSubFolders(+t)},r.handleTreeSelect=function(e){var t=a(e,1)[0],n=void 0===t?null:t;n?r.props.getSubFolders(+n).finally(function(){r.setState({folderId:n})}):r.setState({folderId:n})},r.handleConfirm=function(){var e=r.state.folderId;if(e){var t=r.props.isShareFolder;r.setState({submitting:!0}),r.props.moveFiles(+e,t).then(function(e){(0,m.success)("\u6210\u529f\u79fb\u52a8 "+e+" \u4e2a\u6587\u4ef6/\u6587\u4ef6\u5939")}).finally(function(){return r.setState({submitting:!1})})}},r.handleCancel=function(){r.setState({folderId:null,loading:!1}),r.props.onHide()},r.renderTree=function(){var e=r.props.currentFolderId,t=r.props.isFolderSelected,n=[g.toString()],a=function a(r,o){return r.filter(function(n){var a=n.name,r=n.fileId;return(o!==g||a!==w)&&(o!==e||!t[r])}).map(function(e){var t=e.children,r=e.name,o=e.fileId;return t?(n.push(o.toString()),i.default.createElement(f.TreeNode,{title:r,key:o},a(t,o))):i.default.createElement(f.TreeNode,{title:r,key:o})})}(r.props.folders,g);return i.default.createElement(d.default,{className:v.fileTree,onSelect:r.handleTreeSelect,loadData:r.handleLoadData,expandedKeys:n},i.default.createElement(f.TreeNode,{title:"\u5168\u90e8\u6587\u4ef6\u5939",key:g},a))},r.handleShow=function(){r.setState({loading:!0}),r.props.getSubFolders(g).finally(function(){r.setState({loading:!1})})},r.renderLoading=function(){return i.default.createElement("div",{style:{margin:"0 30px"}},i.default.createElement(s.default,null)," \u6b63\u5728\u52a0\u8f7d\u6570\u636e...")},b(r,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:"render",value:function(){var e=this.props.show,t=this.state,n=t.folderId,a=t.loading,r=t.submitting;return i.default.createElement(l.default,{show:e,className:v.fileExplorer,onHide:this.handleCancel,onShow:this.handleShow,closeButton:!0},i.default.createElement(l.default.Header,null,i.default.createElement("h2",null,"\u79fb\u52a8\u5230")),i.default.createElement(l.default.Body,null,a?this.renderLoading():this.renderTree()),i.default.createElement(l.default.Footer,null,i.default.createElement(u.default,{loading:r,onClick:this.handleConfirm,disabled:r||!n},"\u786e\u8ba4"),i.default.createElement(u.default,{onClick:this.handleCancel,empty:!0},"\u53d6\u6d88")))}}]),t}();_.propTypes={show:c.default.bool,onHide:c.default.func.isRequired,getSubFolders:c.default.func.isRequired,moveFiles:c.default.func.isRequired,folders:c.default.arrayOf(h.subFolderPropTypes),currentFolderId:c.default.number.isRequired,isFolderSelected:c.default.object.isRequired,isShareFolder:c.default.bool.isRequired},_.defaultProps={},t.default=(0,y.default)(function(e){var t=e.PROJECT.file;return{folders:t.move.folders,currentFolderId:t.currentFolderId,isFolderSelected:t.originalFiles.filter(function(e){return e.select}).reduce(function(e,t){var n=t.fileId,a=t.isFolder;return e[n]=a,e},Object.create(null))}},{getSubFolders:p.getSubFolders,moveFiles:p.moveFiles})(_)},3342:function(e,t,n){e.exports={"file-explorer":"file-explorer-1ce",fileExplorer:"file-explorer-1ce","file-tree":"file-tree-3jR",fileTree:"file-tree-3jR"}},3344:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=p(n(0)),o=n(2),i=p(o),l=p(n(2214)),u=p(n(545)),s=n(2215),c=n(1462),f=n(1479),d=p(n(3346));function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"componentDidMount",value:function(){var e=this.props.folderId;this.props.getFolderPaths(e)}},{key:"render",value:function(){var e=this.props,t=e.fileType,n=e.folderId,a=e.fileTypeName;return i.default.createElement("div",null,i.default.createElement("div",{className:s.header},i.default.createElement(l.default,{append:"\u521b\u5efa "+a+" \u6587\u4ef6"})),i.default.createElement(d.default,{fileType:t,folderId:n}))}}]),t}();m.propTypes={folderId:r.default.number,fileType:r.default.string.isRequired,fileTypeName:r.default.string,getFolderPaths:r.default.func.isRequired},m.defaultProps={},t.default=(0,u.default)(function(e,t){var n=e.PROJECT.file,a=(n.files,n.filterKey,n.newFolder,n.previewing,e.APP.projectPath,t.routeParams),r=a.folderId,o=void 0===r?0:r,i=a.fileType;return{folderId:"default"===o||isNaN(o)?0:parseInt(o,10),fileType:i,fileTypeName:f.AVAILABLE_FILE_TYPES_TO_CREATE[i]}},{getFolderPaths:c.getFolderPaths})(m)},3346:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=P(n(0)),l=n(2),u=P(l),s=n(715),c=P(n(261)),f=P(n(544)),d=n(1506),p=P(n(76)),m=n(168),h=n(112),y=n(1462),v=n(226),E=n(114),b=n(1479),g=n(2215),w=P(n(2204)),_=P(n(2205));function P(e){return e&&e.__esModule?e:{default:e}}var O=(0,n(266).withAsyncMarkEditor)()(a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.handleSave=a.handleSave.bind(a),a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"getFileExtName",value:function(){var e=this.props.fileType;return b.FILE_TYPE_TO_EXT_NAME[e]}},{key:"handleSave",value:function(e){var t=this,n=e.folderId,a=e.name,r=e.content,o=this.getFolderPath(),i=a+"."+this.getFileExtName();return this.props.createFile(n,i,r).then(function(){t.editor&&t.editor.onSave()}).then(function(){return(0,h.success)("\u65b0\u6587\u4ef6 "+i+" \u521b\u5efa\u6210\u529f"),t.props.push(o),Promise.resolve()})}},{key:"getFolderPath",value:function(){var e=this.props,t=e.projectPath,n=e.folderId;return t+"/attachment/"+(0===n?"default":n)}},{key:"renderLinkableCancel",value:function(){var e=this,t=this.props.submitting,n=this.getFolderPath();return t?u.default.createElement(f.default,{key:"cancel",empty:!0,disabled:!0},"\u53d6\u6d88"):u.default.createElement(m.Link,{key:"cancel-link",to:n,onClick:function(){e.editor&&e.editor.onCancel()}},u.default.createElement(f.default,{empty:!0},"\u53d6\u6d88"))}},{key:"renderButtons",value:function(){var e=this.props,t=e.submitting,n=e.valid;return[u.default.createElement(f.default,{key:"save",style:{marginRight:"10px"},disabled:t||!n,loading:t,htmlType:"submit"},"\u4fdd\u5b58"),this.renderLinkableCancel()]}},{key:"renderNameInput",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{borderless:!1},t=this.props.fields.name;return u.default.createElement(c.default,r({},(0,d.input)(t),e,{size:"medium",placeholder:"\u6587\u4ef6\u540d",autoFocus:!0,block:!0}))}},{key:"renderEditorHeader",value:function(){return u.default.createElement("div",{className:g.editorHeader},u.default.createElement("div",{className:g.nameInput},this.renderNameInput({borderless:!0})),u.default.createElement("div",{className:g.buttons},this.renderButtons()))}},{key:"renderEditor",value:function(){var e=this,t=this.props,n=t.fields.content,a=t.folderId,o=t.projectName,i=t.projectOwner,l=t.projectId;if("markdown"===t.fileType){var s="PROJECT_"+l+"_FOLDER_"+a+"_FILE_CREATE";return u.default.createElement(w.default,r({className:g.editor,ref:function(t){return e.editor=t&&t.hocEditor},projectId:l,projectName:o,projectOwner:i,mentionParams:{context_type:"project_member",item_id:l},header:this.renderEditorHeader(),autoSaveKey:s},n,{createWithContent:this.props.createWithContent,getPlainText:this.props.getPlainText,MediumMarkEditor:this.props.MediumMarkEditor}))}return u.default.createElement(_.default,r({className:g.editor},n))}},{key:"render",value:function(){var e=this.props,t=e.fields.folderId,n=e.handleSubmit,a=this.getFileExtName();return u.default.createElement("form",{className:g.form,onSubmit:n(this.handleSave)},u.default.createElement(c.default,r({className:"cuk-hide",htmlType:"hidden"},(0,d.input)(t))),u.default.createElement("div",{className:g.formLine+" "+g.extName},this.renderNameInput({icon:u.default.createElement("em",null,".",a)})),u.default.createElement("div",{className:g.formLine},this.renderEditor()),u.default.createElement("div",{className:g.formLine},this.renderButtons()))}}]),t}())||a;O.propTypes=r({projectId:i.default.number,projectName:i.default.string,projectOwner:i.default.string,projectPath:i.default.string,createFile:i.default.func.isRequired,push:i.default.func.isRequired,fileType:i.default.string,MediumMarkEditor:i.default.func,getPlainText:i.default.func,createWithContent:i.default.func},s.propTypes),O.defaultProps={};var k=v.routerActions.push;t.default=(0,s.reduxForm)({fields:["name","content","folderId"],validate:function(e){var t=e.name,n=e.content,a=e.folderId,r={};return isNaN(a)&&(r.folderId="\u8bf7\u5148\u9009\u5b9a\u4e00\u4e2a\u6587\u4ef6\u5939"),(0,p.default)(t)&&(r.name="\u6587\u4ef6\u540d\u4e0d\u80fd\u4e3a\u7a7a"),(0,p.default)(n)&&(r.content="\u6587\u4ef6\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"),r},form:"FileCreateForm",touchOnBlur:!1},function(e,t){var n=e.APP,a=n.currentProject,r=a.id;return{projectName:a.name,projectOwner:a.owner_user_name,projectPath:n.projectPath,projectId:r,initialValues:{folderId:t.folderId}}},function(e){return{createFile:(0,E.bindActionCreators)(y.createFile,e),push:(0,E.bindActionCreators)(k,e)}})(O)},3347:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(51);t.default={getComponent:function(e,t){n.e(146).then(function(){(0,a.injectAsyncI18n)("SETTING",n(3797)),t(null,n(3798).default)}.bind(null,n)).catch(n.oe)}}},3348:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=T(n(0)),u=n(2),s=T(u),c=n(1606),f=T(n(1794)),d=T(n(8)),p=n(168),m=T(n(78)),h=T(n(1468)),y=T(n(1790)),v=T(n(2229)),E=T(n(700)),b=T(n(1454)),g=T(n(261)),w=n(112),_=T(n(2230)),P=T(n(3395)),O=n(1953),k=T(n(3396));function T(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var N=(r=a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=S(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={expandKeeping:{},addToId:""},a.postWiki=function(e,t,n){return a.props.postWiki({parentId:e,title:t,path:n}).then(function(e){var t=a.props.currentProject;a.props.router.push(t.project_path+"/wiki/"+e.iid),a.expandPath(n),a.setState({addToId:""})})},a.moveWiki=function(e,t,n){a.props.moveWiki(e,t,n),"INSERT_AFTER"!==(0,O.getMoveType)(n)&&a.expandPath(t)},S(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Component),i(t,[{key:"componentDidMount",value:function(){this.props.initialPath&&this.expandPath("/"+this.props.initialPath)}},{key:"componentWillReceiveProps",value:function(e){var t=e.initialPath;t&&this.props.initialPath!==t&&this.expandPath("/"+t)}},{key:"expandPath",value:function(e){var t=o({},this.state.expandKeeping);e.split("/").slice(1).forEach(function(e){t[e]=!0}),this.setState({expandKeeping:t})}},{key:"remove",value:function(e,t,n){var a=this;n.children&&n.children.length>0?(0,w.danger)("\u6b64\u6587\u7ae0\u4e0b\u4ecd\u5b58\u5728\u5b50\u6587\u7ae0\uff0c\u4e0d\u80fd\u5220\u9664\u3002"):confirm("\u5220\u9664\u7684\u540c\u65f6\u4e5f\u4f1a\u5220\u9664\u5386\u53f2\u7248\u672c\uff0c\u8bf7\u786e\u8ba4\u5220\u9664\u8be5 Wiki ?")&&this.props.delWiki(e,t).then(function(){var e=a.props.currentProject;(0,w.success)("\u5220\u9664\u6210\u529f"),a.props.router.push(e.project_path+"/wiki")})}},{key:"addTo",value:function(e){var t,n,a,r=this,i=e.toString();this.setState({addToId:i,expandKeeping:o({},this.state.expandKeeping,(t={},n=i,a=!0,n in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t))},function(){r.newPageInput&&r.newPageInput.input.focus()})}},{key:"toggleCollapsed",value:function(e){var t=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(this.state.expandKeeping,[]),n=e.toString();t[n]=!t[n],this.setState({expandKeeping:t})}},{key:"renderFrom",value:function(e){var t=this,n=this.state.expandKeeping,a=o({},this.props.directory.nodes);return function(r,o){var i=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r.children)),l=r.iid.toString();if(0===i.length&&t.state.addToId===l){var u=l+"-fake-child";i.push({iid:u,children:[]}),a[u]={title:u}}var c=a[l];if(!c)return null;var f=c.title,h=t.props.currentProject.project_path,v=e+"/"+l,E=s.default.createElement("ul",null,s.default.createElement("li",{onClick:function(){return t.addTo(l)}},"\u65b0\u5efa\u5b50\u9875\u9762"),s.default.createElement("li",{onClick:function(){return t.remove(l,e,r)}},"\u5220\u9664")),b=s.default.createElement("div",{className:(0,d.default)("tree-view_label",{active:t.props.activeId===l})},s.default.createElement("span",{className:"tree-view_label_name"},s.default.createElement(p.Link,{to:h+"/wiki/"+l},f)),s.default.createElement(m.default,{className:"tree-view_action",hoverTrigger:!0,menu:E},s.default.createElement(y.default,{className:"tree-view_action_icon"}))),w=(0,d.default)({empty:0===i.length}),P=i.map(t.renderFrom(v),t);return t.state.addToId===l&&P.push(s.default.createElement(g.default,{key:i.length+1,placeholder:"\u56de\u8f66\u6dfb\u52a0\u9875\u9762",className:k.default.newPageInput,ref:function(e){return t.newPageInput=e},onPressEnter:function(e,n){return t.postWiki(l,n,v)},onBlur:function(){return t.addTo("")}})),s.default.createElement(_.default,{key:o,id:l,path:v,itemClassName:w,nodeLabel:b,collapsed:!n[l],onClick:function(){return t.toggleCollapsed(l)},moveWiki:t.moveWiki},P)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.directory,a=t.currentProject,r=n.tree,o=s.default.createElement(E.default,null,"\u9875\u9762\u5217\u8868");return s.default.createElement("div",{className:k.default.sidebar},s.default.createElement("div",{className:k.default.toc},s.default.createElement("div",{className:k.default.header},"\u9875\u9762",s.default.createElement(b.default,{placement:"top",overlay:o},s.default.createElement(p.Link,{className:k.default.listLink,to:a.project_path+"/wiki/pages"},s.default.createElement(v.default,null)))),s.default.createElement(P.default,{tree:r,moveWiki:this.moveWiki},r.map(this.renderFrom(""),this),"root"===this.state.addToId&&s.default.createElement(g.default,{placeholder:"\u56de\u8f66\u6dfb\u52a0\u9875\u9762",className:k.default.newPageInput,ref:function(t){return e.newPageInput=t},onPressEnter:function(t,n){return e.postWiki(0,n,"")},onBlur:function(){return e.addTo("")}})),s.default.createElement("div",{className:k.default.newBtn,onClick:function(){return e.addTo("root")}},s.default.createElement(h.default,{className:k.default.icon}),"\u65b0\u5efa\u9875\u9762")))}}]),t}(),a.propTypes={router:l.default.object,activeId:l.default.string,initialPath:l.default.string,currentProject:l.default.object,searchRefer:l.default.func,postWiki:l.default.func,delWiki:l.default.func,moveWiki:l.default.func,directory:l.default.shape({tree:l.default.array,nodes:l.default.object})},r);t.default=(0,c.DragDropContext)(f.default)(N)},3395:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=p(n(0)),l=n(2),u=p(l),s=n(16),c=p(n(8)),f=n(1606),d=n(2230);function p(e){return e&&e.__esModule?e:{default:e}}var m=void 0;function h(e){var t=e.getClientOffset(),n=m.firstChild.getBoundingClientRect().top,a=m.lastChild.getBoundingClientRect().bottom;return{atTop:t.y<n,atBottom:t.y>a}}var y={canDrop:function(e,t){var n=t.getItem(),a=e.tree[0],r=e.tree.slice(-1)[0],o=h(t),i=o.atTop,l=o.atBottom;return!(!t.isOver({shallow:!0})||i&&a.iid.toString()===n.id||l&&r.iid.toString()===n.id)&&(i||l)},drop:function(e,t){var n=t.getItem(),a=h(t).atTop;e.moveWiki(n.path,"",{dropOnTop:a})}};var v=(r=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"componentDidMount",value:function(){m=(0,s.findDOMNode)(this)}},{key:"componentWillUnmount",value:function(){m=null}},{key:"render",value:function(){var e=this.props,t=e.connectDropTarget,n=e.canDrop,a=e.dropOnTop,r=e.children,o=(0,c.default)("tree-view_container",{canDrop:n,dropOnTop:a});return t(u.default.createElement("div",{className:o},r))}}]),t}(),a.propTypes={canDrop:i.default.bool,dropOnTop:i.default.bool,children:i.default.node,connectDropTarget:i.default.func,moveWiki:i.default.func.isRequired,tree:i.default.array.isRequired},r);t.default=(0,f.DropTarget)(d.TYPES.ITEM,y,function(e,t){var n=t.canDrop();return{canDrop:n,connectDropTarget:e.dropTarget(),dropOnTop:n&&t.getDifferenceFromInitialOffset().y<0}})(v)},3396:function(e,t,n){e.exports={toc:"toc-B9k","new-page-input":"new-page-input-2Yp",newPageInput:"new-page-input-2Yp",sidebar:"sidebar-3iJ",header:"header-b3z","list-link":"list-link-4R8",listLink:"list-link-4R8",icon:"icon-3UX","new-btn":"new-btn-3Vo",newBtn:"new-btn-3Vo"}},3398:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),i=(a=o)&&a.__esModule?a:{default:a};var l=/^#[^ ]+$/,u=!(!history||!history.pushState);t.default=function(e){return function(t){return function(n){function a(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t));return n.scrollToCurrent=n.scrollToCurrent.bind(n),n.scrollIfAnchor=n.scrollIfAnchor.bind(n),n.delegateAnchors=n.delegateAnchors.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,o.Component),r(a,[{key:"componentDidMount",value:function(){this.scrollToCurrent(),window.addEventListener("hashchange",this.scrollToCurrent),document.body.addEventListener("click",this.delegateAnchors)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("hashchange",this.scrollToCurrent),document.body.removeEventListener("click",this.delegateAnchors)}},{key:"componentDidUpdate",value:function(){this.scrollToCurrent()}},{key:"scrollToCurrent",value:function(){this.scrollIfAnchor(decodeURIComponent(window.location.hash))}},{key:"scrollIfAnchor",value:function(t,n){var a=t.substring(t.lastIndexOf("#"),t.length)||"";if(!l.test(a))return!1;var r=document.getElementById(a.slice(1))||document.getElementById("user-content-"+a.slice(1));if(r){var o=r.getBoundingClientRect(),i=e||r.offsetParent.offsetTop;if(setTimeout(function(){return window.scrollTo(0,window.pageYOffset+o.top-i)}),u&&n){var s=location,c=s.pathname,f=s.search;history.pushState({},document.title,c+f+a)}}return!!r}},{key:"delegateAnchors",value:function(e){var t=e.target;"A"===t.nodeName&&this.scrollIfAnchor(t.getAttribute("href"),!0)&&e.preventDefault()}},{key:"render",value:function(){return i.default.createElement(t,this.props)}}]),a}()}}},3399:function(e,t,n){e.exports={"wiki-show":"wiki-show-1v4",wikiShow:"wiki-show-1v4","header-container":"header-container-Q7_",headerContainer:"header-container-Q7_",header:"header-123","wiki-info":"wiki-info-3TJ",wikiInfo:"wiki-info-3TJ","id-tag":"id-tag-3C_",idTag:"id-tag-3C_",share:"share-25w",icon:"icon-1zu",editor:"editor-1Gl",date:"date-3dM",edit:"edit-3Z-",remind:"remind-1hg",btn:"btn-3sh",remove:"remove-3SK",warning:"warning-3Eu",content:"content-2jD",title:"title-1kz"}},3401:function(e,t,n){e.exports={empty:"empty-2cE",welcome:"welcome--kl",tip:"tip-3Kb"}},3403:function(e,t,n){e.exports={content:"content-Juq",main:"main-2Ng",empty:"empty-3RT",tip:"tip-3UI"}},3405:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(545)),r=o(n(3406));function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,a.default)(function(e){return{atSuggestionConfig:{context_type:"project_member",item_id:e.APP.currentProject.id}}})(r.default)},3406:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=_(n(0)),s=n(2),c=_(s),f=_(n(261)),d=_(n(544)),p=n(1506),m=n(112),h=n(168),y=_(n(699)),v=n(1636),E=n(715),b=n(226),g=n(266),w=_(n(2234));function _(e){return e&&e.__esModule?e:{default:e}}var P=(0,g.withAsyncMarkEditor)()((o=r=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.handleWindowClose=function(e){return(e||window.event).returnValue="\u7cfb\u7edf\u53ef\u80fd\u4e0d\u4f1a\u4fdd\u5b58\u60a8\u6240\u505a\u7684\u4fee\u6539","\u7cfb\u7edf\u53ef\u80fd\u4e0d\u4f1a\u4fdd\u5b58\u60a8\u6240\u505a\u7684\u4fee\u6539"},a.onSubmit=a.onSubmit.bind(a),a.cancel=a.cancel.bind(a),a.onChange=a.onChange.bind(a),a.state={creating:!1,editorState:e.defaultEditorState},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.Component),l(t,[{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",this.handleWindowClose)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.handleWindowClose)}},{key:"onChange",value:function(e,t){this.setState({editorState:e},t)}},{key:"onSubmit",value:function(e){var t=this,n=this.props,a=n.projectPath,r=(0,n.getPlainText)(this.state.editorState);this.props.postWiki(i({},e,{content:r})).then(this.editor.onSave).then(function(){(0,m.success)("\u65b0\u5efa\u6210\u529f"),t.props.push(a+"/wiki")}).finally(function(){return t.setState({creating:!1})})}},{key:"cancel",value:function(){this.editor.onCancel(),this.props.router.goBack()}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields,a=n.title,r=n.msg,o=t.handleSubmit,l=t.currentProject,u=t.projectPath,s=t.atSuggestionConfig,m=t.MediumMarkEditor,v=l.owner_user_name,E=l.name;return c.default.createElement("div",{className:w.default.newWiki},c.default.createElement("form",{onSubmit:o(this.onSubmit)},c.default.createElement("div",{className:w.default.header},c.default.createElement("h2",{className:"layout-content-h2"},"\u521b\u5efa\u9875\u9762")),c.default.createElement("div",{className:w.default.title},c.default.createElement(f.default,i({placeholder:"\u9875\u9762\u540d\u79f0",size:"medium"},(0,p.input)(a),{block:!0}))),c.default.createElement("div",{className:w.default.content},c.default.createElement(m,{ref:function(t){return e.editor=t},className:w.default.editor,placeholder:"\u9875\u9762\u5185\u5bb9",autoSaveKey:"WIKI-NEW",projectId:l.id,editorState:this.state.editorState,onChange:this.onChange,mentionParams:s,hashSearchParams:{owner:v,project:E},emojiList:[],recommentEmojiList:[]})),c.default.createElement("div",{className:w.default.msg},c.default.createElement("h3",null,"\u63d0\u4ea4\u8bf4\u660e"),c.default.createElement(f.default,i({block:!0,size:"medium"},(0,p.input)(r)))),c.default.createElement("div",{className:w.default.buttonGroup},c.default.createElement(d.default,{disabled:this.state.creating,htmlType:"submit"},this.state.creating&&c.default.createElement(y.default,null),this.state.creating?"\u521b\u5efa\u4e2d":"\u521b\u5efa\u9875\u9762"),c.default.createElement(h.Link,{to:u+"/wiki"},c.default.createElement(d.default,{empty:!0,onClick:this.cancel},"\u53d6\u6d88")))))}}]),t}(),r.propTypes=i({params:u.default.any,postWiki:u.default.func,atSuggestionConfig:u.default.object},E.propTypes,{defaultEditorState:u.default.object,MediumMarkEditor:u.default.func,getPlainText:u.default.func,createWithContent:u.default.func}),a=o))||a;t.default=(0,E.reduxForm)({form:"WikiNewForm",fields:["title","content","msg"]},function(e){return{projectPath:e.APP.projectPath}},{push:b.routerActions.push,postWiki:v.postWiki})(P)},3408:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=O(n(0)),u=n(2),s=O(u),c=O(n(545)),f=n(1636),d=O(n(3409)),p=O(n(2232)),m=O(n(3411)),h=O(n(699)),y=O(n(1455)),v=n(78),E=n(3412),b=n(168),g=O(n(1947)),w=O(n(76)),_=n(106),P=O(n(2235));function O(e){return e&&e.__esModule?e:{default:e}}var k=(r=a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state={showShareModal:!1,current:-1},a.renderWiki=function(e){return s.default.createElement(d.default,{key:e.iid,wiki:e,params:a.props.params,onShowShareModal:a.onShowShareModal})},a.onShowShareModal=function(e){a.setState({current:e,showShareModal:!0})},a.onHideShareModal=function(){a.setState({showShareModal:!1})},a.shareWiki=function(){a.props.shareWiki(a.props.projectId,a.state.current)},a.stopShareWiki=function(){var e=a.props.wikis.find(function(e){return e.iid===a.state.current});e&&a.props.stopShareWiki(e.iid,e.share.hash)},a.fetchData=a.fetchData.bind(a),a.onPage=a.onPage.bind(a),a.onDropDown=a.onDropDown.bind(a),a.state={loading:!0,page:a.props.pager.page,orderBy:"leastRecentlyUpdated"},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Component),i(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.setState({loading:!0});var a=this.props.params,r=a.owner,o=a.project;this.props.fetchWikis(r,o,t,n).finally(function(){e.setState({loading:!1})})}},{key:"renderLoading",value:function(){return s.default.createElement("div",null,s.default.createElement(h.default,null)," \u6b63\u5728\u52a0\u8f7d Wiki...")}},{key:"renderEmpty",value:function(){var e=this.props,t=e.filterKey,n=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(e,["filterKey"]);return 0!==t.length?s.default.createElement(m.default,null):s.default.createElement(p.default,o({fromList:!0},n))}},{key:"onPage",value:function(e){this.fetchData(e,this.state.orderBy),this.setState({page:e})}},{key:"onDropDown",value:function(e){this.fetchData(this.props.pager.page,e.value),this.setState({orderBy:e.value})}},{key:"renderList",value:function(){var e=this;if(0===this.props.wikis.length)return this.renderEmpty();var t=this.props.wikis.find(function(t){return t.iid===e.state.current})||{},n=t.share,a=!(0,w.default)(n);return s.default.createElement("div",null,s.default.createElement(g.default,{show:this.state.showShareModal,onHide:this.onHideShareModal,sharing:a,url:a?n.url:"",targetName:t.title,onShare:this.shareWiki,onStopShare:this.stopShareWiki,type:_.RESOURCE_TYPE.WIKI}),s.default.createElement("div",{className:P.default.wikiShoulder},s.default.createElement("div",{className:P.default.header},s.default.createElement(b.Link,{className:P.default.back,to:this.props.projectPath+"/wiki"},"Wiki"),"\xa0 > \xa0 \u9875\u9762\u5217\u8868\uff08",this.props.pager.totalRow,"\uff09"),s.default.createElement(v.TextDropdown,{className:P.default.dropdown,hoverTrigger:!0,items:E.wikiSortBy,value:this.state.orderBy,onSelect:this.onDropDown})),s.default.createElement("table",{className:P.default.table},s.default.createElement("thead",null,s.default.createElement("tr",null,s.default.createElement("th",null,"\u9875\u9762\u540d\u79f0"),s.default.createElement("th",null,"\u9875\u9762\u7f16\u53f7"),s.default.createElement("th",null,"\u521b\u5efa\u8005"),s.default.createElement("th",null,"\u521b\u5efa\u65f6\u95f4"),s.default.createElement("th",null,"\u6700\u540e\u66f4\u65b0\u8005"),s.default.createElement("th",null,"\u6700\u540e\u66f4\u65b0\u65f6\u95f4"))),s.default.createElement("tbody",null,this.props.wikis.map(this.renderWiki))),s.default.createElement(y.default,{pager:this.props.pager,onChange:this.onPage}))}},{key:"render",value:function(){var e=this.state.loading;return s.default.createElement("div",null,e?this.renderLoading():this.renderList())}}]),t}(),a.propTypes={params:l.default.any,wikis:l.default.array,fetchWikis:l.default.func,shareWiki:l.default.func,stopShareWiki:l.default.func,filterKey:l.default.string,projectPath:l.default.string,projectId:l.default.number,pager:l.default.object},r);t.default=(0,c.default)(function(e){var t=e.WIKI,n=t.wikis,a=t.pager,r=t.filterKey,o=e.APP;return{wikis:n,pager:a,filterKey:r,projectPath:o.projectPath,projectId:o.currentProject.id}},{fetchWikis:f.fetchWikis,shareWiki:f.shareWiki,stopShareWiki:f.stopShareWiki})(k)},3409:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=E(n(0)),l=n(2),u=E(l),s=E(n(545)),c=E(n(8)),f=E(n(263)),d=n(168),p=E(n(723)),m=E(n(1693)),h=n(559),y=E(n(76)),v=E(n(2235));function E(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var g=(r=a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=b(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.onShowShareModal=function(){a.props.onShowShareModal(a.props.wiki.iid)},b(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"render",value:function(){var e,t,n,a=this.props,r=a.wiki,o=a.projectPath;return u.default.createElement("tr",{className:v.default.wikiItem},u.default.createElement("td",{className:v.default.wikiTitle},u.default.createElement(d.Link,{to:o+"/wiki/"+r.iid},u.default.createElement(p.default,{className:v.default.fileIcon}),r.title),u.default.createElement(m.default,{onClick:this.onShowShareModal,className:(0,c.default)(v.default.shareIcon,(e={},t=v.default.show,n=!(0,y.default)(r.share),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e))})),u.default.createElement("td",{className:v.default.wikiIid},"#",r.iid),u.default.createElement("td",{className:v.default.wikiCreator},r.creator.name),u.default.createElement("td",{className:v.default.wikiCreatedAt},(0,f.default)(r.createdAt).format("MM-DD HH:mm:ss")),u.default.createElement("td",{className:v.default.wikiCreator},r.editor.name),u.default.createElement("td",{className:v.default.wikiCreatedAt},(0,f.default)(r.updatedAt).format("MM-DD HH:mm:ss")))}}]),t}(),a.propTypes={wiki:i.default.object,projectPath:i.default.string,onShowShareModal:i.default.func},r);t.default=(0,s.default)(function(e){return{projectPath:e.APP.projectPath}},{toggleSelectFile:h.toggleSelectFile})(g)},3411:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),i=(a=o)&&a.__esModule?a:{default:a};var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:"render",value:function(){return i.default.createElement("div",null,"\u65e0\u7b5b\u9009\u7ed3\u679c")}}]),t}();t.default=l},3412:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.wikiSortBy=[{text:"\u6700\u8fd1\u66f4\u65b0",value:"leastRecentlyUpdated"},{text:"\u6700\u65e9\u66f4\u65b0",value:"recentlyUpdated"},{text:"\u6700\u65b0\u521b\u5efa",value:"recentlyCreated"},{text:"\u6700\u65e9\u521b\u5efa",value:"leastRecentlyCreated"}]},3413:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=m(n(0)),u=n(2),s=m(u),c=m(n(545)),f=n(1636),d=n(226),p=m(n(2231));function m(e){return e&&e.__esModule?e:{default:e}}var h=(r=a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state={loading:!1},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Component),i(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.params,n=this.props.location.query.version||-1;this.props.getWiki(t.owner,t.project,t.iid,n).finally(function(){return e.setState({loading:!1})})}},{key:"render",value:function(){return s.default.createElement(p.default,this.props)}}]),t}(),a.propTypes=o({},p.default.propTypes,{location:l.default.shape({query:l.default.shape({version:l.default.string})})}),r);t.default=(0,c.default)(function(e){return{wiki:e.WIKI.wiki}},{push:d.routerActions.push,getWiki:f.getWiki,delWiki:f.delWiki,setVersion:f.setVersion})(h)},3414:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=h(n(0)),l=n(2),u=h(l),s=h(n(545)),c=n(1636),f=n(168),d=h(n(1460)),p=h(n(263)),m=h(n(3415));function h(e){return e&&e.__esModule?e:{default:e}}var y=(r=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.params;this.props.getWiki(t.owner,t.project,t.iid).then(function(){e.props.getWikiHistories(t.owner,t.project,t.iid)})}},{key:"renderHistory",value:function(e,t){var n=this.props,a=n.wiki,r=n.projectPath+"/wiki/page/"+a.iid;return u.default.createElement("tr",{key:t},u.default.createElement("td",null,u.default.createElement(f.Link,{className:m.default.link,to:r+"?version="+e.version},e.version)),u.default.createElement("td",null,e.editor.name),u.default.createElement("td",null,e.msg),u.default.createElement("td",null,(0,p.default)(e.createdAt).format("MM-DD HH:mm")))}},{key:"renderHistories",value:function(){return this.props.histories.map(this.renderHistory,this)}},{key:"render",value:function(){var e=this,t=this.props.wiki;return u.default.createElement("div",{className:m.default.wikiHistories},u.default.createElement("div",{className:m.default.header},u.default.createElement("span",{className:m.default.back,onClick:function(){return e.props.router.goBack()}},t.title),"\xa0 > \xa0\u5386\u53f2\u7248\u672c"),u.default.createElement("div",{className:m.default.history},u.default.createElement(d.default,null,u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{className:m.default.versionHeader},"\u7248\u672c"),u.default.createElement("th",{className:m.default.userHeader},"\u521b\u5efa\u8005"),u.default.createElement("th",null,"\u63d0\u4ea4\u4fe1\u606f"),u.default.createElement("th",{className:m.default.timeHeader},"\u521b\u5efa\u65f6\u95f4"))),u.default.createElement("tbody",null,this.renderHistories())))))}}]),t}(),a.propTypes={params:i.default.any,getWiki:i.default.func,getWikiHistories:i.default.func,wiki:i.default.object,histories:i.default.array,projectPath:i.default.string,router:i.default.object},r);t.default=(0,s.default)(function(e){var t=e.WIKI;return{wiki:t.wiki,histories:t.histories,projectPath:e.APP.projectPath}},{getWiki:c.getWiki,getWikiHistories:c.getWikiHistories})(y)},3415:function(e,t,n){e.exports={"wiki-histories":"wiki-histories-3Lu",wikiHistories:"wiki-histories-3Lu",header:"header-3jv",back:"back-RlP","time-header":"time-header-3v6",timeHeader:"time-header-3v6","version-header":"version-header-1yD",versionHeader:"version-header-1yD","user-header":"user-header-2e-",userHeader:"user-header-2e-"}},3417:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(545)),r=o(n(3418));function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,a.default)(function(e){return{atSuggestionConfig:{context_type:"project_member",item_id:e.APP.currentProject.id}}})(r.default)},3418:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=w(n(0)),s=n(2),c=w(s),f=w(n(261)),d=w(n(544)),p=n(1506),m=n(112),h=w(n(699)),y=n(1636),v=n(715),E=n(226),b=n(266),g=w(n(2234));function w(e){return e&&e.__esModule?e:{default:e}}var _=(0,b.withAsyncMarkEditor)()((o=r=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.handleWindowClose=function(e){return(e||window.event).returnValue="\u7cfb\u7edf\u53ef\u80fd\u4e0d\u4f1a\u4fdd\u5b58\u60a8\u6240\u505a\u7684\u4fee\u6539","\u7cfb\u7edf\u53ef\u80fd\u4e0d\u4f1a\u4fdd\u5b58\u60a8\u6240\u505a\u7684\u4fee\u6539"},a.getBackEidtWikiListUrl=function(){var e=a.props,t=e.params.iid;return e.projectPath+"/wiki/"+t},a.onSubmit=a.onSubmit.bind(a),a.onChange=a.onChange.bind(a),a.cancel=a.cancel.bind(a),a.state={updating:!1,editorState:e.defaultEditorState},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.Component),l(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.params,n=this.props.location.query.version||-1;this.props.getWiki(t.owner,t.project,t.iid,n).then(function(){e.editor.onFetch(e.props.content),e.props.fields.msg.onChange("")}).finally(function(){return e.setState({loading:!1})}),window.addEventListener("beforeunload",this.handleWindowClose)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.handleWindowClose)}},{key:"cancel",value:function(){this.editor.onCancel(),this.props.router.goBack()}},{key:"getWikiPageUrl",value:function(){var e=this.props,t=e.params.iid;return e.projectPath+"/wiki/page/"+t}},{key:"onSubmit",value:function(e){var t=this,n=this.props.getPlainText(this.state.editorState),a=this.props.wiki,r=a.order,o=a.parentIid;this.props.postWiki(i({},e,{content:n,order:r,parentId:o})).then(this.editor.onSave).then(function(){(0,m.success)("\u4fee\u6539\u6210\u529f"),t.props.router.push(t.getBackEidtWikiListUrl())}).catch(function(){return t.setState({updating:!1})})}},{key:"onChange",value:function(e,t){this.setState({editorState:e},t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields,a=n.iid,r=n.title,o=n.msg,l=t.currentProject,u=t.atSuggestionConfig,s=t.handleSubmit,m=t.MediumMarkEditor,y=l.owner_user_name,v=l.name;return c.default.createElement("div",{className:g.default.newWiki},c.default.createElement("form",{onSubmit:s(this.onSubmit)},c.default.createElement("div",{className:g.default.header},c.default.createElement("h2",{className:"layout-content-h2"},"\u7f16\u8f91\u9875\u9762")),c.default.createElement("div",{className:g.default.title},c.default.createElement(f.default,i({placeholder:"\u9875\u9762\u540d\u79f0"},(0,p.input)(r),{block:!0}))),c.default.createElement("div",{className:g.default.content},c.default.createElement(m,{className:g.default.editor,placeholder:"\u9875\u9762\u5185\u5bb9",autoSaveKey:"WIKI-EDIT-"+a.value,ref:function(t){return e.editor=t},projectId:l.id,editorState:this.state.editorState,onChange:this.onChange,mentionParams:u,hashSearchParams:{owner:y,project:v},emojiList:[],recommentEmojiList:[]})),c.default.createElement("div",{className:g.default.msg},c.default.createElement("h3",null,"\u63d0\u4ea4\u8bf4\u660e"),c.default.createElement(f.default,i({block:!0},(0,p.input)(o)))),c.default.createElement("div",{className:g.default.buttonGroup},c.default.createElement(d.default,{disabled:this.state.updating,htmlType:"submit"},this.state.updating&&c.default.createElement(h.default,null),this.state.updating?"\u4fee\u6539\u4e2d":"\u786e\u8ba4\u7f16\u8f91"),c.default.createElement(d.default,{empty:!0,onClick:this.cancel},"\u53d6\u6d88")),c.default.createElement(f.default,i({htmlType:"hidden"},(0,p.input)(a)))))}}]),t}(),r.propTypes=i({params:u.default.any,postWiki:u.default.func,projectPath:u.default.string,atSuggestionConfig:u.default.object},v.propTypes),a=o))||a;t.default=(0,v.reduxForm)({form:"WikiEditForm",fields:["iid","title","msg"]},function(e){var t=e.WIKI.wiki,n=e.APP.projectPath;return{initialValues:t,content:t.content,projectPath:n}},{push:E.routerActions.push,postWiki:y.postWiki,getWiki:y.getWiki})(_)},3419:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1653),r=n(226),o=n(106),i=["blame","blob","commit","commits","find","tree","raw","archive","compare","branches"].map(function(e){return new RegExp("git/"+e+"/?.*")});i.unshift(new RegExp("git$")),t.default=(0,a.UserAuthWrapper)({authSelector:function(e){var t=e.APP.currentProject,n=(t=void 0===t?{}:t).shared,a=t.is_member,r=e.routing.locationBeforeTransitions.pathname,o=!0;return n&&!a&&(o=i.some(function(e){return e.test(r)})),{isAuth:o}},predicate:function(e){return e.isAuth},authenticatingSelector:function(e){return e.APP.currentProjectLoading},redirectAction:function(e){return(0,r.replace)(e)},failureRedirectPath:function(e){return e.APP.currentProject.depot_path},redirectQueryParamName:o.REDIRECT_QUERY_PARAM_NAME,allowRedirectBack:!1})},3420:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(546),r=n(1449);t.default={path:"blob/**",documentTitle:(0,r.projectPage)(function(e){var t=e.BLOB.blob.data;return t.ref&&t.file&&t.file.path?t.file.path+" - "+t.ref+" - \u4ee3\u7801\u6d4f\u89c8":"\u4ee3\u7801\u6d4f\u89c8"}),getComponent:function(e,t){n.e(152).then(function(){(0,a.injectAsyncReducer)("DEPOT",n(3902).default),(0,a.injectAsyncReducer)("BLOB",n(3903).default),t(null,n(3904).default)}.bind(null,n)).catch(n.oe)}}},3421:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(546),r=n(1449);t.default={path:"tree/**",documentTitle:(0,r.projectPage)(function(){return"\u4ee3\u7801\u6d4f\u89c8"}),getComponent:function(e,t){n.e(66).then(function(){(0,a.injectAsyncReducer)("SVN_TREE",n(2297).default),t(null,n(2299).default)}.bind(null,n)).catch(n.oe)}}},3423:function(e,t,n){e.exports=n.p+"static/media/image-flowkind-fast.5a874c6f.png"},3424:function(e,t,n){e.exports=n.p+"static/media/image-flowkind-concurrent.1a4f6e11.png"},3425:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=y(i),u=y(n(0)),s=n(1543),c=y(n(1510)),f=y(n(2239)),d=y(n(544)),p=y(n(8)),m=n(112),h=y(n(2240));function y(e){return e&&e.__esModule?e:{default:e}}var v=(r=a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={flowType:0,submitting:!1},e.renderTypes=e.renderTypes.bind(e),e.flowInit=e.flowInit.bind(e),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"flowInit",value:function(){var e=this;this.state.submitting||0!==this.state.flowType&&(this.setState({submitting:!0}),this.props.flowInit(this.state.flowType).then(function(){(0,m.success)("\u65b0\u5efa\u6210\u529f"),e.props.getDepot(e.props.params.owner,e.props.params.project)}).finally(function(){return e.setState({submitting:!1})}))}},{key:"renderType",value:function(e,t){var n,a,r,o=this;return l.default.createElement("li",{key:t,onClick:function(){"close"!==e.status&&o.setState({flowType:e.type})},className:(0,p.default)(this.state.flowType===e.type?h.default.archive:"","close"===e.status?h.default.disabled:"")},l.default.createElement("div",{className:(0,p.default)(h.default.header,"clearfix")},l.default.createElement("div",{className:(0,p.default)(h.default.title,(n={},a=h.default.typeTow,r=2===e.type,a in n?Object.defineProperty(n,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[a]=r,n))},e.title),l.default.createElement("div",{className:h.default.img},e.image)),l.default.createElement("div",{className:(0,p.default)(h.default.body,"clearfix")},l.default.createElement("div",{className:h.default.video},l.default.createElement("img",{src:"http://via.placeholder.com/160x90",alt:""})),l.default.createElement("div",{className:h.default.infos},l.default.createElement("div",{className:h.default.info},l.default.createElement("span",null,l.default.createElement(c.default,null),e.member),l.default.createElement("span",null,l.default.createElement(f.default,null),e.short)),l.default.createElement("div",{className:h.default.desc},e.description))))}},{key:"renderTypes",value:function(){return s.FLOW_TYPES.map(this.renderType,this)}},{key:"render",value:function(){return l.default.createElement("div",{className:h.default.container},l.default.createElement("div",{className:h.default.emptyTitle},"\u8bf7\u9009\u62e9\u7b26\u5408\u60a8\u5f00\u53d1\u6d41\u7a0b\u7684\u6d41\u6c34\u7ebf\u6a21\u578b"),l.default.createElement("ul",{className:h.default.emptyTypes},this.renderTypes()),l.default.createElement("div",{className:h.default.emptyFoot},l.default.createElement(d.default,{size:"big",onClick:this.flowInit,loading:this.state.submitting,disabled:0===this.state.flowType},"\u521b\u5efa\u6d41\u6c34\u7ebf")))}}]),t}(),a.propTypes={flowInit:u.default.func,params:u.default.object,getDepot:u.default.func},r);t.default=v},3427:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=_(i),u=_(n(0)),s=_(n(545)),c=_(n(698)),f=_(n(544)),d=n(1694),p=_(n(2121)),m=_(n(263)),h=_(n(739)),y=n(168),v=_(n(3428)),E=_(n(1795)),b=_(n(8)),g=_(n(2243)),w=_(n(2242));function _(e){return e&&e.__esModule?e:{default:e}}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getActiveIndex=function(e,t){n.setState({activeCommitIndex:e?t:-1})},n.state={page:e.location.query.page||1,modalShow:!1,title:"",commit_sha:"",processModalShow:!1,activeCommitIndex:-1},n.renderCommits=n.renderCommits.bind(n),n.onModalHide=n.onModalHide.bind(n),n.onSubmitCreateRelease=n.onSubmitCreateRelease.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"componentDidMount",value:function(){this.props.flowCommits(this.state.page)}},{key:"componentWillReceiveProps",value:function(e){var t=e.location.query.page;t!==this.props.location.query.page&&this.props.flowCommits(t)}}]),o(t,[{key:"onModalHide",value:function(){this.setState({modalShow:!1,title:"",commit_sha:""})}},{key:"onSubmitCreateRelease",value:function(){var e=this;this.props.pubRelease({flow_iid:this.props.commits.data.flow.iid,commit_sha:this.state.commit_sha,tag_name:this.state.title}).then(function(){e.setState({modalShow:!1,title:"",commit_sha:""})})}},{key:"renderCommit",value:function(e,t,n){var a,r=this,o=this.props.commits,i=e.release?this.props.project.project_path+"/git/releases/"+e.release.tag_name:"";return n.length>1&&!e.release&&0===t?null:l.default.createElement("div",{key:t,className:(0,b.default)(w.default.commit,this.state.activeCommitIndex===t?w.default.activeCommit:"")},l.default.createElement("div",{className:w.default.commitContainer},l.default.createElement("div",{className:w.default.pointWrap},l.default.createElement("div",{className:w.default.decWrap,title:e.release&&e.release.title||e.release&&e.release.tag_name||""},e.release&&l.default.createElement(y.Link,{className:w.default.titleLink,to:i},e.release.title||e.release.tag_name),!e.empty&&l.default.createElement("time",null,(0,m.default)(e.commitTime).fromNow()," ",(0,m.default)(e.commitTime).format("hh:mm"))),l.default.createElement("div",{className:w.default.commitIconWrap},l.default.createElement("div",{className:(0,b.default)(w.default.greyBorder,o.loading||o.data.list.find(function(e){return e.release})?"":w.default.single)}),l.default.createElement(E.default,{empty:!e.release,emptyCommit:e.empty,className:(0,b.default)(w.default.commitPoint,(a={},P(a,w.default.releasePoint,e.release),P(a,w.default.emptyCommit,e.empty),a)),showCommitCard:!e.release,projectPath:this.props.project.project_path,newRelease:function(){r.setState({modalShow:!0,commit_sha:e.commitId})},commit:e}))),l.default.createElement("div",{className:w.default.content},e.release&&e.release.pipeline_id>0&&e.release.phases&&l.default.createElement(v.default,{phases:e.release.phases,release:e.release,isShowModal:this.state.processModalShow,getActiveIndex:function(e){r.getActiveIndex(e,t)},autoSkipPhases:this.props.commits.data.autoSkipPhases,phaseChangeStatus:this.props.phaseChangeStatus,phaseAddMark:this.props.phaseAddMark,phaseAutoSkip:this.props.phaseAutoSkip,phaseAutoSkipCancel:this.props.phaseAutoSkipCancel}))))}},{key:"renderCommits",value:function(){return(0,h.default)((0,p.default)(this.props.commits.data.list,function(e){return(0,m.default)(e.commitTime).format("YYYY-MM-DD")}),function(e,t){return Object.defineProperty(e,"$key",{__proto__:null,value:t})}).map(this.renderCommitGroup,this)}},{key:"renderCommitGroup",value:function(e,t){var n=this.props.commits;if(1===e.length&&e[0].empty)return null;var a=(0,m.default)(new Date).diff((0,m.default)(e.$key),"days"),r=void 0;return r=0===a?"\u4eca\u5929":1===a?"\u6628\u5929":(0,m.default)(e.$key).format("YYYY \u5e74 MM \u6708 DD \u65e5"),l.default.createElement("div",{key:t,className:(0,b.default)(w.default.commitGroup,0===t?w.default.top:"")},l.default.createElement("div",{className:w.default.date},l.default.createElement("span",{className:w.default.text},r),l.default.createElement("i",{className:w.default.dashed})),l.default.createElement("div",{className:w.default.processWrap},e.map(this.renderCommit,this)),!n.loading&&!n.data.list.find(function(e){return e.release})&&this.renderEmptyReleaseTips())}},{key:"renderEmptyReleaseTips",value:function(){return l.default.createElement("div",{className:w.default.emptyTips},l.default.createElement("h1",null,"\u8bf7\u9009\u62e9\u5de6\u4fa7\u7684\u63d0\u4ea4\u8282\u70b9\u53d1\u5e03\u65b0\u7248\u672c"),l.default.createElement("p",null,"\u5982\u679c\u60a8\u662f\u65b0\u63a5\u89e6\u7248\u672c\u53d1\u5e03\u7684\u8bdd\uff0c \u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u60a8\u9605\u8bfb",l.default.createElement("a",{className:w.default.link,href:"https://semver.org/lang/zh-CN/"},"\u300c\u8bed\u4e49\u5316\u7248\u672c\u300d"),"\u3002"),l.default.createElement("p",null,"\u7248\u672c\u53f7\u9012\u589e\u89c4\u5219\u5982\u4e0b\uff1a"),l.default.createElement("p",null,"1. \u4e3b\u7248\u672c\u53f7\uff1a\u5f53\u4f60\u505a\u4e86\u4e0d\u517c\u5bb9\u7684 API \u4fee\u6539\uff1b ",l.default.createElement("br",null),"2. \u6b21\u7248\u672c\u53f7\uff1a\u5f53\u4f60\u505a\u4e86\u5411\u4e0b\u517c\u5bb9\u7684\u529f\u80fd\u6027\u65b0\u589e\uff1b ",l.default.createElement("br",null),"3. \u4fee\u8ba2\u53f7\uff1a\u5f53\u4f60\u505a\u4e86\u5411\u4e0b\u517c\u5bb9\u7684\u95ee\u9898\u4fee\u6b63\u3002 ",l.default.createElement("br",null),"\u5148\u884c\u7248\u672c\u53f7\u53ca\u7248\u672c\u7f16\u8bd1\u4fe1\u606f\u53ef\u4ee5\u52a0\u5230\u201c\u4e3b\u7248\u672c\u53f7.\u6b21\u7248\u672c\u53f7.\u4fee\u8ba2\u53f7\u201d\u7684\u540e\u9762\uff0c\u4f5c\u4e3a\u5ef6\u4f38\u3002"))}},{key:"render",value:function(){var e=this,t=this.props,n=t.commits,a=t.project.project_path+"/flow";return l.default.createElement("div",{className:(0,b.default)(w.default.container,n.loading||n.data.list.find(function(e){return e.release})?"":w.default.hide)},l.default.createElement(c.default,{show:n.loading}),!n.loading&&this.renderCommits(),l.default.createElement("div",{className:w.default.pageBar},!n.loading&&n.data.page>1&&l.default.createElement(y.Link,{to:a+"?page="+(n.data.page-1)},l.default.createElement(f.default,{empty:!0},"\u4e0a\u4e00\u9875")),!n.loading&&n.data.list.length===n.data.pageSize&&l.default.createElement(y.Link,{to:a+"?page="+(n.data.page+1)},l.default.createElement(f.default,{empty:!0},"\u4e0b\u4e00\u9875"))),l.default.createElement(g.default,{modalShow:this.state.modalShow,onHideModel:this.onModalHide,onSubmit:this.onSubmitCreateRelease,title:this.state.title,onTitleChange:function(t){return e.setState({title:t.target.value})}}))}}]),t}(),a.propTypes={project:u.default.object,depot:u.default.object,flowCommits:u.default.func,pubRelease:u.default.func,phaseChangeStatus:u.default.func,phaseAutoSkip:u.default.func,phaseAutoSkipCancel:u.default.func,phaseAddMark:u.default.func,commits:u.default.object,location:u.default.object},r);t.default=(0,s.default)(function(e){return{commits:e.FLOW.commits}},{flowCommits:d.flowCommits,pubRelease:d.pubRelease,phaseChangeStatus:d.phaseChangeStatus,phaseAddMark:d.phaseAddMark,phaseAutoSkip:d.phaseAutoSkip,phaseAutoSkipCancel:d.phaseAutoSkipCancel})(O)},3428:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=m(i),u=m(n(0)),s=m(n(1957)),c=m(n(1959)),f=n(112),d=n(1543),p=m(n(2242));function m(e){return e&&e.__esModule?e:{default:e}}var h=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.phaseAutoSkip=function(e){n.props.phaseAutoSkip(e,"release_flow").then(function(){return(0,f.success)("\u8bbe\u7f6e\u8df3\u8fc7\u6210\u529f")})},n.state={markIcon:"",markUrl:"",markName:""},n.onModalHide=n.onModalHide.bind(n),n.changeStatus=n.changeStatus.bind(n),n.onSubmitAddMark=n.onSubmitAddMark.bind(n),n.autoSkipCancel=n.autoSkipCancel.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"onModalHide",value:function(){this.setState({modalShow:!1})}},{key:"onSubmitAddMark",value:function(){var e=this;this.props.phaseAddMark(this.props.release.commit_sha,{markable_id:this.state.markPhaseId,markable_type:"Flow",icon:this.state.markIcon,url:this.state.markUrl,name:this.state.markName},"release_flow").then(function(){(0,f.success)("\u63d0\u4ea4\u6210\u529f"),e.setState({markIcon:"",markUrl:"",markName:"",markPhaseId:0})}),this.setState({modalShow:!1})}},{key:"changeStatus",value:function(e,t,n,a){a===d.PHASE_STATUS.SKIPPED&&confirm("\u8bf7\u95ee\u662f\u5426\u5e0c\u671b\u8be5\u9636\u6bb5\u603b\u662f\u81ea\u52a8\u8df3\u8fc7")&&this.phaseAutoSkip(t),this.props.phaseChangeStatus(this.props.release.commit_sha,e,a,"release_flow").then(function(){return(0,f.success)("\u63d0\u4ea4\u6210\u529f")})}},{key:"autoSkipCancel",value:function(e){this.props.phaseAutoSkipCancel(e,"release_flow").then(function(){return(0,f.success)("\u8df3\u8fc7\u6210\u529f")})}},{key:"getPreviousPhaseStatus",value:function(e,t){return t.index>1?e.slice(0,t.index-1).map(function(e){return e.status}):""}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{className:p.default.phases},this.props.phases.map(function(t){return l.default.createElement(s.default,{key:t.id,phase:t,previousPhaseStatus:e.getPreviousPhaseStatus(e.props.phases,t),commitSha:e.props.release.commit_sha,refName:e.props.release.tag_name,autoSkipPhases:e.props.autoSkipPhases,phaseAutoSkip:e.phaseAutoSkip,autoSkipCancel:e.autoSkipCancel,changeStatus:e.changeStatus,addMark:function(){return e.setState({modalShow:!0,markPhaseId:t.id})},getActiveIndex:e.props.getActiveIndex})}),l.default.createElement(c.default,{modalShow:this.state.modalShow,onHideModel:this.onModalHide,onSubmit:this.onSubmitAddMark,name:this.state.markName,onNameChange:function(t){return e.setState({markName:t.target.value})},icon:this.state.markIcon,onIconChange:function(t){return e.setState({markIcon:t.target.value})},url:this.state.markUrl,onUrlChange:function(t){return e.setState({markUrl:t.target.value})}}))}}]),t}(),a.propTypes={phases:u.default.array,release:u.default.object,phaseChangeStatus:u.default.func,phaseAddMark:u.default.func,phaseAutoSkip:u.default.func,phaseAutoSkipCancel:u.default.func,autoSkipPhases:u.default.array,getActiveIndex:u.default.func},r);t.default=h},3429:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(2)),r=s(n(0)),o=s(n(151)),i=s(n(8)),l=s(n(2213)),u=s(n(2241));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){return a.default.createElement("div",{className:u.default.phase},a.default.createElement("img",{src:n(1958),className:u.default.next}),a.default.createElement("div",{className:(0,i.default)(u.default.step,e.status,(t={},r=u.default.hasIcon,s=e.icon,r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t))},e.text),e.icon&&a.default.createElement("div",{className:(0,i.default)(u.default.right,e.status)},!e.up&&a.default.createElement(o.default,{className:u.default.icon}),e.up&&a.default.createElement(l.default,{className:u.default.icon})));var t,r,s};c.propTypes={text:r.default.string,status:r.default.string,icon:r.default.bool,up:r.default.bool},c.defaultProps={text:"\u6784\u5efa\u6210\u529f",status:"success",icon:!0,up:!1},t.default=c},3431:function(e,t,n){e.exports={"add-mark":"add-mark-1R8",addMark:"add-mark-1R8",name:"name-1KP","last-input":"last-input-Poy",lastInput:"last-input-Poy"}},3434:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=c(i),u=c(n(3435)),s=c(n(3436));function c(e){return e&&e.__esModule?e:{default:e}}var f={pending:"#FFF",success:"#37BD78",skipped:"#F2C143",failed:"#F46365",canceled:"#F2C143",base:"#989CA2"},d=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getRingList=function(){var e=n.props.phases,t=[{start:90,end:270},{start:0,end:90},{start:270,end:360}];return e.length!==t.length?t.map(function(e){return e.bg="pending",e}):e.every(function(e){return"pending"===e.status})?t.map(function(e){return e.bg=f.base,e}):t.map(function(t,n){return t.bg=f[e[n].status],t})},n.state={},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default.Component),o(t,[{key:"render",value:function(){var e=this.props.children;return l.default.createElement("div",{className:s.default.wrap},l.default.createElement("div",{className:s.default.canvasWrap},l.default.createElement(u.default,{list:this.getRingList()})),e)}}]),t}(),a.propTypes={children:i.PropTypes.any,phases:i.PropTypes.arrayOf(i.PropTypes.shape({status:i.PropTypes.string.isRequired}))},a.defaultProps={phases:[]},r);t.default=d},3435:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(2),u=c(l),s=c(n(169));function c(e){return e&&e.__esModule?e:{default:e}}var f=48,d=4,p=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.call(n),n.state={},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),i(t,[{key:"componentDidMount",value:function(){this.renderRing(this.props)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.wrapSize,a=t.width,r=t.list;n===e.wrapSize&&a===e.width&&(0,s.default)(r,e.list)||(this.resetRing(),this.renderRing(e))}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.wrapSize;return u.default.createElement("canvas",{className:t,width:n,height:n,ref:this.onRef})}}]),t}(),a.propTypes={className:l.PropTypes.string,wrapSize:l.PropTypes.number.isRequired,width:l.PropTypes.number.isRequired,list:l.PropTypes.arrayOf(l.PropTypes.shape({start:l.PropTypes.number.isRequired,end:l.PropTypes.number.isRequired,bg:l.PropTypes.string.isRequired}))},a.defaultProps={wrapSize:f,width:d,list:[]},o=function(){var e=this;this.onRef=function(t){e.canvas=t},this.resetRing=function(){var t=e.canvas.getContext("2d"),n=e.props.wrapSize;t.clearRect(0,0,n,n)},this.renderRing=function(t){var n=t.wrapSize,a=t.list,r=t.width;if(0!==a.length){var o=e.canvas.getContext("2d");a.forEach(function(e){o.beginPath(),o.arc(n/2,n/2,(n-r)/2,2*Math.PI*(e.start/360),2*Math.PI*(e.end/360),!1),o.lineWidth=r,o.strokeStyle=e.bg,o.stroke()})}}},r);t.default=p},3436:function(e,t,n){e.exports={wrap:"wrap-2-9",canvasWrap:"canvasWrap-3t9"}},3438:function(e,t,n){e.exports={"commit-point":"commit-point-4d-",commitPoint:"commit-point-4d-",background:"background-1LL",black:"black-26A",green:"green-35w",icon:"icon-3l8",empty:"empty-1Mc",left:"left-qjA","empty-commit":"empty-commit-1as",emptyCommit:"empty-commit-1as","commit-card":"commit-card-2zc",commitCard:"commit-card-2zc",author:"author-2na",vline:"vline-30m",time:"time-2WM",msg:"msg-fpz",sha:"sha-MzC",short:"short-1qt","drop-down":"drop-down-t0y",dropDown:"drop-down-t0y",down:"down-328"}},3440:function(e,t,n){e.exports={"new-release":"new-release-1tk",newRelease:"new-release-1tk","tip-message":"tip-message-1QC",tipMessage:"tip-message-1QC"}},3442:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=w(i),u=w(n(0)),s=w(n(545)),c=n(168),f=w(n(263)),d=w(n(262)),p=w(n(544)),m=w(n(1483)),h=w(n(1960)),y=w(n(2244)),v=n(1543),E=w(n(8)),b=n(1694),g=w(n(3451));function w(e){return e&&e.__esModule?e:{default:e}}var _=[{id:0,status:"pending",status_desc:"\u7b49\u5f85\u6784\u5efa"},{id:1,status:"pending",status_desc:"\u7b49\u5f85\u6d4b\u8bd5"},{id:2,status:"pending",status_desc:"\u7b49\u5f85\u90e8\u7f72"}],P=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={page:e.location.query.page||1},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"componentDidMount",value:function(){this.props.flowFlows(this.state.page)}},{key:"componentWillReceiveProps",value:function(e){var t=e.location.query.page;t!==this.props.location.query.page&&this.props.flowFlows(t)}}]),o(t,[{key:"renderPhase",value:function(e,t){var n=e.index?e.index-1:e.id;return l.default.createElement("li",{key:e.id},0!==t&&l.default.createElement("i",{className:["skipped","success"].some(function(t){return e.status===t})?g.default.pass:g.default.nopass}),l.default.createElement(h.default,{status:e.status,type:Object.keys(v.TYPE_ENUM)[n]}))}},{key:"getLine",value:function(e){if(e.release&&e.release.phases&&e.release.phases.length>0){var t=e.release.phases.map(function(e){return e.status});if(3===t.length&&"success"===t[1])return"success"===t[2]?"all":"half"}return"zero"}},{key:"renderFlow",value:function(e){return l.default.createElement("div",{key:e.iid,className:g.default.flow},l.default.createElement("h2",null,l.default.createElement(c.Link,{to:this.props.project.project_path+"/flow/"+e.iid},e.title)),l.default.createElement("div",{className:g.default.infos},l.default.createElement("div",null,l.default.createElement(c.Link,{to:e.owner.path},l.default.createElement(d.default,{src:e.owner.avatar,size:"tiny"}),e.owner.name),l.default.createElement("span",{className:g.default.time},"\u521b\u5efa\u4e8e",(0,f.default)(new Date(e.created_at)).format("YYYY \u5e74 MM \u6708 DD \u65e5")),l.default.createElement("span",{className:g.default.branchLabel},l.default.createElement(m.default,null),e.ref_name)),l.default.createElement("div",null,l.default.createElement(y.default,{list:e.release?e.release.phases:new Array(3).fill({status:"pending"})}))),l.default.createElement("ul",{className:(0,E.default)(g.default.phases,this.getLine(e))},e.release&&e.release.phases&&e.release.phases.length>0&&e.release.phases.map(this.renderPhase),!(e.release&&e.release.phases&&e.release.phases.length>0)&&_.map(this.renderPhase)))}},{key:"renderEmpty",value:function(){return l.default.createElement("div",{className:g.default.empty},l.default.createElement("img",{src:n(3453),alt:"concurrent"}),l.default.createElement("div",{className:g.default.header},"\u6b22\u8fce\u4f7f\u7528\u5e76\u884c\u5f00\u53d1\u6a21\u578b\uff5e"),l.default.createElement("div",{className:g.default.body},"\u5e76\u884c\u5f00\u53d1\u6a21\u578b\u7531\u591a\u4e2a\u5f00\u53d1\u7ebf\u6784\u6210\uff0c\u5c06\u4e1a\u52a1\u62c6\u5206\u4e3a\u591a\u4e2a\u4ea7\u54c1\u7ebf\uff0c\u6bcf\u4e2a\u4ea7\u54c1\u7ebf\u90fd\u9700\u65b0\u5efa\u4e00\u6761\u5f00\u53d1\u7ebf\u3002\u6bcf\u6761\u5f00\u53d1\u7ebf\u4e0b\u53ef\u6839\u636e\u4ea7\u54c1\u529f\u80fd\u521b\u5efa\u591a\u4e2a\u529f\u80fd\u7ebf\uff0c\u6bcf\u6761\u529f\u80fd\u7ebf\u90fd\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c\u5f00\u53d1\u3002"),l.default.createElement(p.default,{size:"big",onClick:this.props.addFlow},"\u65b0\u5efa\u5f00\u53d1\u7ebf"))}},{key:"render",value:function(){var e=this.props.flows;return l.default.createElement("div",{className:g.default.container},e.data.list?0===e.data.list.length?this.renderEmpty():e.data.list.map(this.renderFlow,this):null)}}]),t}(),a.propTypes={project:u.default.object,depot:u.default.object,location:u.default.object,flowFlows:u.default.func,flows:u.default.object,addFlow:u.default.func},r);t.default=(0,s.default)(function(e){return{flows:e.FLOW.flows}},{flowFlows:b.flowFlows,phaseChangeStatus:b.phaseChangeStatus,phaseAddMark:b.phaseAddMark,phaseAutoSkip:b.phaseAutoSkip,phaseAutoSkipCancel:b.phaseAutoSkipCancel})(P)},3443:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STATUS_ENUM=t.TYPE_ENUM=void 0;var a=c(n(2)),r=c(n(1733)),o=c(n(1580)),i=c(n(3444)),l=c(n(3445)),u=c(n(3446)),s=c(n(1796));function c(e){return e&&e.__esModule?e:{default:e}}var f,d=(f={commit:{icon:a.default.createElement(o.default,null),text:"\u63d0\u4ea4"},merge:{icon:a.default.createElement(r.default,null),text:"\u5408\u5e76"},review:{icon:a.default.createElement(s.default,null),text:"\u8bc4\u5ba1"},build:{icon:a.default.createElement(u.default,null),text:"\u6784\u5efa"},test:{icon:a.default.createElement(l.default,null),text:"\u6d4b\u8bd5"},deploy:{icon:a.default.createElement(i.default,null),text:"\u90e8\u7f72"}},["\u63d0\u4ea4","\u5408\u5e76","\u8bc4\u5ba1","\u6784\u5efa","\u6d4b\u8bd5","\u90e8\u7f72"].forEach(function(e,t){f[e]=f[Object.keys(f)[t]]}),f);t.TYPE_ENUM=d,t.STATUS_ENUM={success:{status:"success",dec:"\u6210\u529f"},pending:{status:"pending",dec:"\u7b49\u5f85"},failed:{status:"failed",dec:"\u5931\u8d25"},canceled:{status:"canceled",dec:"\u53d6\u6d88"},skipped:{status:"skipped",dec:"\u8df3\u8fc7"}}},3447:function(e,t,n){e.exports={wrap:"wrap-34M",iconWrap:"iconWrap-2sK",success:"success-1Rk",white:"white-1Dv",failed:"failed-gml",skipped:"skipped-3mL"}},3449:function(e,t,n){e.exports={wrap:"wrap-3td",phases:"phases-AmF",phase:"phase-3Xl",dec:"dec-1s-",finished:"finished-1iF"}},3451:function(e,t,n){e.exports={container:"container-2c_",flow:"flow-34H",infos:"infos-3JR",time:"time-1bx","branch-label":"branch-label-3p3",branchLabel:"branch-label-3p3",phases:"phases-INk",pass:"pass-BLr",nopass:"nopass-qQL",phase:"phase-LH9",empty:"empty-1iA",header:"header-lQ3",body:"body-1Ai"}},3453:function(e,t,n){e.exports=n.p+"static/media/concurrent.58f48f3c.png"},3454:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=p(i),u=p(n(0)),s=p(n(549)),c=p(n(261)),f=p(n(544)),d=p(n(3455));function p(e){return e&&e.__esModule?e:{default:e}}var m=(r=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"render",value:function(){return l.default.createElement(s.default,{show:this.props.modalShow,onHide:this.props.onHideModal,style:{width:420},className:d.default.addFlow},l.default.createElement(s.default.Header,null,"\u65b0\u5efa\u5f00\u53d1\u7ebf"),l.default.createElement(s.default.Body,null,l.default.createElement("div",{className:d.default.name},"\u529f\u80fd\u7ebf\u5206\u652f"),l.default.createElement("div",{className:d.default.branch},l.default.createElement("span",{className:d.default.pre},"coding-flow/"),l.default.createElement(c.default,{placeholder:"\u5206\u652f\u540d",size:"large",onChange:this.props.onBranchChange,value:this.props.branch})),l.default.createElement("div",{className:d.default.name},"\u5f00\u53d1\u7ebf\u540d\u79f0"),l.default.createElement(c.default,{placeholder:"\u5f00\u53d1\u7ebf\u540d\u79f0",size:"large",onChange:this.props.onFlowNameChange,value:this.props.flowName,className:d.default.lastInput})),l.default.createElement(s.default.Footer,null,l.default.createElement(f.default,{onClick:this.props.onSubmit},"\u786e\u8ba4\u65b0\u5efa"),l.default.createElement(f.default,{onClick:this.props.onHideModal,empty:!0},"\u53d6\u6d88")))}}]),t}(),a.propTypes={modalShow:u.default.bool,onHideModal:u.default.func,onSubmit:u.default.func,branch:u.default.string,onBranchChange:u.default.func,flowName:u.default.string,onFlowNameChange:u.default.func},r);t.default=m},3455:function(e,t,n){e.exports={"add-flow":"add-flow-2Vz",addFlow:"add-flow-2Vz",branch:"branch-1Mp",pre:"pre-3ew",name:"name-20J","last-input":"last-input-3rl",lastInput:"last-input-3rl"}},3457:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(2),u=F(l),s=F(n(0)),c=F(n(545)),f=n(168),d=F(n(1788)),p=F(n(76)),m=F(n(8)),h=n(1694),y=F(n(698)),v=F(n(262)),E=F(n(1483)),b=F(n(263)),g=F(n(3458)),w=F(n(1795)),_=F(n(1957)),P=F(n(2243)),O=F(n(1959)),k=F(n(1960)),T=n(112),S=n(1543),N=n(226),C=F(n(2189)),I=F(n(1784)),j=F(n(3465));function F(e){return e&&e.__esModule?e:{default:e}}var A=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.renderNoticeComponent=function(){var e=a.props.flow;return u.default.createElement("div",{className:j.default.noticeWrap},u.default.createElement("div",{className:j.default.emptyCommit},u.default.createElement("i",{className:j.default.greyBorder}),u.default.createElement("span",{className:j.default.addIconWrap},u.default.createElement(w.default,{emptyCommit:!0}),u.default.createElement("div",{className:j.default.tips},u.default.createElement("span",{className:j.default.header},"\u8bf7\u6309\u5982\u4e0b\u64cd\u4f5c\u4e3a\u6b64\u5f00\u53d1\u7ebf\u6dfb\u52a0\u4ee3\u7801\u63d0\u4ea4"),u.default.createElement("h2",null,"\u65b9\u6848\u4e00\uff1a"),u.default.createElement("span",null,"\u5728\u4e0b\u65b9\u65b0\u5efa\u5f00\u53d1\u7ebf"),u.default.createElement("h2",null,"\u65b9\u6848\u4e00\uff1a"),u.default.createElement("span",null,"\u5728\u672c\u5730 git \u5ba2\u6237\u7aef\u4e2d\u5207\u6362\u5230"," ",u.default.createElement("pre",{className:j.default.ref},e.data.ref_name)," ","\u5206\u652f\uff0c\u63d0\u4ea4\u65b0\u7684\u4ee3\u7801\u3002"),u.default.createElement("pre",null,"git fetch"),u.default.createElement("pre",{title:"git checkout "+e.data.ref_name},"git checkout "+e.data.ref_name),u.default.createElement("pre",null,"Write your codes."),u.default.createElement("pre",null,'git commit -m "commit message"'),u.default.createElement("pre",{title:"git push origin "+e.data.ref_name},"git push origin "+e.data.ref_name))),u.default.createElement("span",{className:j.default.example},[S.TYPE_ENUM.build,S.TYPE_ENUM.test,S.TYPE_ENUM.deploy].map(function(e,t){return[u.default.createElement("img",{src:n(1958),alt:"next",key:t+"img"}),u.default.createElement(k.default,{type:e,status:S.STATUS_ENUM.pending,key:t+"tip"})]}))))},a.renderFlowList=function(){var e=a.props.flow;return u.default.createElement("div",{className:j.default.items},u.default.createElement("div",{className:j.default.commitsContainer},e.data.commits.sort(function(e,t){return e.commitTime-t.commitTime}).map(a.renderCommit,a)),u.default.createElement("div",{className:j.default.phaseContainer},e.data.release&&e.data.release.phases.map(function(t,n){return u.default.createElement(_.default,{key:t.id,phase:t,commitSha:e.data.release.commit_sha,refName:e.data.release.tag_name,autoSkipPhases:e.data.autoSkipPhases,previousPhaseStatus:e.data.release.phases[n-1]&&e.data.release.phases[n-1].status||"",phaseAutoSkip:a.phaseAutoSkip,autoSkipCancel:a.autoSkipCancel,changeStatus:a.changeStatus,addMark:function(){return a.setState({markModalShow:!0,markPhaseId:t.id})}})})),u.default.createElement("div",{className:j.default.phaseContainer},!e.data.release&&e.data.current_sha!==e.data.start_sha&&u.default.createElement(_.default,{phase:{status_desc:"\u63d0\u4ea4\u53d1\u5e03",status:"pending"},canPubRelease:!0,pubRelease:function(){a.setState({releaseModalShow:!0,commit_sha:e.data.commits[0].commitId,title:""})},previousPhaseStatus:""}),!e.data.release&&e.data.current_sha===e.data.start_sha&&u.default.createElement(_.default,{phase:{status_desc:"\u63d0\u4ea4\u53d1\u5e03",status:"pending"},icon:!1,previousPhaseStatus:"pending"}),!e.data.release&&u.default.createElement(_.default,{phase:{status_desc:"\u7b49\u5f85\u6d4b\u8bd5",status:"pending"},icon:!1,previousPhaseStatus:"pending"}),!e.data.release&&u.default.createElement(_.default,{phase:{status_desc:"\u7b49\u5f85\u5408\u5e76",status:"pending"},icon:!1,previousPhaseStatus:"pending"})))},a.state={releaseModalShow:!1,markModalShow:!1,title:"",commit_sha:"",markName:"",markUrl:"",markIcon:"",markPhaseId:0},a.fetchFlowDetail=a.fetchFlowDetail.bind(a),a.fetchListFeatureFlow=a.fetchListFeatureFlow.bind(a),a.onSubmitCreateRelease=a.onSubmitCreateRelease.bind(a),a.onReleaseModalHide=a.onReleaseModalHide.bind(a),a.changeStatus=a.changeStatus.bind(a),a.phaseAutoSkip=a.phaseAutoSkip.bind(a),a.autoSkipCancel=a.autoSkipCancel.bind(a),a.onHideMarkModel=a.onHideMarkModel.bind(a),a.onSubmitAddMark=a.onSubmitAddMark.bind(a),a.onFlowPage=a.onFlowPage.bind(a),a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),i(t,[{key:"componentDidMount",value:function(){var e=this.props.params;(0,p.default)(e)||(this.fetchFlowDetail(this.props),this.fetchListFeatureFlow(this.props))}},{key:"componentWillReceiveProps",value:function(e){e.params.iid!==this.props.params.iid&&(this.fetchFlowDetail(e),this.fetchListFeatureFlow(e)),e.location.query.tag_name!==this.props.location.query.tag_name&&this.fetchFlowDetail(e)}},{key:"fetchFlowDetail",value:function(e){e.fetchFlowDetail(e.params.iid,e.location.query.tag_name||"")}},{key:"fetchListFeatureFlow",value:function(e){e.listFeatureFlow&&e.listFeatureFlow(e.params&&e.params.iid||e.flow.data.iid,"all",e.location.query.page||1)}},{key:"phaseAutoSkip",value:function(e){this.props.phaseAutoSkip(e,"merge_flow").then(function(){return(0,T.success)("\u8bbe\u7f6e\u8df3\u8fc7\u6210\u529f")})}},{key:"autoSkipCancel",value:function(e){this.props.phaseAutoSkipCancel(e,"merge_flow").then(function(){return(0,T.success)("\u8bbe\u7f6e\u8df3\u8fc7\u6210\u529f")})}},{key:"changeStatus",value:function(e,t,n,a){this.props.phaseChangeStatus(n,e,a,"merge_flow").then(function(){return(0,T.success)("\u63d0\u4ea4\u6210\u529f")}),a===S.PHASE_STATUS.SKIPPED&&confirm("\u8bf7\u95ee\u662f\u5426\u5e0c\u671b\u8be5\u9636\u6bb5\u603b\u662f\u81ea\u52a8\u8df3\u8fc7")&&this.props.phaseAutoSkip(t,"merge_flow").then(function(){return(0,T.success)("\u8bbe\u7f6e\u8df3\u8fc7\u6210\u529f")})}},{key:"onHideMarkModel",value:function(){this.setState({markModalShow:!1})}},{key:"onSubmitAddMark",value:function(){var e=this;this.props.phaseAddMark(0,{markable_id:this.state.markPhaseId,markable_type:"Flow",icon:this.state.markIcon,url:this.state.markUrl,name:this.state.markName},"merge_flow").then(function(){(0,T.success)("\u63d0\u4ea4\u6210\u529f"),e.setState({markIcon:"",markUrl:"",markName:"",markPhaseId:0})}),this.setState({markModalShow:!1})}},{key:"onReleaseModalHide",value:function(){this.setState({releaseModalShow:!1,title:"",commit_sha:""})}},{key:"onSubmitCreateRelease",value:function(){var e=this;this.props.pubRelease({flow_iid:this.props.flow.data.iid,commit_sha:this.state.commit_sha,tag_name:this.state.title}).then(function(){e.setState({releaseModalShow:!1,title:"",commit_sha:""})})}},{key:"renderCommit",value:function(e,t,n){var a=this.props.flow;return u.default.createElement("div",{className:j.default.commitContainer,key:t},u.default.createElement("i",{className:j.default.greyBorder}),u.default.createElement(w.default,{key:e.commitId,className:j.default.commit,showCommitCard:!0,projectPath:this.props.currentProject.project_path,commit:e,empty:!0,placement:"down",isShowRing:{condition:n.length-1===t,data:a.data.release&&a.data.release.phases}}))}},{key:"onFlowPage",value:function(e){this.props.router.push(o({},this.props.location,{query:o({},this.props.location.query,{tag_name:e})}))}},{key:"render",value:function(){var e=this,t=this.props.flow;return t.loading?u.default.createElement("div",{className:j.default.container},u.default.createElement(y.default,{show:!0})):u.default.createElement("div",{className:j.default.container},u.default.createElement("div",{className:j.default.header},u.default.createElement(f.Link,{to:this.props.currentProject.project_path+"/flow"},"\u6240\u6709\u5f00\u53d1\u7ebf"),u.default.createElement(d.default,{className:j.default.icon}),"\u5f00\u53d1\u7ebf\u8be6\u60c5"),u.default.createElement("div",{className:j.default.title},u.default.createElement("h1",null,u.default.createElement("img",{src:n(3467)}),t.data.title),u.default.createElement("div",{className:j.default.infos},u.default.createElement(f.Link,{to:t.data.owner.path},u.default.createElement(v.default,{src:t.data.owner.avatar,size:"tiny"}),t.data.owner.name),u.default.createElement("span",{className:j.default.time},"\u521b\u5efa\u4e8e",(0,b.default)(new Date(t.data.created_at)).format("YYYY \u5e74 MM \u6708 DD \u65e5")),u.default.createElement("span",{className:j.default.branchLabel},u.default.createElement(E.default,null),t.data.ref_name))),u.default.createElement("div",{className:j.default.flow,style:t.data.current_sha===t.data.start_sha?{height:500}:null},u.default.createElement("div",{className:j.default.pager},t.data.previousReleaseTagName&&t.data.previousReleaseTagName.length>0&&u.default.createElement("div",{onClick:function(){return e.onFlowPage(t.data.previousReleaseTagName)},className:j.default.prev},u.default.createElement(C.default,null),"\u66f4\u65e9"),t.data.nextReleaseTagName&&t.data.nextReleaseTagName.length>0&&u.default.createElement("div",{onClick:function(){return e.onFlowPage(t.data.nextReleaseTagName)},className:j.default.next},"\u66f4\u665a",u.default.createElement(I.default,null))),u.default.createElement("div",{className:(0,m.default)(j.default.contentContainer,j.default.emptyContainer)},0===t.data.commits.length?this.renderNoticeComponent():this.renderFlowList())),u.default.createElement(g.default,{projectPath:this.props.currentProject.project_path,addFeatureFlow:this.props.addFeatureFlow,flow:t,featureFlows:this.props.featureFlows,location:this.props.location,push:this.props.router.push,fetchListFeatureFlow:this.fetchListFeatureFlow}),u.default.createElement(P.default,{modalShow:this.state.releaseModalShow,onHideModel:this.onReleaseModalHide,onSubmit:this.onSubmitCreateRelease,title:this.state.title,onTitleChange:function(t){return e.setState({title:t.target.value})}}),u.default.createElement(O.default,{modalShow:this.state.markModalShow,onHideModel:this.onHideMarkModel,onSubmit:this.onSubmitAddMark,name:this.state.markName,onNameChange:function(t){return e.setState({markName:t.target.value})},icon:this.state.markIcon,onIconChange:function(t){return e.setState({markIcon:t.target.value})},url:this.state.markUrl,onUrlChange:function(t){return e.setState({markUrl:t.target.value})}}))}}]),t}(),a.propTypes={params:s.default.object,currentProject:s.default.object,currentDepot:s.default.object,fetchFlowDetail:s.default.func,addFeatureFlow:s.default.func,listFeatureFlow:s.default.func,flow:s.default.object,featureFlows:s.default.object,pubRelease:s.default.func,phaseChangeStatus:s.default.func,phaseAutoSkip:s.default.func,phaseAutoSkipCancel:s.default.func,phaseAddMark:s.default.func,location:s.default.object,router:s.default.shape({push:s.default.func})},r);t.default=(0,c.default)(function(e){var t=e.FLOW;return{flow:t.flow,featureFlows:t.featureFlows}},{fetchFlowDetail:h.fetchFlowDetail,addFeatureFlow:h.addFeatureFlow,listFeatureFlow:h.listFeatureFlow,pubRelease:h.pubRelease,phaseChangeStatus:h.phaseChangeStatus,phaseAddMark:h.phaseAddMark,phaseAutoSkip:h.phaseAutoSkip,phaseAutoSkipCancel:h.phaseAutoSkipCancel,push:N.push})(A)},3458:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(2),u=k(l),s=k(n(0)),c=k(n(544)),f=k(n(3459)),d=n(112),p=k(n(698)),m=n(168),h=k(n(1483)),y=k(n(3462)),v=k(n(263)),E=k(n(262)),b=k(n(8)),g=k(n(1466)),w=k(n(1455)),_=k(n(1960)),P=k(n(3463)),O=n(1543);function k(e){return e&&e.__esModule?e:{default:e}}var T=g.default.RadioGroup,S=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onRadioGroupChange=function(e,t){var a=void 0;n.props.location.query.type!==t&&(a=t),n.props.push(o({},n.props.location,{query:o({},n.props.location.query,{page:1,type:a})}))},n.state={addFeatureFlowModalShow:!1,addFeatureFlowName:"",addFeatureFlowBranch:"",filter:e.location.query.type||O.FEATURE_FILTER_LIST[0].type},n.onAddFeatureFlowModalHide=n.onAddFeatureFlowModalHide.bind(n),n.onSubmitAddFeatureFlow=n.onSubmitAddFeatureFlow.bind(n),n.renderFeatureFlowList=n.renderFeatureFlowList.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),i(t,[{key:"componentWillReceiveProps",value:function(e){e.location.query.page!==this.props.location.query.page&&this.props.fetchListFeatureFlow(o({},e,{location:o({},e.location,{query:o({},e.location.query,{type:"all"})})})),e.location.query.type!==this.props.location.query.type&&this.setState({filter:e.location.query.type})}},{key:"onAddFeatureFlowModalHide",value:function(){this.setState({addFeatureFlowModalShow:!1})}},{key:"onSubmitAddFeatureFlow",value:function(){var e=this;this.props.addFeatureFlow(this.props.flow.data.iid,this.state.addFeatureFlowBranch,this.state.addFeatureFlowName).then(function(){(0,d.success)("\u6dfb\u52a0\u6210\u529f"),e.setState({addFeatureFlowModalShow:!1,addFeatureFlowName:"",addFeatureFlowBranch:""})})}},{key:"empty",value:function(){var e=this;return u.default.createElement("div",{className:P.default.featureFlowListContainer},u.default.createElement("h1",null,"\u529f\u80fd\u7ebf"),u.default.createElement("div",{className:P.default.empty},u.default.createElement("div",{className:P.default.tip},"\u6682\u65e0\u529f\u80fd\u7ebf"),u.default.createElement(c.default,{size:"big",onClick:function(){return e.setState({addFeatureFlowModalShow:!0})}},"\u65b0\u5efa\u529f\u80fd\u7ebf")),u.default.createElement(f.default,{modalShow:this.state.addFeatureFlowModalShow,onHideModal:this.onAddFeatureFlowModalHide,branch:this.state.addFeatureFlowBranch,onBranchChange:function(t){return e.setState({addFeatureFlowBranch:t.target.value})},flowName:this.state.addFeatureFlowName,onFlowNameChange:function(t){return e.setState({addFeatureFlowName:t.target.value})},onSubmit:this.onSubmitAddFeatureFlow}))}},{key:"renderFeatureFlow",value:function(e){var t=this.props.projectPath+"/flow/"+this.props.flow.data.iid+"/feature/"+e.iid,n=e.mergeRequests.length>0?e.mergeRequests[e.mergeRequests.length-1]:void 0;return u.default.createElement("div",{key:e.iid,className:P.default.featureFlowItem},u.default.createElement("div",{className:P.default.branchContainer},u.default.createElement("h2",null,u.default.createElement(m.Link,{to:t},e.title)),u.default.createElement("div",{className:(0,b.default)(P.default.infos,"clearfix")},u.default.createElement(m.Link,{to:e.owner.path},u.default.createElement(E.default,{src:e.owner.avatar,size:"xsmall"}),e.owner.name),u.default.createElement("span",{className:P.default.time},"\u521b\u5efa\u4e8e",(0,v.default)(new Date(e.created_at)).format("YYYY \u5e74 MM \u6708 DD \u65e5")," "),u.default.createElement("span",{className:P.default.branchLabel},u.default.createElement(h.default,null),e.ref_name))),u.default.createElement("div",{className:P.default.statusContainer},n&&n.phases.length>0&&n.phases.map(function(e,t){return u.default.createElement("span",{key:t,className:P.default.statusItem},u.default.createElement(_.default,{status:e.status,text:e.status_desc,type:e.name,feature:"white"}),u.default.createElement("i",{className:P.default.next},u.default.createElement(y.default,null)))})))}},{key:"renderFeatureFlowList",value:function(){var e=this;return this.props.featureFlows.data.list.filter(function(t){return e.state.filter===O.FEATURE_FILTER_LIST[0].type?0===t.finished_at:e.state.filter!==O.FEATURE_FILTER_LIST[1].type||t.finished_at>0}).map(this.renderFeatureFlow,this)}},{key:"render",value:function(){var e=this,t=this.props.featureFlows,n=this.props.location.query;return t.loading?u.default.createElement("div",{className:P.default.featureFlowContainer},u.default.createElement("h1",null,"\u529f\u80fd\u7ebf"),u.default.createElement(p.default,{show:!0})):0===t.data.list.length?this.empty():u.default.createElement("div",{className:P.default.featureFlowListContainer},u.default.createElement("h1",null,"\u529f\u80fd\u7ebf"),u.default.createElement(c.default,{className:P.default.newBtn,onClick:function(){return e.setState({addFeatureFlowModalShow:!0})}},"\u65b0\u5efa\u529f\u80fd\u7ebf"),u.default.createElement(T,{name:"status",type:"button",value:n.type||"unfinished",onChange:this.onRadioGroupChange},O.FEATURE_FILTER_LIST.map(function(e,t){return u.default.createElement(g.default,{value:e.type,key:t},e.text)})),this.renderFeatureFlowList(),!this.props.featureFlows.loading&&u.default.createElement(w.default,{pager:{page:parseInt(n.page,10)||t.data.page,pageSize:parseInt(n.pageSize,10)||t.data.pageSize,totalPage:t.data.totalPage,totalRow:t.data.totalRow},onChange:function(t){e.props.push(o({},e.props.location,{query:o({},e.props.location.query,{page:t})}))}}),u.default.createElement(f.default,{modalShow:this.state.addFeatureFlowModalShow,onHideModal:this.onAddFeatureFlowModalHide,branch:this.state.addFeatureFlowBranch,onBranchChange:function(t){return e.setState({addFeatureFlowBranch:t.target.value})},flowName:this.state.addFeatureFlowName,onFlowNameChange:function(t){return e.setState({addFeatureFlowName:t.target.value})},onSubmit:this.onSubmitAddFeatureFlow}))}}]),t}(),a.propTypes={flow:s.default.object,addFeatureFlow:s.default.func,featureFlows:s.default.object,projectPath:s.default.string,location:s.default.object,push:s.default.func,fetchListFeatureFlow:s.default.func.isRequired},r);t.default=S},3459:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=p(i),u=p(n(0)),s=p(n(549)),c=p(n(261)),f=p(n(544)),d=p(n(3460));function p(e){return e&&e.__esModule?e:{default:e}}var m=(r=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"render",value:function(){return l.default.createElement(s.default,{show:this.props.modalShow,onHide:this.props.onHideModal,style:{width:420},className:d.default.addFeatureFlow},l.default.createElement(s.default.Header,null,"\u65b0\u5efa\u529f\u80fd\u7ebf"),l.default.createElement(s.default.Body,null,l.default.createElement("div",{className:d.default.name},"\u529f\u80fd\u7ebf\u5206\u652f"),l.default.createElement(c.default,{placeholder:"\u8bf7\u8f93\u5165\u5206\u652f\u540d",size:"large",onChange:this.props.onBranchChange,value:this.props.branch}),l.default.createElement("div",{className:d.default.name},"\u529f\u80fd\u7ebf\u540d\u79f0"),l.default.createElement(c.default,{placeholder:"\u8bf7\u8f93\u529f\u80fd\u7ebf\u540d\u79f0",size:"large",value:this.props.flowName,onChange:this.props.onFlowNameChange,className:d.default.lastInput})),l.default.createElement(s.default.Footer,null,l.default.createElement(f.default,{onClick:this.props.onSubmit},"\u786e\u8ba4\u65b0\u5efa"),l.default.createElement(f.default,{empty:!0,onClick:this.props.onHideModal},"\u53d6\u6d88")))}}]),t}(),a.propTypes={modalShow:u.default.bool,onHideModal:u.default.func,onSubmit:u.default.func,branch:u.default.string,onBranchChange:u.default.func,flowName:u.default.string,onFlowNameChange:u.default.func},r);t.default=m},3460:function(e,t,n){e.exports={"add-feature-flow":"add-feature-flow-1V2",addFeatureFlow:"add-feature-flow-1V2",name:"name-xMb","last-input":"last-input-1QO",lastInput:"last-input-1QO"}},3463:function(e,t,n){e.exports={"feature-flow-list-container":"feature-flow-list-container-qFO",featureFlowListContainer:"feature-flow-list-container-qFO","new-btn":"new-btn-g9b",newBtn:"new-btn-g9b",empty:"empty-2Ku",tip:"tip-vZl","feature-flow-item":"feature-flow-item-32l",featureFlowItem:"feature-flow-item-32l",statusContainer:"statusContainer-10k",statusItem:"statusItem-2am",next:"next-3AF",infos:"infos-13q",time:"time-1yY","branch-label":"branch-label-2nE",branchLabel:"branch-label-2nE"}},3465:function(e,t,n){e.exports={container:"container-h0s",header:"header-2Qs",icon:"icon-2LZ",title:"title-1V5",infos:"infos-3Xw",time:"time-3wY","branch-label":"branch-label-Pob",branchLabel:"branch-label-Pob",flow:"flow-2Ma",contentContainer:"contentContainer-3lL",emptyContainer:"emptyContainer-1Iu",items:"items-10E",commitsContainer:"commitsContainer--Qf",commitContainer:"commitContainer-YGZ",greyBorder:"greyBorder-3YE",phaseContainer:"phaseContainer-3Mh","empty-commit":"empty-commit-1XP",emptyCommit:"empty-commit-1XP",tips:"tips-3ZE",ref:"ref-GeA",pager:"pager-20i",prev:"prev-VJb",next:"next-1fp",noticeWrap:"noticeWrap-2iQ",addIconWrap:"addIconWrap-17N",example:"example-3j9"}},3467:function(e,t,n){e.exports=n.p+"static/media/dev-flow-icon.064ee1f4.svg"},3468:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(2),u=A(l),s=A(n(0)),c=A(n(545)),f=A(n(544)),d=A(n(549)),p=n(112),m=A(n(698)),h=n(168),y=A(n(1483)),v=A(n(1788)),E=A(n(263)),b=A(n(262)),g=A(n(1959)),w=A(n(1795)),_=A(n(1957)),P=A(n(3469)),O=A(n(2244)),k=n(266),T=A(n(1961)),S=A(n(1637)),N=A(n(747)),C=A(n(1499)),I=n(1694),j=n(1543),F=A(n(2245));function A(e){return e&&e.__esModule?e:{default:e}}var R=(0,k.withAsyncMarkEditor)()((o=r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderFlow=function(){var e=n.props,t=e.flow,a=e.featureFlow.data.mergeRequests,r=(0,C.default)(a.map(function(e){return e.phases.map(function(t){return t.mrId=e.id,t.commitId=e.sourceSha,t})}));return u.default.createElement("div",{className:F.default.flow},u.default.createElement(P.default,{flow:t,phases:a.length>0?a[a.length-1].phases:void 0},n.renderBranchLine(r)))},n.renderPhaseBar=function(){var e=n.props.featureFlow.data.mergeRequests,t=e.length>0?e[e.length-1].phases:void 0;return u.default.createElement(O.default,{list:t})},n.state={open:!1,modalShow:!1,showMarkModel:!1,reviewers:[],editorState:e.defaultEditorState,markName:"",markUrl:"",markIcon:"",markPhaseId:0,markMrId:0},n.renderBranchLine=n.renderBranchLine.bind(n),n.onEditorChange=n.onEditorChange.bind(n),n.addReviewer=n.addReviewer.bind(n),n.delReviewer=n.delReviewer.bind(n),n.onSubmit=n.onSubmit.bind(n),n.onModalHide=n.onModalHide.bind(n),n.onHideMarkModel=n.onHideMarkModel.bind(n),n.onSubmitAddMark=n.onSubmitAddMark.bind(n),n.changeStatus=n.changeStatus.bind(n),n.phaseAutoSkip=n.phaseAutoSkip.bind(n),n.autoSkipCancel=n.autoSkipCancel.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),i(t,[{key:"componentDidMount",value:function(){var e=this;this.props.fetchFlowDetail(this.props.params.iid).then(function(){return e.props.fetchFeatureFlowDetail(e.props.params.iid,e.props.params.feature_iid)})}},{key:"phaseAutoSkip",value:function(e){this.props.phaseAutoSkip(e,"merge_feature_flow").then(function(){return(0,p.success)("\u8bbe\u7f6e\u8df3\u8fc7\u6210\u529f")})}},{key:"autoSkipCancel",value:function(e){this.props.phaseAutoSkipCancel(e,"merge_feature_flow").then(function(){return(0,p.success)("\u8bbe\u7f6e\u8df3\u8fc7\u6210\u529f")})}},{key:"changeStatus",value:function(e,t,n,a){a===j.PHASE_STATUS.SKIPPED&&confirm("\u8bf7\u95ee\u662f\u5426\u5e0c\u671b\u8be5\u9636\u6bb5\u603b\u662f\u81ea\u52a8\u8df3\u8fc7")&&this.props.phaseAutoSkip(t).then(function(){return(0,p.success)("\u8bbe\u7f6e\u8df3\u8fc7\u6210\u529f")}),this.props.phaseChangeStatus(n,e,a,"merge_feature_flow").then(function(){return(0,p.success)("\u63d0\u4ea4\u6210\u529f")})}},{key:"onHideMarkModel",value:function(){this.setState({showMarkModel:!1})}},{key:"onSubmitAddMark",value:function(){var e=this;this.props.phaseAddMark(this.state.markMrId,{markable_id:this.state.markPhaseId,markable_type:"Flow",icon:this.state.markIcon,url:this.state.markUrl,name:this.state.markName},"merge_feature_flow").then(function(){(0,p.success)("\u63d0\u4ea4\u6210\u529f"),e.setState({markIcon:"",markUrl:"",markName:"",markPhaseId:0})}),this.setState({showMarkModel:!1})}},{key:"addReviewer",value:function(e){var t=this.state.reviewers;t.push(e),this.setState({reviewers:t})}},{key:"delReviewer",value:function(e){var t=this.state.reviewers;(0,S.default)(t,e),this.setState({reviewers:t})}},{key:"onSubmit",value:function(){var e=this,t=this.props.getPlainText(this.state.editorState),n=this.state.reviewers.map(function(e){return e.username}).join(",");this.props.featureFlowApplyReview(this.props.flow.data.iid,this.props.featureFlow.data.iid,t,n).then(function(){(0,p.success)("\u63d0\u4ea4\u6210\u529f");var t=e.props.createWithContent("");e.setState({editorState:t,reviewers:[],modalShow:!1})})}},{key:"onEditorChange",value:function(e,t){this.setState({editorState:e},t)}},{key:"onModalHide",value:function(){this.setState({modalShow:!1})}},{key:"renderCommit",value:function(e,t){return u.default.createElement("div",{className:F.default.commitWrap,key:t},0!==t&&u.default.createElement("img",{src:n(1958),className:F.default.next}),u.default.createElement(w.default,{key:e.commitId,className:F.default.commit,empty:!0,showCommitCard:!0,projectPath:this.props.currentProject.project_path,commit:e,placement:"down"}))}},{key:"renderBranchLine",value:function(e){var t=this,n=this.props,a=n.flow,r=n.featureFlow,o=(0,N.default)(r.data.commits,"commitTime"),i=e.findIndex(function(e){return e.commitId===o[o.length-1].commitId})<0;return u.default.createElement("div",{className:F.default.branchLine},o.map(function(n,o){var i=e.findIndex(function(e){return e.commitId===n.commitId});if(i>=0){var l=e[i],s=e[i+1];return(0,S.default)(e,l),(0,S.default)(e,s),[t.renderCommit(n,o,t),u.default.createElement(_.default,{key:l.id,phase:l,icon:!0,previousPhaseStatus:"",commitSha:r.data.start_sha,autoSkipPhases:a.data.autoSkipPhases,phaseAutoSkip:t.phaseAutoSkip,autoSkipCancel:t.autoSkipCancel,changeStatus:t.changeStatus,addMark:function(){return t.setState({showMarkModel:!0,markPhaseId:l.id})}}),u.default.createElement(_.default,{key:s.id,phase:s,icon:!0,previousPhaseStatus:l.status,commitSha:r.data.start_sha,autoSkipPhases:a.data.autoSkipPhases,phaseAutoSkip:t.phaseAutoSkip,autoSkipCancel:t.autoSkipCancel,changeStatus:t.changeStatus,addMark:function(){return t.setState({showMarkModel:!0,markPhaseId:s.id})},showTouchMe:("success"===l.status||"skipped"===l.status)&&"pending"===s.status})]}return t.renderCommit(n,o)}),i&&0===o.length&&this.renderEmptyPhase("\u7b49\u5f85\u63d0\u4ea4",function(){return t.setState({modalShow:!0})},0===o.length,"",r.data.ref_name),i&&this.renderEmptyPhase("\u63d0\u4ea4\u8bc4\u5ba1",function(){return t.setState({modalShow:!0})},0!==o.length),i&&this.renderEmptyPhase("\u7b49\u5f85\u8bc4\u5ba1",function(){},!1),i&&this.renderEmptyPhase("\u7b49\u5f85\u5408\u5e76",function(){},!1))}},{key:"renderEmptyPhase",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pending",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return u.default.createElement(_.default,{phase:{status_desc:e,status:"pending"},icon:n,previousPhaseStatus:a,canApplyReview:n,applyReview:t,showTouchMe:n,pushTips:r})}},{key:"render",value:function(){var e=this,t=this.props,a=t.currentProject,r=t.flow,o=t.featureFlow,i=t.MediumMarkEditor;return r.loading||o.loading?u.default.createElement("div",{className:F.default.container},u.default.createElement(m.default,{show:!0})):u.default.createElement("div",{className:F.default.container},u.default.createElement("div",{className:F.default.header},u.default.createElement(h.Link,{to:a.project_path+"/flow"},"\u6240\u6709\u5f00\u53d1\u7ebf"),u.default.createElement(v.default,{className:F.default.icon}),u.default.createElement(h.Link,{to:a.project_path+"/flow/"+r.data.iid},"\u5f00\u53d1\u7ebf\u8be6\u60c5"),u.default.createElement(v.default,{className:F.default.icon}),"\u529f\u80fd\u7ebf\u8be6\u60c5"),u.default.createElement("div",{className:F.default.title},u.default.createElement("div",{className:F.default.titleContainer},u.default.createElement("h1",null,u.default.createElement("img",{src:n(3473)}),o.data.title),u.default.createElement("div",{className:F.default.phaseBarContainer},this.renderPhaseBar())),u.default.createElement("div",{className:F.default.infos},u.default.createElement(h.Link,{to:o.data.owner.path},u.default.createElement(b.default,{src:o.data.owner.avatar,size:"tiny"}),o.data.owner.name),u.default.createElement("span",{className:F.default.time},"\u521b\u5efa\u4e8e",(0,E.default)(new Date(o.data.created_at)).format("YYYY \u5e74 MM \u6708 DD \u65e5")),u.default.createElement("span",{className:F.default.branchLabel},u.default.createElement(y.default,null),o.data.ref_name)),u.default.createElement("div",{className:"clearfix"})),this.renderFlow(),u.default.createElement(d.default,{show:this.state.modalShow,onHide:this.onModalHide,style:{width:900},className:F.default.applyReview},u.default.createElement(d.default.Header,null,o.data.title," \u63d0\u4ea4\u8bc4\u5ba1"),u.default.createElement(d.default.Body,null,u.default.createElement(i,{placeholder:"\u8bf7\u5728\u6b64\u8f93\u5165\u5408\u5e76\u8bf7\u6c42\u63cf\u8ff0\u5185\u5bb9\uff08\u652f\u6301 Markdown\uff09",className:F.default.editor,onChange:this.onEditorChange,editorState:this.state.editorState,projectId:this.props.currentProject.id||0,autoSize:!1,mentionParams:{context_type:"task_description",item_id:this.props.currentProject.id},hashSearchParams:{owner:this.props.currentProject.owner_user_name,project:this.props.currentProject.name}}),u.default.createElement("div",{className:F.default.review},u.default.createElement(T.default,{reviewers:this.state.reviewers,addReviewer:this.addReviewer,delReviewer:this.delReviewer,members:this.props.memberItems,author:this.props.user,canEdit:!0})),u.default.createElement("div",{className:"clearfix"})),u.default.createElement(d.default.Footer,null,u.default.createElement(f.default,{onClick:this.onSubmit,style:{marginRight:10}},"\u63d0\u4ea4\u8bc4\u5ba1"),u.default.createElement(f.default,{empty:!0,onClick:this.onModalHide},"\u53d6\u6d88"))),u.default.createElement(g.default,{modalShow:this.state.showMarkModel,onHideModel:this.onHideMarkModel,onSubmit:this.onSubmitAddMark,name:this.state.markName,onNameChange:function(t){return e.setState({markName:t.target.value})},icon:this.state.markIcon,onIconChange:function(t){return e.setState({markIcon:t.target.value})},url:this.state.markUrl,onUrlChange:function(t){return e.setState({markUrl:t.target.value})}}))}}]),t}(),r.propTypes={params:s.default.object,currentProject:s.default.object,currentDepot:s.default.object,fetchFlowDetail:s.default.func,fetchFeatureFlowDetail:s.default.func,phaseChangeStatus:s.default.func,phaseAddMark:s.default.func,phaseAutoSkip:s.default.func,phaseAutoSkipCancel:s.default.func,flow:s.default.object,featureFlow:s.default.object,user:s.default.object,memberItems:s.default.array,featureFlowApplyReview:s.default.func,defaultEditorState:s.default.object,MediumMarkEditor:s.default.func,getPlainText:s.default.func,createWithContent:s.default.func},a=o))||a;t.default=(0,c.default)(function(e){var t=e.FLOW;return{flow:t.flow,featureFlow:t.featureFlow,user:e.APP.user,memberItems:e.PROJECT.common.memberItems}},{fetchFlowDetail:I.fetchFlowDetail,fetchFeatureFlowDetail:I.fetchFeatureFlowDetail,phaseChangeStatus:I.phaseChangeStatus,phaseAddMark:I.phaseAddMark,phaseAutoSkip:I.phaseAutoSkip,phaseAutoSkipCancel:I.phaseAutoSkipCancel,featureFlowApplyReview:I.featureFlowApplyReview})(R)},3469:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=d(i),u=d(n(8)),s=d(n(1483)),c=d(n(2245)),f=d(n(1795));function d(e){return e&&e.__esModule?e:{default:e}}var p=(r=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isFinished=function(){var e=n.props.phases,t=["skipped","success"];return!!(e&&e instanceof Array&&e.length>0)&&e.every(function(e){return t.some(function(t){return t===e.status})})},n.state={},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default.Component),o(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.flow;return l.default.createElement("div",{className:c.default.wrap},l.default.createElement("div",{className:c.default.container},l.default.createElement("div",{className:c.default.leftBox}),l.default.createElement("div",{className:c.default.rightBox}),l.default.createElement("div",{className:c.default.leftIcon},l.default.createElement(f.default,{empty:!0})),l.default.createElement("i",{className:c.default.topLeftLine}),l.default.createElement("i",{className:c.default.topRightArrow}),l.default.createElement("div",{className:(0,u.default)(c.default.rightIcon,this.isFinished()?c.default.success:"")},l.default.createElement(f.default,{empty:!0})),l.default.createElement("div",{className:c.default.branchLabelContainer},l.default.createElement("span",{className:c.default.branchLabel},l.default.createElement(s.default,null),n.data.ref_name)),l.default.createElement("div",{className:c.default.childrenContainer},t)))}}]),t}(),a.propTypes={children:i.PropTypes.any,flow:i.PropTypes.object.isRequired},a.defaultProps={},r);t.default=p},3473:function(e,t,n){e.exports=n.p+"static/media/feature-flow-icon.c697d8c6.svg"},3474:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=h(i),u=h(n(0)),s=h(n(545)),c=h(n(699)),f=n(264),d=h(n(3475)),p=h(n(3486)),m=h(n(3489));function h(e){return e&&e.__esModule?e:{default:e}}var y=(r=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"render",value:function(){return this.props.deployTypeLoading&&""===this.props.deployType?l.default.createElement(c.default,null):"dedicated"===this.props.deployType?this.props.deployStatusLoading&&!this.props.appRuntime?l.default.createElement(c.default,null):"SUCCESS"===this.props.deployStatusState||"RUNNING"===this.props.deployStatusState?l.default.createElement(m.default,this.props):l.default.createElement(p.default,this.props):(0,f.isActive)("coding-ocd-pages",this.props.exp)&&"static"===this.props.deployType?l.default.createElement(m.default,this.props):l.default.createElement(d.default,this.props)}}]),t}(),a.propTypes={deployType:u.default.string,deployTypeLoading:u.default.bool,deployStatusLoading:u.default.bool,deployStatusState:u.default.string,appRuntime:u.default.string,exp:u.default.object},a.defaultProps={deployType:""},r);t.default=(0,s.default)(function(e){var t=e.APP.currentProject,n=e.ONE_CLICK_DEPLOY.common,a=n.deployType,r=n.deployTypeLoading,o=n.deployStatusState;return{currentProject:t,deployType:a,deployTypeLoading:r,deployStatusLoading:n.deployStatusLoading,deployStatusState:o,appRuntime:n.appRuntime}},{})((0,f.withExp)(y))},3475:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=S(i),u=S(n(0)),s=S(n(545)),c=n(168),f=S(n(1466)),d=S(n(544)),p=S(n(701)),m=S(n(549)),h=S(n(1454)),y=S(n(700)),v=S(n(1551)),E=n(264),b=S(n(2246)),g=S(n(3478)),w=n(3484),_=n(1695),P=n(1638),O=n(1696),k=S(n(2248)),T=S(n(698));function S(e){return e&&e.__esModule?e:{default:e}}var N=f.default.RadioGroup,C=(r=a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={envSelecting:t.envSelections[0].value,spaces:t.envSelections[0].spaces,spaceSelecting:t.envSelections[0].spaces[0],configurationSelecting:"default",refSelecting:"",autoDeploy:!0,showIntroduce:!0,acquiringMachine:!1,creating:!1,accessTokenNotValid:!1},e.onRefSelect=e.onRefSelect.bind(e),e.onSourceSelect=e.onSourceSelect.bind(e),e.onConfigurationChange=e.onConfigurationChange.bind(e),e.onAutoDeployCheckBoxClick=e.onAutoDeployCheckBoxClick.bind(e),e.onHideIntroduce=e.onHideIntroduce.bind(e),e.startStaticPages=e.startStaticPages.bind(e),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){!this.state.refSelecting&&e.defaultRef&&this.setState({refSelecting:e.defaultRef})}},{key:"onEnvSelectionCardSelect",value:function(e){this.setState({envSelecting:e.value,spaces:e.spaces})}},{key:"onSpaceChange",value:function(e){this.setState({spaceSelecting:e})}},{key:"onConfigurationChange",value:function(e){var t=e.target.value;this.setState({configurationSelecting:t})}},{key:"onAutoDeployCheckBoxClick",value:function(e){var t=e.target.checked;this.setState({autoDeploy:t})}},{key:"onRefSelect",value:function(e){this.setState({refSelecting:e.value})}},{key:"onSourceSelect",value:function(e){this.setState({sourceSelecting:e.value})}},{key:"onHideIntroduce",value:function(){var e=this;this.setState({showIntroduce:!1}),(0,w.isBetaTestUser)("ocd",this.props.currentUser)&&this.props.getHosts().then(function(t){return t&&t.length?Promise.resolve():(e.setState({acquiringMachine:!0}),e.props.acquireHost().then(e.props.getHosts).catch(e.checkIfAccessTokenNotValid.bind(e)))}).finally(function(){e.setState({acquiringMachine:!1})})}},{key:"startStaticPages",value:function(){return this.startOneClickDeploy({envSelecting:"static"})}},{key:"startOneClickDeploy",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.props.host.hostId,a=this.state,r=a.envSelecting,o=a.configurationSelecting,i=a.refSelecting,l=a.autoDeploy,u="",s="",c=t.envSelecting||r;u="static"===c?"static":"dedicated",s="default"===o?"master":i,u&&s&&(this.setState({creating:!0}),this.props.startOneClickDeploy({type:u,branch:s,path:"",autoDeploy:l,appRuntime:c,hostId:n}).then(function(){var t=15e3;"static"===u&&(t=3e3),setTimeout(function(){e.props.getDeployType().then(e.props.getDeployStatus())},t)}).catch(function(t){e.setState({creating:!1}),e.checkIfAccessTokenNotValid(t)}))}},{key:"checkIfAccessTokenNotValid",value:function(e){[1001,3020,3019,1097,3021].indexOf(e.code)>-1&&this.setState({accessTokenNotValid:!0})}},{key:"renderEnvSelectionCard",value:function(e,t){var n=this;return l.default.createElement("div",{key:e.name,className:k.default.card+" "+k.default.flat+" "+(t?k.default.selected:""),onClick:function(){return n.onEnvSelectionCardSelect(e)}},l.default.createElement("div",{className:k.default.name},e.name),l.default.createElement("div",{className:k.default.description},l.default.createElement("div",null,e.description)))}},{key:"renderEnvSelection",value:function(){var e=this,n=this.props.exp,a=t.envSelections.filter((0,E.filterActiveExpMenu)(n));return l.default.createElement("div",{className:k.default.selection},l.default.createElement("div",{className:k.default.topic},"\u9009\u62e9\u5e94\u7528\u73af\u5883"),l.default.createElement("div",{className:k.default.container},a.map(function(t){return e.renderEnvSelectionCard(t,e.state.envSelecting===t.value)})))}},{key:"renderSpaceSelectionCard",value:function(e,n){var a=this,r=void 0;return"shared"===e&&(r=t.renderSpaceSelectionCardShared()),"qcloud"===e&&(r=t.renderSpaceSelectionCardQcloud()),r?l.default.createElement("div",{key:e,className:k.default.card+" "+k.default.tall+" "+(n?k.default.selected:""),onClick:function(){return a.onSpaceChange(e)}},r):null}},{key:"renderSpaceSelection",value:function(){var e=this;return l.default.createElement("div",{className:k.default.selection+" "+k.default.space},l.default.createElement("div",{className:k.default.topic},"\u90e8\u7f72\u7a7a\u95f4"),l.default.createElement("div",{className:k.default.container},this.state.spaces.map(function(t){return e.renderSpaceSelectionCard(t,e.state.spaceSelecting===t)})),"qcloud"===this.state.spaceSelecting&&l.default.createElement("div",{className:k.default.description},l.default.createElement("span",null,"\u72ec\u7acb\u7684\u4e91\u4e3b\u673a\uff0c\u4e0e\u5176\u4ed6\u7528\u6237\u57fa\u4e8e KVM \u9694\u79bb\uff0c\u6781\u9ad8\u7684\u5b89\u5168\u6027\u4e0e\u53ef\u7528\u6027\u3002 \u4f7f\u7528\u72ec\u4eab\u7684 CPU \u65f6\u95f4\u3001\u5185\u5b58\uff0c\u66f4\u9ad8\u7684\u6027\u80fd\u6307\u6807\uff0c\u63d0\u4f9b\u4e0e\u7269\u7406\u673a\u76f8\u540c\u7684\u6027\u80fd\u4f53\u9a8c\u3002")))}},{key:"renderConfigurationRadio",value:function(){return l.default.createElement("div",null,l.default.createElement(N,{name:"envConfiguration",defaultValue:this.state.configurationSelecting,onChange:this.onConfigurationChange},l.default.createElement(f.default,{key:"default",value:"default"},"\u4f7f\u7528\u63a8\u8350\u914d\u7f6e\u542f\u52a8"),l.default.createElement(f.default,{key:"custom",value:"custom"},"\u4f7f\u7528\u81ea\u5b9a\u4e49\u914d\u7f6e\u542f\u52a8")))}},{key:"renderConfigurationCustom",value:function(){var e=this.props,t=e.currentDepot,n=e.refs,a=this.state.refSelecting;return n?l.default.createElement("div",{className:k.default.item},l.default.createElement("span",{className:k.default.text},"\u4ee3\u7801\u5206\u652f"),l.default.createElement(v.default,{triggerClassName:k.default.trigger,className:k.default.dropdown,depot:t,onChange:this.onRefSelect,items:n,value:a})):null}},{key:"renderConfigurationCustomAutoDeploy",value:function(){return l.default.createElement("div",{className:k.default.item},l.default.createElement("span",{className:k.default.text},"\u81ea\u52a8\u90e8\u7f72"),l.default.createElement(p.default,{toggle:!0,checked:this.state.autoDeploy,onChange:this.onAutoDeployCheckBoxClick,className:k.default.dropdown}))}},{key:"renderConfiguration",value:function(){var e=this.state.configurationSelecting;return l.default.createElement("div",{className:k.default.configuration},this.renderConfigurationRadio(),"custom"===e&&l.default.createElement("div",{className:k.default.custom},this.renderConfigurationCustom(),this.renderConfigurationCustomAutoDeploy()))}},{key:"renderStartButton",value:function(){var e=this,t=this.state.envSelecting,n=!this.props.host.id&&"static"!==t||this.state.creating;return l.default.createElement("div",{className:k.default.start},l.default.createElement(d.default,{className:k.default.button,disabled:n,onClick:function(){return e.startOneClickDeploy()}},this.state.creating?"\u542f\u52a8\u4e2d...":"\u7acb\u5373\u542f\u52a8"))}},{key:"rednerMachineStateDeploySquare",value:function(e,t){if(!t)return l.default.createElement("div",{key:"no_"+e,className:k.default.deploySquare});var n=l.default.createElement(y.default,{placement:"top"},t.project_name);return l.default.createElement(h.default,{placement:"top",overlay:n,key:t.id+"-"+e},l.default.createElement(c.Link,{to:"/u/"+t.global_key+"/p/"+t.project_name+"/git/pages"},l.default.createElement("div",{className:k.default.deploySquare+" "+k.default.deployed})))}},{key:"renderMachineStatePanelMachineState",value:function(){var e=this.props.host,t="\u8fd0\u884c\u4e2d"===e.status?k.default.success:"";return l.default.createElement("div",{className:k.default.status},l.default.createElement("div",{className:k.default.row},l.default.createElement("div",{className:k.default.left},"\u4e3b\u673a IP:"),l.default.createElement("div",{className:k.default.right},e.ip)),l.default.createElement("div",{className:k.default.row},l.default.createElement("div",{className:k.default.left},"\u4e3b\u673a\u72b6\u6001:"),l.default.createElement("div",{className:t+" "+k.default.left},e.status),l.default.createElement("div",{className:k.default.right,style:{display:"none"}},l.default.createElement("a",{href:"https://console.cloud.tencent.com/lighthosting",target:"_blank"},"\u7eed\u8d39"))),l.default.createElement("div",{className:k.default.row},l.default.createElement("div",{className:k.default.key+" "+k.default.left},"\u90e8\u7f72\u9879\u76ee:"),l.default.createElement("div",{className:k.default.right},l.default.createElement(b.default,{sites:e.sites}))))}},{key:"renderMachineStatePanelNoMachine",value:function(){var e=this.state.acquiringMachine;return this.props.hostLoadSucceed?e?l.default.createElement("div",{className:k.default.message},"\u6b63\u5728\u4e3a\u60a8\u7533\u8bf7\u4e3b\u673a\uff0c\u8bf7\u7a0d\u7b49..."):l.default.createElement("div",null,l.default.createElement("p",null,"\u4e3b\u673a\u7533\u8bf7\u5931\u8d25..."),l.default.createElement(d.default,{onClick:this.onHideIntroduce},"\u91cd\u8bd5")):l.default.createElement("div",null,l.default.createElement("p",null,"\u4e3b\u673a\u4fe1\u606f\u83b7\u53d6\u5931\u8d25..."),l.default.createElement(d.default,{onClick:this.onHideIntroduce},"\u91cd\u8bd5"))}},{key:"renderMachineStatePanel",value:function(){var e=this.props,t=e.host,n=e.hostLoading;return(0,w.isBetaTestUser)("ocd",this.props.currentUser)?l.default.createElement("div",{className:k.default.machinePanel},l.default.createElement("div",{className:k.default.title},"\u4e3b\u673a\u4fe1\u606f"),l.default.createElement("div",{className:k.default.card},l.default.createElement("div",{className:k.default.cardTop},l.default.createElement(T.default,{show:n}),!n&&(t.id&&this.renderMachineStatePanelMachineState()||this.renderMachineStatePanelNoMachine())),l.default.createElement("div",{className:k.default.cardBottom},l.default.createElement("p",null,l.default.createElement("span",null,"1 \u4e2a\u5185\u6838"),l.default.createElement("span",null,"1G \u5185\u5b58")),l.default.createElement("p",null,l.default.createElement("span",null,"10G \u786c\u76d8"),l.default.createElement("span",null,"1M \u5e26\u5bbd"))))):l.default.createElement("div",{className:k.default.machinePanel},l.default.createElement("div",{className:k.default.title},"\u4e3b\u673a\u4fe1\u606f"),l.default.createElement("div",{className:k.default.card},l.default.createElement("p",null,"\u975e\u516c\u6d4b\u7528\u6237")))}},{key:"renderAccessTokenNotValid",value:function(){var e=this;return l.default.createElement("div",null,l.default.createElement(m.default,{show:this.state.accessTokenNotValid,onHide:function(){e.setState({accessTokenNotValid:!1})},style:{width:400,marginTop:200}},l.default.createElement("div",{className:k.default.qcloud},l.default.createElement("h3",null,"\u817e\u8baf\u4e91\u8bbf\u95ee\u4ee4\u724c\u5931\u6548"),l.default.createElement("p",{className:k.default.tip},"\u8bf7\u91cd\u65b0\u4ece\u817e\u8baf\u4e91\u83b7\u53d6\u6388\u6743\uff0c\u5e76\u91cd\u8bd5\u5f00\u542f\u4f7f\u7528"),l.default.createElement("a",{href:"/api/oauth/qcloud/rebind",target:"_blank",rel:"noopener noreferrer"},l.default.createElement(d.default,{className:k.default.button,size:"medium"},"\u91cd\u65b0\u83b7\u53d6\u817e\u8baf\u4e91\u6388\u6743")))))}},{key:"render",value:function(){return this.state.showIntroduce?l.default.createElement("div",null,l.default.createElement(g.default,{close:this.onHideIntroduce,startStaticPages:this.startStaticPages})):l.default.createElement("div",null,t.renderHeader(),this.renderMachineStatePanel(),this.renderEnvSelection(),this.renderConfiguration(),this.renderStartButton(),this.renderAccessTokenNotValid())}}],[{key:"renderHeader",value:function(){return l.default.createElement("div",null,l.default.createElement("div",{className:O.header},l.default.createElement("div",{className:O.title},l.default.createElement("span",null,"\u4e00\u952e\u90e8\u7f72"))),l.default.createElement("div",{className:O.tips},"\u4e00\u952e\u90e8\u7f72\u53ef\u5feb\u901f\u5c06\u4ed3\u5e93\u4ee3\u7801\u6784\u5efa\u5e76\u90e8\u7f72\u5230\u72ec\u4eab\u7a7a\u95f4\u6216\u5171\u4eab\u7a7a\u95f4\u4e2d\uff0c\u652f\u6301\u7ed1\u5b9a\u81ea\u5b9a\u4e49\u57df\u540d\uff0c\u901a\u8fc7 http/https \u534f\u8bae\u8bbf\u95ee\u5e94\u7528\u3002"))}},{key:"renderSpaceSelectionCardShared",value:function(){return l.default.createElement("div",null,l.default.createElement("div",{className:k.default.name},"\u5171\u4eab\u7a7a\u95f4"),l.default.createElement("div",{className:k.default.description},l.default.createElement("div",{className:k.default.block},"\u5171\u4eab\u5185\u6838"),l.default.createElement("div",{className:k.default.block},"\u5171\u4eab\u5185\u5b58"),l.default.createElement("br",null),l.default.createElement("div",{className:k.default.block},"100M \u786c\u76d8"),l.default.createElement("div",{className:k.default.block},"\u5171\u4eab\u5e26\u5bbd")),l.default.createElement("div",{className:k.default.price},"\u514d\u8d39"))}},{key:"renderSpaceSelectionCardQcloud",value:function(){return l.default.createElement("div",null,l.default.createElement("div",{className:k.default.name},"\u72ec\u4eab\u7a7a\u95f4"),l.default.createElement("div",{className:k.default.description},l.default.createElement("div",{className:k.default.block},"1 \u4e2a\u5185\u6838"),l.default.createElement("div",{className:k.default.block},"1G \u5185\u5b58"),l.default.createElement("br",null),l.default.createElement("div",{className:k.default.block},"10G \u786c\u76d8"),l.default.createElement("div",{className:k.default.block},"1M \u5e26\u5bbd")),l.default.createElement("div",{className:k.default.price},l.default.createElement("span",{className:k.default.num},"19"),"\u5143/\u6708"),l.default.createElement("div",{className:k.default.highlight},"\u7b2c\u4e00\u4e2a\u6708\u514d\u8d39"))}},{key:"renderSpaceSelectionCardQcloudNotOpen",value:function(){return l.default.createElement("div",null,l.default.createElement("div",{className:k.default.name},"\u72ec\u4eab\u7a7a\u95f4"),l.default.createElement("div",{className:k.default.description},l.default.createElement("div",{className:k.default.block},"1 \u4e2a\u5185\u6838"),l.default.createElement("div",{className:k.default.block},"1G \u5185\u5b58"),l.default.createElement("br",null),l.default.createElement("div",{className:k.default.block},"10G \u786c\u76d8"),l.default.createElement("div",{className:k.default.block},"1M \u5e26\u5bbd")),l.default.createElement("div",{className:k.default.waiting},"\u656c\u8bf7\u671f\u5f85"))}}]),t}(),a.envSelections=_.OCD_ACTIVATED_ENVIRONMENT,a.propTypes={projectApiPrefix:u.default.string,defaultRef:u.default.string,getDeployStatus:u.default.func,deployStatusLoading:u.default.bool,refs:u.default.object,startOneClickDeploy:u.default.func,getDeployType:u.default.func,getHosts:u.default.func,acquireHost:u.default.func,currentDepot:u.default.object,host:u.default.object,hostLoading:u.default.bool,hostLoadSucceed:u.default.bool,currentUser:u.default.object,exp:u.default.object},r);t.default=(0,s.default)(function(e){var t=e.APP,n=t.currentProject,a=t.currentDepot,r=t.user,o=t.projectApiPrefix,i=e.ONE_CLICK_DEPLOY,l=i.common,u=l.deployStatusLoading,s=l.refs,c=i.host,f=c.host,d=c.hostLoading,p=c.hostLoadSucceed;return{currentProject:n,currentDepot:a,currentUser:r,projectApiPrefix:o,deployStatusLoading:u,refs:s,defaultRef:a.default_branch||"master",host:f,hostLoading:d,hostLoadSucceed:p}},{getDeployType:P.getDeployType,getDeployStatus:P.getDeployStatus,startOneClickDeploy:P.startOneClickDeploy,getHosts:P.getHosts,acquireHost:P.acquireHost})((0,E.withExp)(C))},3476:function(e,t,n){e.exports={"deploy-square":"deploy-square-11I",deploySquare:"deploy-square-11I",deployed:"deployed-27Y"}},3478:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=h(i),u=h(n(0)),s=h(n(545)),c=n(264),f=h(n(544)),d=h(n(3479)),p=n(1638),m=h(n(2248));function h(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var v=(r=a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=a=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={loading:!1,pagesCreating:!1},y(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"render",value:function(){var e=this;return l.default.createElement("div",null,l.default.createElement("div",{className:m.default.introduction},l.default.createElement("img",{src:d.default}),l.default.createElement("div",{className:m.default.header},"\u6b22\u8fce\u4f7f\u7528 Coding Pages "),l.default.createElement("div",{className:m.default.explanation},"Coding Pages \u662f\u4e00\u4e2a\u63d0\u4f9b\u514d\u8d39\u9759\u6001\u7f51\u9875\u6258\u7ba1\u7684\u670d\u52a1\u5e73\u53f0\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Coding Pages \u6258\u7ba1\u535a\u5ba2\u3001\u9879\u76ee\u5b98\u7f51\u7b49\u9759\u6001\u7f51\u9875\u3002"),l.default.createElement("div",{className:m.default.explanationExtra},"\u5982\u679c\u60a8\u9700\u8981\u90e8\u7f72\u52a8\u6001\u7f51\u7ad9\uff08\u5982 PHP\uff09\uff0c\u8bf7\u5347\u7ea7\u81f3"," ",l.default.createElement("a",{href:"https://dev.tencent.com/",target:"_blank"},"\u817e\u8baf\u4e91\u5f00\u53d1\u8005\u5e73\u53f0"),"\uff0c\u4f7f\u7528"," ",l.default.createElement("a",{href:"https://studio.dev.tencent.com/",target:"_blank"},"Cloud Studio")," ","\u7684"," ",l.default.createElement("a",{href:"https://dev.tencent.com/help/cloud-studio/one-click-deploy",target:"_blank"},"\u4e00\u952e\u90e8\u7f72")," ","\u529f\u80fd\u3002"),l.default.createElement(f.default,{onClick:function(){e.props.startStaticPages(),e.setState({pagesCreating:!0})},disabled:this.state.pagesCreating,className:m.default.startNow},"\u4e00\u952e\u5f00\u542f Coding Pages")),l.default.createElement("div",{className:m.default.suggestion},l.default.createElement("div",{className:m.default.suggestionTitle},"\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5de5\u5177\u63a8\u8350"),l.default.createElement("div",null,l.default.createElement("div",{className:m.default.suggestionItems},t.suggestionList.map(function(e,t){return l.default.createElement("div",{key:t,className:m.default.suggestionItem},l.default.createElement("div",{className:m.default.suggestionIcon},l.default.createElement("img",{src:e.img})),l.default.createElement("div",{className:m.default.suggestionDesc},e.description,l.default.createElement("br",null),l.default.createElement("a",{href:e.link,target:"_blank"},e.linkText)))})))))}}]),t}(),a.propTypes={close:u.default.func,getOauthPlatforms:u.default.func,startStaticPages:u.default.func,deployType:u.default.string,exp:u.default.object,currentUser:u.default.object},a.suggestionList=[{description:"Jekyll \u662f\u4e00\u4e2a\u7b80\u5355\u7684\u9759\u6001\u7f51\u7ad9\u751f\u4ea7\u7a0b\u5e8f\uff0c\u4f7f\u7528 Jekyll \u53ef\u5feb\u901f\u5730\u642d\u5efa\u9879\u76ee\u9875\u9762\u3001\u535a\u5ba2\u6216\u662f\u7f51\u7ad9\u3002",link:"https://jekyllrb.com",linkText:"\u67e5\u770b Jekyll \u6587\u6863",img:n(3482)},{description:"Hexo \u662f\u4e00\u4e2a\u5feb\u901f\u3001\u7b80\u6d01\u4e14\u9ad8\u6548\u7684\u535a\u5ba2\u6846\u67b6\uff0c\u60a8\u53ef\u5229\u7528\u9753\u4e3d\u7684\u4e3b\u9898\u5feb\u901f\u751f\u6210\u9759\u6001\u7f51\u9875\u3002",link:"https://hexo.io",linkText:"\u67e5\u770b Hexo \u6587\u6863",img:n(3483)}],r);t.default=(0,s.default)(function(e){var t=e.APP,n=t.currentProject,a=t.currentDepot,r=t.user,o=t.projectApiPrefix,i=e.ONE_CLICK_DEPLOY.common,l=i.deployStatusLoading,u=i.refs;return{currentProject:n,currentDepot:a,deployType:i.deployType,currentUser:r,projectApiPrefix:o,deployStatusLoading:l,refs:u,defaultRef:a.default_branch||"master"}},{getDeployType:p.getDeployType,getDeployStatus:p.getDeployStatus,startOneClickDeploy:p.startOneClickDeploy,getOauthPlatforms:p.getOauthPlatforms})((0,c.withExp)(v))},3479:function(e,t,n){e.exports=n.p+"static/media/Pages.5769632d.png"},3480:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHosts=function(){return function(e){return(0,i.default)((0,r.get)("/api/user/ocd-host/list-host",!0),e,l.ACTION.GET_HOSTS)}},t.getHostDetail=function(e){return function(t){return(0,i.default)((0,r.get)("/api/user/ocd-host/get-host?host_id="+e),t,l.ACTION.GET_HOST)}},t.acquireHost=function(){return function(e){return(0,i.default)((0,r.post)("/api/user/ocd-host/acquire-host"),e,l.ACTION.ACQUIRE_HOST)}},t.cancelHost=function(e){return function(t){return(0,i.default)((0,r.post)("/api/user/ocd-host/cancel-host?host_id="+e),t,l.ACTION.CANCEL_HOST)}};var a,r=n(84),o=n(227),i=(a=o)&&a.__esModule?a:{default:a},l=n(2247)},3482:function(e,t,n){e.exports=n.p+"static/media/Jekyll.5ed7a2ef.png"},3483:function(e,t,n){e.exports=n.p+"static/media/Hexo.0baf964d.png"},3484:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isBetaTestUser=function(e,t){return!!(t&&"[object Object]"===Object.prototype.toString.call(t)&&Array.isArray(t.test)&&t.test.indexOf(e)>-1)}},3486:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=m(i),u=m(n(0)),s=m(n(545)),c=m(n(544)),f=n(1638),d=n(1696),p=m(n(3487));function m(e){return e&&e.__esModule?e:{default:e}}var h=(r=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){return e.tryGetDeployTaskStatus()},15e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval),this.props.getDeployStatus()}},{key:"tryGetDeployTaskStatus",value:function(){this.props.getDeployStatus()}},{key:"onStopIconClick",value:function(){var e=this;window.confirm("\u786e\u5b9a\u5173\u95ed\u5e94\u7528\uff1f")&&this.props.deleteOneClickDeploy().then(function(){e.props.getDeployType()})}},{key:"renderDeletion",value:function(){var e=this;return l.default.createElement("div",{className:p.default.fail},l.default.createElement("p",null,"\u90e8\u7f72\u5931\u8d25"),l.default.createElement(c.default,{type:"danger",style:{width:"112px",height:"48px"},onClick:function(){return e.onStopIconClick()}},l.default.createElement("span",{className:"fs-16"},"\u5220\u9664")))}},{key:"renderDeployType",value:function(e){var n=t.DeployTypeExplanation[e],a=n?"\u6b63\u5728"+n+"...":e;return l.default.createElement("div",null,a)}},{key:"render",value:function(){var e=this.props,n=e.deployTask,a=e.initializingStatusState;return l.default.createElement("div",null,t.renderHeader(),l.default.createElement("div",{className:p.default.content},l.default.createElement("span",{className:"fs-24"},"\u6b63\u5728\u4e3a\u60a8\u51c6\u5907\uff0c\u8bf7\u7a0d\u7b49\u7247\u523b"),l.default.createElement("div",{className:p.default.loadingWrapper},l.default.createElement("div",{className:p.default.monkeyLoading})),l.default.createElement("div",{className:p.default.textWrapper},l.default.createElement("div",{className:p.default.text},this.renderDeployType(n.type)),l.default.createElement("pre",{className:p.default.log},n.log))),"FAILURE"===a&&this.renderDeletion())}}],[{key:"renderHeader",value:function(){return l.default.createElement("div",null,l.default.createElement("div",{className:d.header},l.default.createElement("div",{className:d.title},l.default.createElement("span",null,"\u5e94\u7528\u90e8\u7f72"))))}}]),t}(),a.propTypes={getDeployTaskStatus:u.default.func,deployType:u.default.string,initializingStatusState:u.default.string,getDeployStatus:u.default.func,getDeployType:u.default.func,deleteOneClickDeploy:u.default.func,deployTask:u.default.object},a.DeployTypeExplanation={INITIALIZE_HOST:"\u521d\u59cb\u5316\u4e3b\u673a",INSTALL_DATABASE:"\u5b89\u88c5\u6570\u636e\u5e93",INSTALL_DATABASE_ADMIN:"\u5b89\u88c5\u6570\u636e\u5e93\u7ba1\u7406\u5de5\u5177",CLONE_CODE:"\u514b\u9686\u4ee3\u7801",INSTALL_APP_RUNTIME:"\u5b89\u88c5\u8fd0\u884c\u73af\u5883",INSTALL_NGINX:"\u5b89\u88c5 Nginx",UPDATE_NGINX_CONFIG:"\u66f4\u65b0 Nginx \u914d\u7f6e"},r);t.default=(0,s.default)(function(e){var t=e.ONE_CLICK_DEPLOY.common;return{deployType:t.deployType,deployTask:t.deployTask,initializingStatusState:t.initializingStatusState}},{getDeployType:f.getDeployType,getDeployTaskStatus:f.getDeployTaskStatus,getDeployStatus:f.getDeployStatus,deleteOneClickDeploy:f.deleteOneClickDeploy})(h)},3487:function(e,t,n){e.exports={content:"content-2F8","loading-wrapper":"loading-wrapper-24E",loadingWrapper:"loading-wrapper-24E","monkey-loading":"monkey-loading-3eZ",monkeyLoading:"monkey-loading-3eZ","text-wrapper":"text-wrapper-2kP",textWrapper:"text-wrapper-2kP",text:"text-rzE",log:"log-2eH",fail:"fail-k_O"}},3489:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(2),l=N(i),u=N(n(545)),s=n(168),c=N(n(0)),f=N(n(1828)),d=N(n(3490)),p=N(n(3491)),m=N(n(3492)),h=N(n(544)),y=N(n(549)),v=N(n(1482)),E=N(n(704)),b=N(n(700)),g=N(n(1454)),w=N(n(1512)),_=N(n(698)),P=N(n(2246)),O=n(1695),k=n(1638),T=n(1696),S=N(n(3493));function N(e){return e&&e.__esModule?e:{default:e}}var C=(r=a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={databaseInfoShow:!1,terminalInfoShow:!1,createTerminalPosting:!1,removeTerminalPosting:!1},e.closeDatabaseInfo=e.closeDatabaseInfo.bind(e),e.closeTerminalInfo=e.closeTerminalInfo.bind(e),e.createTerminal=e.createTerminal.bind(e),e.removeTerminal=e.removeTerminal.bind(e),e.onRetryDeploy=e.onRetryDeploy.bind(e),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"componentDidMount",value:function(){this.refreshData()}},{key:"closeDatabaseInfo",value:function(){this.setState({databaseInfoShow:!1})}},{key:"closeTerminalInfo",value:function(){this.setState({terminalInfoShow:!1})}},{key:"refreshData",value:function(e){this.props.getDeployType(),this.props.getDeployStatus(),this.props.poolingForDeployTaskStatus(),e&&this.props.getHosts()}},{key:"onStopIconClick",value:function(){var e=this;window.confirm("\u786e\u5b9a\u5173\u95ed\u5e94\u7528\uff1f")&&this.props.deleteOneClickDeploy().then(function(){e.props.getDeployType()})}},{key:"createTerminal",value:function(){var e=this;this.setState({createTerminalPosting:!0}),this.props.createTerminal().then(this.props.getDeployStatus).then(function(){return e.setState({createTerminalPosting:!1})})}},{key:"removeTerminal",value:function(){var e=this;this.setState({removeTerminalPosting:!0}),this.props.removeTerminal().then(this.props.getDeployStatus).then(function(){return e.setState({removeTerminalPosting:!1})})}},{key:"onRetryDeploy",value:function(){this.props.deploy().then(this.props.poolingForDeployTaskStatus)}},{key:"renderTitleBar",value:function(){var e=this,t=this.props,n=t.appRuntime,a=t.deployType,r=O.OCD_ACTIVATED_ENVIRONMENT.filter(function(e){return e.value===n})[0];if(r||"static"!==a||(r={name:"\u9759\u6001 Pages"}),!r)return null;var o=this.props.currentProject.project_path,i=l.default.createElement(b.default,null,"\u5237\u65b0"),u=l.default.createElement(b.default,null,"\u8bbe\u7f6e"),c=l.default.createElement(b.default,null,"\u5173\u95ed");return l.default.createElement("div",{className:S.default.titleBar},l.default.createElement("div",{className:S.default.titleArea},l.default.createElement("span",{className:S.default.text},r.name," \u5e94\u7528"),l.default.createElement("span",{className:S.default.label},"\u8fd0\u884c\u4e2d")),l.default.createElement("div",{className:S.default.iconArea},l.default.createElement(g.default,{overlay:u},l.default.createElement(s.Link,{to:o+"/git/pages/settings"},l.default.createElement(d.default,{className:S.default.icon}))),l.default.createElement(g.default,{overlay:i},l.default.createElement(f.default,{className:S.default.icon,onClick:function(){return e.refreshData(!0)}})),l.default.createElement(g.default,{overlay:c},l.default.createElement(p.default,{className:S.default.danger+" "+S.default.icon,onClick:function(){return e.onStopIconClick()}}))))}},{key:"renderBasicInformationPanel",value:function(){var e=this.props,t=e.deployInfo,n=e.currentProject;if(!t)return null;var a=t.primaryDomain,r=t.commitSha,o=t.createdAt;return l.default.createElement("div",{className:S.default.basicPanel},l.default.createElement("div",{className:S.default.textArea},l.default.createElement("div",{className:S.default.row},l.default.createElement("div",{className:S.default.key},"\u8bbf\u95ee\u5730\u5740"),l.default.createElement("span",{className:S.default.value},l.default.createElement("a",{href:"http"+(t.forceSsl?"s":"")+"://"+a,target:"_blank"},a))),l.default.createElement("div",{className:S.default.row},l.default.createElement("div",{className:S.default.key},"\u90e8\u7f72\u65f6\u95f4"),l.default.createElement("span",{className:S.default.value},o)),l.default.createElement("div",{className:S.default.row},l.default.createElement("div",{className:S.default.key},"\u90e8\u7f72\u7248\u672c"),l.default.createElement(s.Link,{to:n.depot_path+"/tree/"+r},l.default.createElement("span",{className:S.default.value},r&&r.substring(0,10))))),"static"!==this.props.deployType&&this.renderMachinePanel())}},{key:"renderMachinePanel",value:function(){var e=this.props,t=e.host,n=t.ip,a=t.sites,r=t.status,o=e.hostLoading,i="\u8fd0\u884c\u4e2d"===r?S.default.success:"";return o?l.default.createElement("div",{className:S.default.machinePanel},l.default.createElement("div",{className:S.default.wrapper},l.default.createElement(_.default,{show:o}))):l.default.createElement("div",{className:S.default.machinePanel},l.default.createElement("div",{className:S.default.wrapper},l.default.createElement("div",{className:S.default.row},l.default.createElement("div",{className:S.default.key},"\u4e3b\u673a IP"),l.default.createElement("span",{className:S.default.value},n)),l.default.createElement("div",{className:S.default.row},l.default.createElement("div",{className:S.default.key},"\u4e3b\u673a\u72b6\u6001:"),l.default.createElement("span",{className:i+" "+S.default.value},r),l.default.createElement("span",{className:S.default.value,style:{display:"none"}},l.default.createElement("a",{href:"https://console.cloud.tencent.com/lighthosting",target:"_blank"},"\u7eed\u8d39"))),l.default.createElement("div",{className:S.default.row},l.default.createElement("div",{className:S.default.key},"\u90e8\u7f72\u9879\u76ee"),l.default.createElement(P.default,{className:S.default.value+" "+S.default.deployList,sites:a}))))}},{key:"renderToolTerminalInfoAcquire",value:function(){return l.default.createElement("div",null,l.default.createElement("div",{className:S.default.tip},"\u7f51\u9875\u7248\u7684\u8fdc\u7a0b\u7ec8\u7aef\uff0c\u5728\u7f51\u9875\u4e0a\u8fdb\u884c\u547d\u4ee4\u884c\u64cd\u4f5c\u3002"),l.default.createElement(h.default,{onClick:this.createTerminal,className:S.default.createTerminal+" "+S.default.button,disabled:this.state.createTerminalPosting},this.state.createTerminalPosting?"\u5f00\u542f\u4e2d...":"\u5f00\u542f"))}},{key:"renderToolTerminalInfoAuth",value:function(e){var t=e.url;if(e&&e.url){var n=e.url.split("://");2===n.length&&(t=n[0]+"://"+e.username+":"+e.password+"@"+n[1])}return l.default.createElement("div",null,l.default.createElement("div",{className:S.default.copyButtonWrapper+" "+S.default.line},"\u7528\u6237\u540d: ",e.username,l.default.createElement(w.default,{className:S.default.copyButton,text:e.username})),l.default.createElement("div",{className:S.default.copyButtonWrapper+" "+S.default.line},"\u5bc6\u7801: ",e.password,l.default.createElement(w.default,{className:S.default.copyButton,text:e.password})),l.default.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},l.default.createElement(h.default,{className:S.default.button},"\u4e00\u952e\u767b\u5f55")),l.default.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},l.default.createElement(h.default,{className:S.default.button},"\u524d\u5f80")),l.default.createElement(h.default,{className:S.default.button,type:"danger",disabled:this.state.removeTerminalPosting,onClick:this.removeTerminal},this.state.removeTerminalPosting?"\u5173\u95ed\u4e2d...":"\u5173\u95ed\u7ec8\u7aef"))}},{key:"renderToolTerminalInfo",value:function(){var e=this.props.terminal,t=!e.url;return l.default.createElement("div",{className:S.default.terminalInfo},t?this.renderToolTerminalInfoAcquire():this.renderToolTerminalInfoAuth(e))}},{key:"renderTools",value:function(){var e=this,t=this.props.database;return l.default.createElement("div",{className:S.default.tools},l.default.createElement("div",{className:S.default.tool},l.default.createElement(h.default,{className:S.default.button,empty:!0,onClick:function(){return e.setState({terminalInfoShow:!0})}},l.default.createElement(m.default,{className:S.default.icon}),"\u5728\u7ebf\u7ec8\u7aef\u5de5\u5177")),l.default.createElement("div",{className:S.default.tool},l.default.createElement("a",{href:t.phpMyAdminUrl,target:"_blank",rel:"noopener noreferrer"},l.default.createElement(h.default,{className:S.default.button,empty:!0},l.default.createElement(m.default,{className:S.default.icon}),"phpMyAdmin"))),l.default.createElement("div",{className:S.default.tool+" "+S.default.database},l.default.createElement("span",{className:S.default.anchor,onClick:function(){return e.setState({databaseInfoShow:!0})}},"\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f")),l.default.createElement(y.default,{show:this.state.databaseInfoShow,onHide:this.closeDatabaseInfo,style:{maxWidth:1e3}},this.renderToolDatabaseInfo()),l.default.createElement(y.default,{show:this.state.terminalInfoShow,onHide:this.closeTerminalInfo,style:{maxWidth:400}},this.renderToolTerminalInfo()))}},{key:"renderToolDatabaseInfo",value:function(){var e=this.props.database,t=e.dbName,n=e.dbUsername,a=e.dbPassword,r=e.dbHost,o=e.dbPort,i="mysql://"+r+":"+o+"/"+t+"?user="+n+"&password="+a;return l.default.createElement("div",{className:S.default.databaseInfo},l.default.createElement("h3",{className:S.default.title},"\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f"),l.default.createElement("div",{className:S.default.table},l.default.createElement(v.default,null,l.default.createElement("thead",null,l.default.createElement("tr",null,l.default.createElement("th",{style:{width:75}}," "),l.default.createElement("th",null,"\u73af\u5883\u53d8\u91cf"),l.default.createElement("th",null,"\u503c"))),l.default.createElement("tbody",null,l.default.createElement("tr",null,l.default.createElement("td",null,"\u5e93\u540d"),l.default.createElement("td",null,"$_ENV['MYSQL_DBNAME']"),l.default.createElement("td",{className:S.default.copyButtonWrapper},t,l.default.createElement(w.default,{className:S.default.copyButton,text:t}))),l.default.createElement("tr",null,l.default.createElement("td",null,"\u7528\u6237\u540d"),l.default.createElement("td",null,"$_ENV['MYSQL_USERNAME']"),l.default.createElement("td",{className:S.default.copyButtonWrapper},n,l.default.createElement(w.default,{className:S.default.copyButton,text:n}))),l.default.createElement("tr",null,l.default.createElement("td",null,"\u5bc6\u7801"),l.default.createElement("td",null,"$_ENV['MYSQL_PASSWORD']"),l.default.createElement("td",{className:S.default.copyButtonWrapper},a,l.default.createElement(w.default,{className:S.default.copyButton,text:a}))),l.default.createElement("tr",null,l.default.createElement("td",null,"\u5730\u5740"),l.default.createElement("td",null,"$_ENV['MYSQL_HOST']"),l.default.createElement("td",{className:S.default.copyButtonWrapper},r,l.default.createElement(w.default,{className:S.default.copyButton,text:r}))),l.default.createElement("tr",null,l.default.createElement("td",null,"\u7aef\u53e3"),l.default.createElement("td",null,"$_ENV['MYSQL_PORT']"),l.default.createElement("td",{className:S.default.copyButtonWrapper},o,l.default.createElement(w.default,{className:S.default.copyButton,text:o}))),l.default.createElement("tr",null,l.default.createElement("td",null,"URI"),l.default.createElement("td",null,"-"),l.default.createElement("td",{className:S.default.copyButtonWrapper},i,l.default.createElement(w.default,{className:S.default.copyButton,text:i})))))))}},{key:"renderCodeDeployStatusBar",value:function(){var e=this.props.codeDeployTask;return"SUCCESS"===e.status?l.default.createElement(E.default,{type:"success"},"\u6700\u8fd1\u4e00\u6b21\u4ee3\u7801\u90e8\u7f72\u6210\u529f"):"RUNNING"===e.status?l.default.createElement(E.default,{type:"info"},"\u6b63\u5728\u90e8\u7f72\u65b0\u7248\u672c\u5e94\u7528\uff0c\u8bf7\u7a0d\u540e"):"FAILURE"===e.status?l.default.createElement(E.default,{type:"danger"},"\u6700\u8fd1\u4e00\u6b21\u4ee3\u7801\u90e8\u7f72\u5931\u8d25"):"BUILDING"===e.status?l.default.createElement(E.default,{type:"info"},"\u4ee3\u7801\u6784\u5efa\u4e2d..."):"FETCHING"===e.status?l.default.createElement(E.default,{type:"info"},"\u62c9\u53d6\u4ee3\u7801\u4e2d..."):"DEPLOYING"===e.status?l.default.createElement(E.default,{type:"info"},"\u7ad9\u70b9\u90e8\u7f72\u4e2d..."):null}},{key:"renderCodeDeployLogNotSuccess",value:function(){var e=this.props.codeDeployTask;return"FAILURE"!==e.status?null:l.default.createElement("div",null,l.default.createElement("div",{className:S.default.smallTitle},"\u9519\u8bef\u65e5\u5fd7"),l.default.createElement("pre",{className:S.default.log},e.log),l.default.createElement(h.default,{onClick:this.onRetryDeploy},"\u91cd\u8bd5\u90e8\u7f72"))}},{key:"renderCodeDeployStatus",value:function(){return l.default.createElement("div",{className:S.default.codeDeployStatus},l.default.createElement("div",null,l.default.createElement("div",{className:S.default.title},"\u90e8\u7f72\u4fe1\u606f"),this.renderCodeDeployStatusBar()),this.renderCodeDeployLogNotSuccess())}},{key:"render",value:function(){return l.default.createElement("div",null,t.renderHeader(),this.renderTitleBar(),this.renderBasicInformationPanel(),"static"!==this.props.deployType&&this.renderTools(),this.renderCodeDeployStatus())}}],[{key:"renderHeader",value:function(){return l.default.createElement("div",null,l.default.createElement("div",{className:T.header},l.default.createElement("div",{className:T.title},l.default.createElement("span",null,"Pages \u670d\u52a1"))))}}]),t}(),a.propTypes={currentProject:c.default.object,deployInfo:c.default.object,deployApp:c.default.object,projectApiPrefix:c.default.string,getDeployStatus:c.default.func,getDeployTaskStatus:c.default.func,deleteOneClickDeploy:c.default.func,deployStatusLoading:c.default.bool,deployStatus:c.default.object,startOneClickDeploy:c.default.func,getDeployType:c.default.func,createTerminal:c.default.func,removeTerminal:c.default.func,deployType:c.default.string,deployTask:c.default.any,terminal:c.default.object,database:c.default.object,appRuntime:c.default.string,poolingForDeployTaskStatus:c.default.func,getHosts:c.default.func,deploy:c.default.func,codeDeployTask:c.default.object,host:c.default.object,hostLoading:c.default.bool},r);t.default=(0,u.default)(function(e){var t=e.APP,n=t.currentProject,a=t.currentDepot,r=t.currentDepotLoading,o=t.user,i=t.projectApiPrefix,l=e.ONE_CLICK_DEPLOY,u=l.common,s=u.deployStatusLoading,c=u.deployType,f=u.deployInfo,d=u.deployApp,p=u.terminal,m=u.database,h=u.appRuntime,y=u.codeDeployTask,v=l.host;return{appRuntime:h,currentProject:n,currentDepot:a,currentDepotLoading:r,user:o,projectApiPrefix:i,deployStatusLoading:s,deployType:c,deployInfo:f,deployApp:d,terminal:p,database:m,codeDeployTask:y,host:v.host,hostLoading:v.hostLoading}},{getDeployType:k.getDeployType,getDeployStatus:k.getDeployStatus,getDeployTaskStatus:k.getDeployTaskStatus,startOneClickDeploy:k.startOneClickDeploy,deleteOneClickDeploy:k.deleteOneClickDeploy,createTerminal:k.createTerminal,removeTerminal:k.removeTerminal,poolingForDeployTaskStatus:k.poolingForDeployTaskStatus,deploy:k.deploy,getHosts:k.getHosts})(C)},3493:function(e,t,n){e.exports={"title-bar":"title-bar-1XD",titleBar:"title-bar-1XD","title-area":"title-area-iWD",titleArea:"title-area-iWD",text:"text-3OO",label:"label-2Q4","icon-area":"icon-area-2-x",iconArea:"icon-area-2-x",icon:"icon-1kC",danger:"danger-26G","basic-panel":"basic-panel-Nw0",basicPanel:"basic-panel-Nw0",row:"row-EQb",key:"key-3Hk",value:"value-2po","text-area":"text-area-1br",textArea:"text-area-1br","machine-panel":"machine-panel-241",machinePanel:"machine-panel-241",wrapper:"wrapper-2LG","deploy-list":"deploy-list-sU0",deployList:"deploy-list-sU0",tools:"tools-1_o",tool:"tool-3g4",database:"database-uvx",button:"button-NUi",anchor:"anchor-20Y","database-info":"database-info-3mQ",databaseInfo:"database-info-3mQ","copy-button-wrapper":"copy-button-wrapper-2iN",copyButtonWrapper:"copy-button-wrapper-2iN","terminal-info":"terminal-info-3I-",terminalInfo:"terminal-info-3I-","copy-button":"copy-button-2rE",copyButton:"copy-button-2rE",tip:"tip-1mP","create-terminal":"create-terminal-3SH",createTerminal:"create-terminal-3SH",line:"line-1un","code-deploy-status":"code-deploy-status-1dZ",codeDeployStatus:"code-deploy-status-1dZ",title:"title-2Bd","small-title":"small-title-52X",smallTitle:"small-title-52X",log:"log-X84"}}}]);